import{r as l,C as y,L as A,j as e}from"./vendor-BUGsBopJ.js";import{a as I,f as $,e as E}from"./index-D_2a-joA.js";import{P as k}from"./PriorityBadge-mgPJWs3I.js";import{Z as q,N as z,c as R,_ as H,T as b,A as J,J as Q,z as B}from"./icons-BH71IJCZ.js";import"./radix-DOd9NWOq.js";import"./tanstack-D2p4VxNq.js";import"./router-DTOaVcvx.js";import"./supabase-BqdusSG3.js";const Y=({onNavigate:g})=>{const[p,N]=l.useState([]),[v,w]=l.useState([]),[C,j]=l.useState(!0),[d,S]=l.useState(""),[h,P]=l.useState(y(A(new Date,30),"yyyy-MM-dd")),[u,_]=l.useState(y(new Date,"yyyy-MM-dd")),[x,L]=l.useState("all"),[m,D]=l.useState("all");l.useEffect(()=>{M()},[]);const M=async()=>{j(!0);try{const[t,a]=await Promise.all([I(),$()]);N(t),w(a)}catch(t){console.error(t)}j(!1)},r=l.useMemo(()=>p.filter(t=>{var a,i;if(t.log_date<h||t.log_date>u||x!=="all"&&t.project_id!==x||m!=="all"&&t.priority!==m)return!1;if(d){const o=d.toLowerCase();if(!((((a=t.project)==null?void 0:a.name)||"").toLowerCase().includes(o)||(((i=t.project)==null?void 0:i.job_number)||"").toLowerCase().includes(o)||(t.notes||"").toLowerCase().includes(o)||(t.weather||"").toLowerCase().includes(o)||(t.critical_items||"").toLowerCase().includes(o)||(t.safety_incidents||"").toLowerCase().includes(o)))return!1}return!0}),[p,h,u,x,m,d]),c=l.useMemo(()=>{const t=r.length,a=r.filter(s=>s.priority==="high").length,i=r.filter(s=>s.priority==="medium").length,o=r.filter(s=>s.priority==="low").length,f=r.filter(s=>s.safety_incidents&&s.safety_incidents.trim()).length,F=r.filter(s=>s.critical_items&&s.critical_items.trim()).length,T=new Set(r.map(s=>s.project_id)).size;return{total:t,high:a,medium:i,low:o,withSafety:f,withCritical:F,uniqueProjects:T}},[r]),n="lld-input px-3 py-2 rounded-lg text-sm";return C?e.jsx("div",{className:"flex items-center justify-center h-96",children:e.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-b-2 border-amber-400"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Reports"}),e.jsxs("button",{className:"flex items-center gap-2 px-4 py-2 rounded-lg bg-blue-500/10 border border-blue-500/20 text-blue-400 text-sm font-medium hover:bg-blue-500/20 transition-colors",children:[e.jsx(q,{className:"w-4 h-4"}),"Export"]})]}),e.jsx("div",{className:"bg-slate-800/60 border border-slate-700/50 rounded-xl p-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-3",children:[e.jsxs("div",{className:"md:col-span-2 relative",children:[e.jsx(z,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-500"}),e.jsx("input",{value:d,onChange:t=>S(t.target.value),className:`w-full pl-9 ${n}`,placeholder:"Search logs, projects, notes..."})]}),e.jsx("div",{children:e.jsx("input",{type:"date",value:h,onChange:t=>P(t.target.value),className:`w-full ${n}`})}),e.jsx("div",{children:e.jsx("input",{type:"date",value:u,onChange:t=>_(t.target.value),className:`w-full ${n}`})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("select",{value:x,onChange:t=>L(t.target.value),className:`flex-1 ${n}`,children:[e.jsx("option",{value:"all",children:"All Projects"}),v.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]}),e.jsxs("select",{value:m,onChange:t=>D(t.target.value),className:n,children:[e.jsx("option",{value:"all",children:"All"}),e.jsx("option",{value:"high",children:"High"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"low",children:"Low"})]})]})]})}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-7 gap-3",children:[{label:"Total Logs",value:c.total,icon:R,color:"text-blue-400"},{label:"Projects",value:c.uniqueProjects,icon:H,color:"text-indigo-400"},{label:"High Priority",value:c.high,icon:b,color:"text-red-400"},{label:"Medium",value:c.medium,icon:J,color:"text-amber-400"},{label:"Low",value:c.low,icon:Q,color:"text-emerald-400"},{label:"Safety Issues",value:c.withSafety,icon:b,color:"text-orange-400"},{label:"Critical Items",value:c.withCritical,icon:B,color:"text-purple-400"}].map((t,a)=>{const i=t.icon;return e.jsxs("div",{className:"bg-slate-800/60 border border-slate-700/50 rounded-xl p-3 text-center",children:[e.jsx(i,{className:`w-5 h-5 mx-auto mb-1 ${t.color}`}),e.jsx("div",{className:"text-xl font-bold text-white",children:t.value}),e.jsx("div",{className:"text-[10px] text-slate-400",children:t.label})]},a)})}),e.jsx("div",{className:"bg-slate-800/60 border border-slate-700/50 rounded-xl overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-slate-700/50",children:[e.jsx("th",{className:"py-3 px-4 text-xs font-semibold text-slate-400",children:"Date"}),e.jsx("th",{className:"py-3 px-4 text-xs font-semibold text-slate-400",children:"Project"}),e.jsx("th",{className:"py-3 px-4 text-xs font-semibold text-slate-400",children:"Job #"}),e.jsx("th",{className:"py-3 px-4 text-xs font-semibold text-slate-400",children:"Weather"}),e.jsx("th",{className:"py-3 px-4 text-xs font-semibold text-slate-400",children:"Priority"}),e.jsx("th",{className:"py-3 px-4 text-xs font-semibold text-slate-400",children:"Safety"}),e.jsx("th",{className:"py-3 px-4 text-xs font-semibold text-slate-400",children:"Critical"}),e.jsx("th",{className:"py-3 px-4 text-xs font-semibold text-slate-400",children:"Notes"})]})}),e.jsx("tbody",{children:r.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:8,className:"py-12 text-center text-sm text-slate-500",children:"No logs found matching your filters"})}):r.map(t=>{var a,i;return e.jsxs("tr",{onClick:()=>g("daily-logs",{logId:t.id}),className:"border-b border-slate-700/20 hover:bg-slate-700/20 cursor-pointer transition-colors",children:[e.jsx("td",{className:"py-3 px-4 text-xs text-white font-medium",children:E(t.log_date)}),e.jsx("td",{className:"py-3 px-4 text-xs text-slate-300",children:((a=t.project)==null?void 0:a.name)||"â€”"}),e.jsx("td",{className:"py-3 px-4",children:e.jsx("span",{className:"text-xs font-mono text-amber-400 bg-amber-500/10 px-1.5 py-0.5 rounded",children:((i=t.project)==null?void 0:i.job_number)||"â€”"})}),e.jsxs("td",{className:"py-3 px-4 text-xs text-slate-400",children:[t.weather||"â€”"," ",t.temperature]}),e.jsx("td",{className:"py-3 px-4",children:e.jsx(k,{priority:t.priority,size:"sm",showIcon:!1})}),e.jsx("td",{className:"py-3 px-4 text-xs text-slate-400 max-w-[120px] truncate",children:t.safety_incidents||"â€”"}),e.jsx("td",{className:"py-3 px-4 text-xs text-slate-400 max-w-[120px] truncate",children:t.critical_items||"â€”"}),e.jsx("td",{className:"py-3 px-4 text-xs text-slate-400 max-w-[150px] truncate",children:t.notes||"â€”"})]},t.id)})})]})})})]})};export{Y as default};
