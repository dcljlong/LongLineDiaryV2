import{r as t,j as e}from"./vendor-Ctk_PxZ3.js";import{J as G,K as O,L as K,F as q,M as z,O as J,U as E,P as Q}from"./index-wlBa9spr.js";import{s as F,a1 as $,d as A,U as m,h as V,H as X,m as D,a2 as Z,b as ee,c as se,a3 as ae,z as re,a4 as te,F as le,Y as oe,a5 as ne,K as ie}from"./icons-Uc_ZW2XO.js";import"./radix-BrLWYKju.js";import"./tanstack-Blm1ijQD.js";import"./supabase-iUa_TVcT.js";import"./router-CoGOqbGX.js";const n="lld-input w-full px-3 py-2 rounded-lg text-sm",l="block text-xs font-medium text-muted-foreground mb-1",R={site_manager:D,foreman:X,safety_officer:V},he=({userRole:L})=>{const{user:c,profile:d,updateProfile:_}=G(),{theme:U,setTheme:I}=O(),[r,o]=t.useState(K),[x,u]=t.useState(!1),[p,g]=t.useState(!1),[M,h]=t.useState(!0),[f,b]=t.useState(""),[j,y]=t.useState("foreman"),[N,v]=t.useState(""),[S,C]=t.useState(""),[w,k]=t.useState(!1),[T,P]=t.useState(!1);t.useEffect(()=>{q().then(s=>{o(s),h(!1)}).catch(()=>h(!1))},[]),t.useEffect(()=>{d&&(b(d.full_name??""),y(d.role??"foreman"),v(d.company_name??""),C(d.site_name??""))},[d]);const B=async()=>{u(!0);try{await Q(r),g(!0),setTimeout(()=>g(!1),2e3)}catch(s){console.error(s),alert("Failed to save settings")}u(!1)},W=async()=>{k(!0);try{await _({full_name:f,role:j,company_name:N,site_name:S}),P(!0),setTimeout(()=>P(!1),2e3)}catch(s){console.error(s)}k(!1)},Y=(s,i)=>{o(a=>({...a,features:{...a.features,[s]:i}}))},H=[{key:"analytics",label:"Analytics & Insights",description:"Track crew productivity, project health, and trends",icon:se},{key:"weatherAlerts",label:"Weather Alerts",description:"Get weather forecasts and site impact warnings",icon:ae},{key:"teamCollaboration",label:"Team Collaboration",description:"Comments, mentions, and team notes on logs",icon:re},{key:"approvalWorkflow",label:"Approval Workflow",description:"Require manager sign-off on daily logs",icon:te},{key:"customReports",label:"Custom Reports",description:"Build custom report templates and formats",icon:le},{key:"autoCarryForward",label:"Auto Carry Forward",description:"Automatically move incomplete items to next day",icon:oe},{key:"aiSummary",label:"AI Daily Summary",description:"Get AI-powered morning briefings across all jobs",icon:ne},{key:"notifications",label:"Smart Notifications",description:"Automated alerts for overdue items and reminders",icon:ie}];return M?e.jsx("div",{className:"flex items-center justify-center h-96",children:e.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-b-2 border-primary"})}):e.jsxs("div",{className:"space-y-6 max-w-3xl",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-foreground",children:"Settings"}),e.jsxs("p",{className:"text-muted-foreground text-sm mt-1",children:["Configure your ",z.appName," preferences"]})]}),e.jsx("button",{onClick:B,disabled:x,className:`flex items-center gap-2 px-4 py-2.5 rounded-lg text-sm font-semibold transition-colors ${p?"bg-emerald-500 text-foreground":"bg-primary hover:bg-primary/90 text-primary-foreground"} disabled:opacity-50`,children:p?e.jsxs(e.Fragment,{children:[e.jsx(F,{className:"w-4 h-4"})," Saved"]}):x?"Saving...":e.jsxs(e.Fragment,{children:[e.jsx($,{className:"w-4 h-4"})," Save Settings"]})})]}),e.jsxs("div",{className:"bg-card border border-border rounded-xl p-5",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(A,{className:"w-5 h-5 text-primary"}),e.jsx("h2",{className:"text-sm font-bold text-foreground",children:"Theme"}),e.jsx("span",{className:"text-[10px] text-muted-foreground ml-2",children:"Applies instantly (saved on this device)"})]}),e.jsx("label",{className:l,children:"Theme palette"}),e.jsx("select",{className:n,value:U,onChange:s=>I(s.target.value),children:J.map(s=>e.jsxs("option",{value:s.id,children:[s.name," (",s.mode,")"]},s.id))}),e.jsx("div",{className:"mt-2 text-xs text-muted-foreground",children:"Note: Only colours/tokens. Does not change your logo."})]}),c&&e.jsxs("div",{className:"bg-card border border-border rounded-xl p-5",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(m,{className:"w-5 h-5 text-primary"}),e.jsx("h2",{className:"text-sm font-bold text-foreground",children:"Your Profile"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:l,children:"Full Name"}),e.jsx("input",{value:f,onChange:s=>b(s.target.value),className:n,placeholder:"Your full name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:l,children:"Email"}),e.jsx("input",{value:c.email||"",disabled:!0,className:`${n} opacity-60 cursor-not-allowed`})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:l,children:"Company Name"}),e.jsx("input",{value:N,onChange:s=>v(s.target.value),className:n,placeholder:"Your company"})]}),e.jsxs("div",{children:[e.jsx("label",{className:l,children:"Primary Site"}),e.jsx("input",{value:S,onChange:s=>C(s.target.value),className:n,placeholder:"Main site"})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:l,children:"Your Role"}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-2",children:E.map(s=>{const i=R[s.value]||m,a=j===s.value;return e.jsxs("button",{type:"button",onClick:()=>y(s.value),className:`flex items-center gap-3 p-3 rounded-xl border transition-all text-left ${a?"bg-primary/10 border-primary/50":"bg-muted border-border hover:border-border"}`,children:[e.jsx("div",{className:`w-9 h-9 rounded-lg flex items-center justify-center ${a?"bg-primary/20 text-primary":"bg-muted text-muted-foreground"}`,children:e.jsx(i,{className:"w-4 h-4"})}),e.jsxs("div",{children:[e.jsx("p",{className:`text-sm font-medium ${a?"text-primary":"text-muted-foreground"}`,children:s.label}),e.jsx("p",{className:"text-[10px] text-muted-foreground leading-tight",children:s.description.split(",")[0]})]})]},s.value)})})]}),e.jsx("button",{onClick:W,disabled:w,className:`flex items-center gap-2 px-4 py-2 rounded-lg text-xs font-semibold transition-colors ${T?"bg-emerald-500 text-foreground":"bg-primary hover:bg-primary/90 text-primary-foreground"} disabled:opacity-50`,children:T?e.jsxs(e.Fragment,{children:[e.jsx(F,{className:"w-3 h-3"})," Profile Saved"]}):w?"Saving...":e.jsxs(e.Fragment,{children:[e.jsx($,{className:"w-3 h-3"})," Update Profile"]})})]}),!c&&e.jsxs("div",{className:"bg-primary/10 border border-primary/20 rounded-xl p-4 flex items-center gap-3",children:[e.jsx(D,{className:"w-5 h-5 text-primary flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-primary",children:"Sign in to manage your profile"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Create an account to save your settings and access role-based features."})]})]}),e.jsxs("div",{className:"bg-card border border-border rounded-xl p-5",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(Z,{className:"w-5 h-5 text-primary"}),e.jsx("h2",{className:"text-sm font-bold text-foreground",children:"Company Details"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:l,children:"Company Name"}),e.jsx("input",{value:r.companyName,onChange:s=>o({...r,companyName:s.target.value}),className:n,placeholder:"e.g. Long Line Builders"})]}),e.jsxs("div",{children:[e.jsx("label",{className:l,children:"Company Logo URL"}),e.jsx("input",{value:r.companyLogo,onChange:s=>o({...r,companyLogo:s.target.value}),className:n,placeholder:"https://example.com/logo.png"}),e.jsx("p",{className:"text-[10px] text-muted-foreground mt-1",children:"Used on PDF/Excel exports"})]})]})]}),e.jsxs("div",{className:"bg-card border border-border rounded-xl p-5",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(ee,{className:"w-5 h-5 text-primary"}),e.jsx("h2",{className:"text-sm font-bold text-foreground",children:"Timesheet Configuration"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:l,children:"Timesheet Period"}),e.jsx("div",{className:"flex gap-2",children:[1,2].map(s=>e.jsxs("button",{onClick:()=>o({...r,timesheetPeriod:s}),className:`flex-1 py-2 rounded-lg text-sm font-medium transition-colors ${r.timesheetPeriod===s?"bg-primary text-primary-foreground":"bg-muted text-muted-foreground hover:bg-muted"}`,children:[s," Week",s>1?"s":""]},s))})]}),e.jsxs("div",{children:[e.jsx("label",{className:l,children:"Week Ending Day"}),e.jsx("select",{value:r.weekEndingDay,onChange:s=>o({...r,weekEndingDay:s.target.value}),className:n,children:["Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday"].map(s=>e.jsx("option",{value:s,children:s},s))})]}),e.jsxs("div",{children:[e.jsx("label",{className:l,children:"Default Lunch"}),e.jsx("div",{className:"flex gap-2",children:[30,60].map(s=>e.jsxs("button",{onClick:()=>o({...r,lunchDefaultMinutes:s}),className:`flex-1 py-2 rounded-lg text-sm font-medium transition-colors ${r.lunchDefaultMinutes===s?"bg-primary text-primary-foreground":"bg-muted text-muted-foreground hover:bg-muted"}`,children:[s," min"]},s))})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:l,children:"Rounding (minutes)"}),e.jsx("div",{className:"flex gap-2 flex-wrap",children:[5,10,15,30].map(s=>e.jsxs("button",{onClick:()=>o({...r,roundingMinutes:s}),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${r.roundingMinutes===s?"bg-primary text-primary-foreground":"bg-muted text-muted-foreground hover:bg-muted"}`,children:[s," min"]},s))})]})]}),e.jsxs("div",{className:"bg-card border border-border rounded-xl p-5",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(A,{className:"w-5 h-5 text-primary"}),e.jsx("h2",{className:"text-sm font-bold text-foreground",children:"Features"}),e.jsx("span",{className:"text-[10px] text-muted-foreground ml-2",children:"Toggle features on/off"})]}),e.jsx("div",{className:"space-y-3",children:H.map(s=>{const i=s.icon,a=r.features[s.key];return e.jsxs("div",{className:`flex items-center gap-4 p-3 rounded-xl border transition-colors ${a?"bg-muted border-border":"bg-card border-border opacity-60"}`,children:[e.jsx("div",{className:`w-10 h-10 rounded-xl flex items-center justify-center ${a?"bg-primary/15 text-primary":"bg-muted text-muted-foreground"}`,children:e.jsx(i,{className:"w-5 h-5"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-sm font-semibold text-foreground",children:s.label}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s.description})]}),e.jsx("button",{onClick:()=>Y(s.key,!a),className:`relative w-11 h-6 rounded-full transition-colors ${a?"bg-primary":"bg-muted"}`,children:e.jsx("span",{className:`absolute top-0.5 left-0.5 w-5 h-5 rounded-full bg-foreground transition-transform ${a?"translate-x-5":"translate-x-0"}`})})]},s.key)})})]}),e.jsxs("div",{className:"bg-card border border-border rounded-xl p-5",children:[e.jsx("h2",{className:"text-sm font-bold text-foreground mb-3",children:"Role Access Levels"}),e.jsx("p",{className:"text-xs text-muted-foreground mb-3",children:"Each role has different access to features:"}),e.jsx("div",{className:"space-y-2",children:E.map(s=>{const i=R[s.value]||m,a=L===s.value;return e.jsxs("div",{className:`flex items-center gap-3 p-3 rounded-xl border transition-colors ${a?"bg-primary/10 border-primary/20":"bg-muted/20 border-border"}`,children:[e.jsx("div",{className:`w-9 h-9 rounded-lg flex items-center justify-center ${a?"bg-primary/20 text-primary":"bg-muted text-muted-foreground"}`,children:e.jsx(i,{className:"w-4 h-4"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`text-sm font-semibold ${a?"text-primary":"text-foreground"}`,children:s.label}),a&&e.jsx("span",{className:"text-[10px] px-1.5 py-0.5 rounded bg-primary/20 text-primary font-medium",children:"Current"})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s.description})]})]},s.value)})})]})]})};export{he as default};
