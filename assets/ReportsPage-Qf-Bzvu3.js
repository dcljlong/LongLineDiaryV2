import{r as a,E as g,N as A,j as e}from"./vendor-PYixsk0d.js";import{a as E,f as I,e as $}from"./index-D2PZVvnG.js";import{P as k}from"./PriorityBadge-DGNu8hBn.js";import{O as q,D as Q,c as R,Q as z,T as b,A as H,x as B,t as J}from"./icons-DUP5S1G1.js";import"./radix-D8qNXTYQ.js";import"./tanstack-C9VkMA4e.js";import"./supabase-BGS_MQFj.js";import"./router-DIvsDq8X.js";const Z=({onNavigate:y})=>{const[p,N]=a.useState([]),[v,w]=a.useState([]),[C,f]=a.useState(!0),[d,S]=a.useState(""),[u,P]=a.useState(g(A(new Date,30),"yyyy-MM-dd")),[h,_]=a.useState(g(new Date,"yyyy-MM-dd")),[x,L]=a.useState("all"),[m,D]=a.useState("all");a.useEffect(()=>{M()},[]);const M=async()=>{f(!0);try{const[t,r]=await Promise.all([E(),I()]);N(t),w(r)}catch(t){console.error(t)}f(!1)},o=a.useMemo(()=>p.filter(t=>{var r,l;if(t.log_date<u||t.log_date>h||x!=="all"&&t.project_id!==x||m!=="all"&&t.priority!==m)return!1;if(d){const i=d.toLowerCase();if(!((((r=t.project)==null?void 0:r.name)||"").toLowerCase().includes(i)||(((l=t.project)==null?void 0:l.job_number)||"").toLowerCase().includes(i)||(t.notes||"").toLowerCase().includes(i)||(t.weather||"").toLowerCase().includes(i)||(t.critical_items||"").toLowerCase().includes(i)||(t.safety_incidents||"").toLowerCase().includes(i)))return!1}return!0}),[p,u,h,x,m,d]),n=a.useMemo(()=>{const t=o.length,r=o.filter(s=>s.priority==="high").length,l=o.filter(s=>s.priority==="medium").length,i=o.filter(s=>s.priority==="low").length,j=o.filter(s=>s.safety_incidents&&s.safety_incidents.trim()).length,F=o.filter(s=>s.critical_items&&s.critical_items.trim()).length,T=new Set(o.map(s=>s.project_id)).size;return{total:t,high:r,medium:l,low:i,withSafety:j,withCritical:F,uniqueProjects:T}},[o]),c="lld-input px-3 py-2 rounded-lg text-sm";return C?e.jsx("div",{className:"flex items-center justify-center h-96",children:e.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-b-2 border-amber-400"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-2xl font-bold text-foreground",children:"Reports"}),e.jsxs("button",{className:"flex items-center gap-2 px-4 py-2 rounded-lg bg-blue-500/10 border border-blue-500/20 text-blue-400 text-sm font-medium hover:bg-blue-500/20 transition-colors",children:[e.jsx(q,{className:"w-4 h-4"}),"Export"]})]}),e.jsx("div",{className:"bg-card border border-border rounded-xl p-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-3",children:[e.jsxs("div",{className:"md:col-span-2 relative",children:[e.jsx(Q,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx("input",{value:d,onChange:t=>S(t.target.value),className:`w-full pl-9 ${c}`,placeholder:"Search logs, projects, notes..."})]}),e.jsx("div",{children:e.jsx("input",{type:"date",value:u,onChange:t=>P(t.target.value),className:`w-full ${c}`})}),e.jsx("div",{children:e.jsx("input",{type:"date",value:h,onChange:t=>_(t.target.value),className:`w-full ${c}`})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("select",{value:x,onChange:t=>L(t.target.value),className:`flex-1 ${c}`,children:[e.jsx("option",{value:"all",children:"All Projects"}),v.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]}),e.jsxs("select",{value:m,onChange:t=>D(t.target.value),className:c,children:[e.jsx("option",{value:"all",children:"All"}),e.jsx("option",{value:"high",children:"High"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"low",children:"Low"})]})]})]})}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-7 gap-3",children:[{label:"Total Logs",value:n.total,icon:R,color:"text-blue-400"},{label:"Projects",value:n.uniqueProjects,icon:z,color:"text-indigo-400"},{label:"High Priority",value:n.high,icon:b,color:"text-red-400"},{label:"Medium",value:n.medium,icon:H,color:"text-amber-400"},{label:"Low",value:n.low,icon:B,color:"text-emerald-400"},{label:"Safety Issues",value:n.withSafety,icon:b,color:"text-orange-400"},{label:"Critical Items",value:n.withCritical,icon:J,color:"text-purple-400"}].map((t,r)=>{const l=t.icon;return e.jsxs("div",{className:"bg-card border border-border rounded-xl p-3 text-center",children:[e.jsx(l,{className:`w-5 h-5 mx-auto mb-1 ${t.color}`}),e.jsx("div",{className:"text-xl font-bold text-foreground",children:t.value}),e.jsx("div",{className:"text-[10px] text-muted-foreground",children:t.label})]},r)})}),e.jsx("div",{className:"bg-card border border-border rounded-xl overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-border",children:[e.jsx("th",{className:"py-3 px-4 text-xs font-semibold text-foreground/80",children:"Date"}),e.jsx("th",{className:"py-3 px-4 text-xs font-semibold text-foreground/80",children:"Project"}),e.jsx("th",{className:"py-3 px-4 text-xs font-semibold text-foreground/80",children:"Job #"}),e.jsx("th",{className:"py-3 px-4 text-xs font-semibold text-foreground/80",children:"Weather"}),e.jsx("th",{className:"py-3 px-4 text-xs font-semibold text-foreground/80",children:"Priority"}),e.jsx("th",{className:"py-3 px-4 text-xs font-semibold text-foreground/80",children:"Safety"}),e.jsx("th",{className:"py-3 px-4 text-xs font-semibold text-foreground/80",children:"Critical"}),e.jsx("th",{className:"py-3 px-4 text-xs font-semibold text-foreground/80",children:"Notes"})]})}),e.jsx("tbody",{children:o.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:8,className:"py-12 text-center text-sm text-muted-foreground",children:"No logs found matching your filters"})}):o.map(t=>{var r,l;return e.jsxs("tr",{onClick:()=>y("daily-logs",{logId:t.id}),className:"border-b border-border/60 hover:bg-muted/60 cursor-pointer transition-colors",children:[e.jsx("td",{className:"py-3 px-4 text-xs text-foreground font-medium",children:$(t.log_date)}),e.jsx("td",{className:"py-3 px-4 text-xs text-foreground/80",children:((r=t.project)==null?void 0:r.name)||"â€”"}),e.jsx("td",{className:"py-3 px-4",children:e.jsx("span",{className:"text-xs font-mono text-amber-400 bg-amber-500/10 px-1.5 py-0.5 rounded",children:((l=t.project)==null?void 0:l.job_number)||"â€”"})}),e.jsxs("td",{className:"py-3 px-4 text-xs text-muted-foreground",children:[t.weather||"â€”"," ",t.temperature]}),e.jsx("td",{className:"py-3 px-4",children:e.jsx(k,{priority:t.priority,size:"sm",showIcon:!1})}),e.jsx("td",{className:"py-3 px-4 text-xs text-muted-foreground max-w-[120px] truncate",children:t.safety_incidents||"â€”"}),e.jsx("td",{className:"py-3 px-4 text-xs text-muted-foreground max-w-[120px] truncate",children:t.critical_items||"â€”"}),e.jsx("td",{className:"py-3 px-4 text-xs text-muted-foreground max-w-[150px] truncate",children:t.notes||"â€”"})]},t.id)})})]})})})]})};export{Z as default};
