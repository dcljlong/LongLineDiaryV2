const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./DashboardPage-BfPzem9r.js","./vendor-Coh6w-wA.js","./PriorityBadge-CZTRhtYn.js","./icons-DuXLjBGX.js","./ActionItemDetailModal-C1PQ9nlb.js","./radix-wrHiDKbY.js","./tanstack-x3w5gpW7.js","./supabase-jRWW_51U.js","./router-jL34xOpu.js","./DailyLogsPage-Bz7KPwnr.js","./CalendarPage-MZCCMkeg.js","./TimesheetPage-CvFk_FS_.js","./OnsiteWalkPage-bVu4wlwh.js","./ReportsPage-dP1DLSiw.js","./JobAuditReportPage-D5ogiVUm.js","./ArchivePage-BNtCbPyz.js","./SettingsPage-DHVkI18a.js"])))=>i.map(i=>d[i]);
import{r as n,B as wt,C as Nt,j as e,D as fe,$ as _t,E as Ae,F as De,G as St,H as Ct,J as kt,R as Ft}from"./vendor-Coh6w-wA.js";import{V as Ie,R as Le,A as Re,C as Me,T as Oe,D as $e,P as Et,a as Be,b as Tt,c as ze,S as Pt,d as qe,I as At,e as Ue,f as Ve,g as Dt,h as He,i as It,L as We,j as Ge,k as Lt,l as Rt,m as Je,n as Mt,o as Ot}from"./radix-wrHiDKbY.js";import{X as re,S as $t,M as Bt,L as zt,C as qt,a as Ut,b as Vt,F as Ht,c as Wt,A as Gt,d as Jt,P as Yt,e as Q,f as Qt,g as Kt,h as ce,i as Xt,j as ye,E as ve,k as je,l as we,U as de,H as Ye,m as Qe,n as Zt,o as ge,p as es,q as ts,r as ss,s as rs}from"./icons-DuXLjBGX.js";import{Q as as,a as os}from"./tanstack-x3w5gpW7.js";import{c as ns}from"./supabase-jRWW_51U.js";import{u as is,H as ls,R as cs,a as oe,N as ds}from"./router-jL34xOpu.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))a(o);new MutationObserver(o=>{for(const l of o)if(l.type==="childList")for(const i of l.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&a(i)}).observe(document,{childList:!0,subtree:!0});function r(o){const l={};return o.integrity&&(l.integrity=o.integrity),o.referrerPolicy&&(l.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?l.credentials="include":o.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function a(o){if(o.ep)return;o.ep=!0;const l=r(o);fetch(o.href,l)}})();const us=1,ms=1e6;let ne=0;function ps(){return ne=(ne+1)%Number.MAX_SAFE_INTEGER,ne.toString()}const ie=new Map,Ne=t=>{if(ie.has(t))return;const s=setTimeout(()=>{ie.delete(t),W({type:"REMOVE_TOAST",toastId:t})},ms);ie.set(t,s)},fs=(t,s)=>{switch(s.type){case"ADD_TOAST":return{...t,toasts:[s.toast,...t.toasts].slice(0,us)};case"UPDATE_TOAST":return{...t,toasts:t.toasts.map(r=>r.id===s.toast.id?{...r,...s.toast}:r)};case"DISMISS_TOAST":{const{toastId:r}=s;return r?Ne(r):t.toasts.forEach(a=>{Ne(a.id)}),{...t,toasts:t.toasts.map(a=>a.id===r||r===void 0?{...a,open:!1}:a)}}case"REMOVE_TOAST":return s.toastId===void 0?{...t,toasts:[]}:{...t,toasts:t.toasts.filter(r=>r.id!==s.toastId)}}},K=[];let X={toasts:[]};function W(t){X=fs(X,t),K.forEach(s=>{s(X)})}function gs({...t}){const s=ps(),r=o=>W({type:"UPDATE_TOAST",toast:{...o,id:s}}),a=()=>W({type:"DISMISS_TOAST",toastId:s});return W({type:"ADD_TOAST",toast:{...t,id:s,open:!0,onOpenChange:o=>{o||a()}}}),{id:s,dismiss:a,update:r}}function hs(){const[t,s]=n.useState(X);return n.useEffect(()=>(K.push(s),()=>{const r=K.indexOf(s);r>-1&&K.splice(r,1)}),[t]),{...t,toast:gs,dismiss:r=>W({type:"DISMISS_TOAST",toastId:r})}}function E(...t){return wt(Nt(t))}const xs=Et,Ke=n.forwardRef(({className:t,...s},r)=>e.jsx(Ie,{ref:r,className:E("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",t),...s}));Ke.displayName=Ie.displayName;const bs=fe("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),Xe=n.forwardRef(({className:t,variant:s,...r},a)=>e.jsx(Le,{ref:a,className:E(bs({variant:s}),t),...r}));Xe.displayName=Le.displayName;const ys=n.forwardRef(({className:t,...s},r)=>e.jsx(Re,{ref:r,className:E("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",t),...s}));ys.displayName=Re.displayName;const Ze=n.forwardRef(({className:t,...s},r)=>e.jsx(Me,{ref:r,className:E("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",t),"toast-close":"",...s,children:e.jsx(re,{className:"h-4 w-4"})}));Ze.displayName=Me.displayName;const et=n.forwardRef(({className:t,...s},r)=>e.jsx(Oe,{ref:r,className:E("text-sm font-semibold",t),...s}));et.displayName=Oe.displayName;const tt=n.forwardRef(({className:t,...s},r)=>e.jsx($e,{ref:r,className:E("text-sm opacity-90",t),...s}));tt.displayName=$e.displayName;function vs(){const{toasts:t}=hs();return e.jsxs(xs,{children:[t.map(function({id:s,title:r,description:a,action:o,...l}){return e.jsxs(Xe,{...l,children:[e.jsxs("div",{className:"grid gap-1",children:[r&&e.jsx(et,{children:r}),a&&e.jsx(tt,{children:a})]}),o,e.jsx(Ze,{})]},s)}),e.jsx(Ke,{})]})}const st=n.createContext(null);function js({children:t,defaultTheme:s="system",value:r,...a}){const[o,l]=n.useState(()=>{if(typeof window<"u"){const d=localStorage.getItem("theme");return d&&(d==="dark"||d==="light"||d==="system")?d:s}return s});n.useEffect(()=>{const d=window.document.documentElement;d.classList.remove("dark"),d.classList.add("light")},[]);const i={theme:o,setTheme:d=>{localStorage.setItem("theme",d),l(d)}};return e.jsx(st.Provider,{value:i,...a,children:t})}const ws=()=>{const t=n.useContext(st);if(!t)throw new Error("useTheme must be used within a ThemeProvider");return t},Ns=({...t})=>{const{theme:s}=ws();return e.jsx(_t,{theme:s,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...t})},_s=Tt,Ss=n.forwardRef(({className:t,sideOffset:s=4,...r},a)=>e.jsx(Be,{ref:a,sideOffset:s,className:E("z-50 overflow-hidden rounded-md border border-border/40 bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-lg animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...r}));Ss.displayName=Be.displayName;const Z="https://qbqceybdmesgqsvvhfzl.supabase.co",Cs="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InFicWNleWJkbWVzZ3FzdnZoZnpsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzE4Nzc2NzQsImV4cCI6MjA4NzQ1MzY3NH0.UgDmKnVvvX3WcESuXp8EVkuZDIIQ7KblubQX-hcpR3c";var Pe;const ks=((Pe=Z==null?void 0:Z.split("//")[1])==null?void 0:Pe.split(".")[0])??"unknown",k=ns(Z,Cs,{auth:{storageKey:`lldv2-${ks}-auth`}}),rt=n.createContext({user:null,session:null,profile:null,loading:!0,signUp:async()=>({error:null}),signIn:async()=>({error:null}),signOut:async()=>{},updateProfile:async()=>({error:null})}),he=()=>n.useContext(rt),Fs=({children:t})=>{const[s,r]=n.useState(null),[a,o]=n.useState(null),[l,i]=n.useState(null),[d,c]=n.useState(!0),u=n.useCallback(async p=>{try{const{data:x,error:f}=await k.from("profiles").select("*").eq("id",p).maybeSingle();return f?(console.error("Profile fetch error:",f),null):x}catch(x){return console.error("Profile fetch exception:",x),null}},[]),m=n.useCallback(async p=>{const x=await u(p.id);if(x)return x;const f=p.user_metadata??{},v={id:p.id,full_name:f.full_name??"",role:f.role??"foreman",onboarded:!1};try{const{error:_}=await k.from("profiles").insert(v);return _?(console.error("Profile insert error:",_),null):await u(p.id)}catch(_){return console.error("Profile insert exception:",_),null}},[u]);n.useEffect(()=>{(async()=>{try{const{data:{session:f}}=await k.auth.getSession();if(o(f),r((f==null?void 0:f.user)??null),f!=null&&f.user){const v=await m(f.user);i(v)}}catch(f){console.error("Auth init error:",f)}c(!1)})();const{data:{subscription:x}}=k.auth.onAuthStateChange(async(f,v)=>{if(o(v),r((v==null?void 0:v.user)??null),v!=null&&v.user)if(f==="SIGNED_IN")setTimeout(async()=>{const _=await m(v.user);i(_)},500);else{const _=await m(v.user);i(_)}else{i(null);try{localStorage.removeItem("sc_timesheet")}catch{}}});return()=>{x.unsubscribe()}},[u]);const S=async(p,x,f,v)=>{try{const{error:_}=await k.auth.signUp({email:p,password:x,options:{emailRedirectTo:window.location.origin+"./",data:{full_name:f,role:v}}});return _?{error:_.message}:{error:null}}catch(_){return{error:_.message||"Sign up failed"}}},F=async(p,x)=>{try{const{error:f}=await k.auth.signInWithPassword({email:p,password:x});return f?{error:f.message}:{error:null}}catch(f){return{error:f.message||"Sign in failed"}}},g=async()=>{await k.auth.signOut(),r(null),o(null),i(null)},C=async p=>{if(!s)return{error:"Not authenticated"};try{const{error:x}=await k.from("profiles").update({...p,updated_at:new Date().toISOString()}).eq("id",s.id);if(x)return{error:x.message};const f=await u(s.id);return i(f),{error:null}}catch(x){return{error:x.message||"Update failed"}}};return e.jsx(rt.Provider,{value:{user:s,session:a,profile:l,loading:d,signUp:S,signIn:F,signOut:g,updateProfile:C},children:t})},Es={sidebarOpen:!1,toggleSidebar:()=>{}},Ts=n.createContext(Es),Ps=({children:t})=>{const[s,r]=n.useState(!1),a=()=>{r(o=>!o)};return e.jsx(Ts.Provider,{value:{sidebarOpen:s,toggleSidebar:a},children:t})},As="modulepreload",Ds=function(t,s){return new URL(t,s).href},_e={},O=function(s,r,a){let o=Promise.resolve();if(r&&r.length>0){const i=document.getElementsByTagName("link"),d=document.querySelector("meta[property=csp-nonce]"),c=(d==null?void 0:d.nonce)||(d==null?void 0:d.getAttribute("nonce"));o=Promise.allSettled(r.map(u=>{if(u=Ds(u,a),u in _e)return;_e[u]=!0;const m=u.endsWith(".css"),S=m?'[rel="stylesheet"]':"";if(!!a)for(let C=i.length-1;C>=0;C--){const p=i[C];if(p.href===u&&(!m||p.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${u}"]${S}`))return;const g=document.createElement("link");if(g.rel=m?"stylesheet":As,m||(g.as="script"),g.crossOrigin="",g.href=u,c&&g.setAttribute("nonce",c),document.head.appendChild(g),m)return new Promise((C,p)=>{g.addEventListener("load",C),g.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${u}`)))})}))}function l(i){const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=i,window.dispatchEvent(d),!d.defaultPrevented)throw i}return o.then(i=>{for(const d of i||[])d.status==="rejected"&&l(d.reason);return s().catch(l)})};function se(t){const s=t.replace("#","").trim(),r=s.length===3?s.split("").map(i=>i+i).join(""):s,a=parseInt(r.slice(0,2),16),o=parseInt(r.slice(2,4),16),l=parseInt(r.slice(4,6),16);return{r:a,g:o,b:l}}function Is(t,s,r){const a=t/255,o=s/255,l=r/255,i=Math.max(a,o,l),d=Math.min(a,o,l);let c=0;const u=(i+d)/2,m=i-d;let S=0;if(m!==0){switch(S=m/(1-Math.abs(2*u-1)),i){case a:c=(o-l)/m%6;break;case o:c=(l-a)/m+2;break;case l:c=(a-o)/m+4;break}c*=60,c<0&&(c+=360)}const F=Math.round(c),g=Math.round(S*1e3)/10,C=Math.round(u*1e3)/10;return`${F} ${g}% ${C}%`}function N(t){const{r:s,g:r,b:a}=se(t);return Is(s,r,a)}function H(t){const{r:s,g:r,b:a}=se(t),o=[s,r,a].map(l=>{const i=l/255;return i<=.04045?i/12.92:Math.pow((i+.055)/1.055,2.4)});return .2126*o[0]+.7152*o[1]+.0722*o[2]}function ee(t){return H(t)<.45}function at(t){return Math.min(1,Math.max(0,t))}function T(t,s,r){const a=se(t),o=se(s),l=at(r),i=Math.round(a.r+(o.r-a.r)*l),d=Math.round(a.g+(o.g-a.g)*l),c=Math.round(a.b+(o.b-a.b)*l);return`#${[i,d,c].map(u=>u.toString(16).padStart(2,"0")).join("")}`.toUpperCase()}function z(t){return ee(t)?"#F8FAFC":"#0B1220"}function V(t,s,r){const a=r.map(R=>R.toUpperCase()),o=a[0]??"#4C8CFF",l=a[1]??T(o,"#FFFFFF",.25),i=a.length>=5?a[4]:a[2]??"#0B1220",d=a.length>=4?a[3]:ee(i)?T(i,"#FFFFFF",.06):T(i,"#000000",.04),c=a.length>=3?a[2]:z(i);a.length>=6?a[5]:ee(i)?T(d,"#FFFFFF",.14):T(d,"#000000",.12);const u=a.length>=7?a[6]:"#EF4444",m=ee(i)?"dark":"light";function S(R,L,A){return T(R,L==="dark"?"#0B1220":"#F8FAFC",at(A))}function F(R,L){let A=R;for(let y=0;y<6;y++){const j=H(A);if(L==="dark"?j>=.03&&j<=.1:j>=.86&&j<=.98)break;A=S(A,L,.16)}return A=S(A,L,.18),A}const g=F(i,m),C=F(d,m),p=m==="dark"?T(C,"#FFFFFF",.06):T(C,"#000000",.05),x=m==="dark"?T(p,"#FFFFFF",.1):T(p,"#000000",.1),f=z(g),v=z(p),_=v,w=z(o),h={"--background":N(g),"--foreground":N(f),"--card":N(p),"--card-foreground":N(v),"--popover":N(p),"--popover-foreground":N(_),"--primary":N(o),"--primary-foreground":N(w),"--secondary":N(l),"--secondary-foreground":N(z(l)),"--muted":N(m==="dark"?T(g,p,.55):T(g,p,.45)),"--muted-foreground":N(m==="dark"?T(f,"#94A3B8",.55):T(f,"#334155",.55)),"--accent":N(l),"--accent-foreground":N(z(l)),"--border":N(x),"--input":N(x),"--ring":N(o),"--success":N("#16A34A"),"--success-foreground":N("#FFFFFF"),"--warning":N("#F59E0B"),"--warning-foreground":N("#111827"),"--danger":N("#DC2626"),"--danger-foreground":N("#FFFFFF"),"--info":N("#2563EB"),"--info-foreground":N("#FFFFFF"),"--surface-2":N(m==="dark"?T(p,"#FFFFFF",.04):T(p,"#000000",.03)),"--surface-3":N(m==="dark"?T(p,"#FFFFFF",.08):T(p,"#000000",.06)),"--input-bg":N(m==="dark"?T(p,"#FFFFFF",.02):T(p,"#000000",.02)),"--input-border":N(x),"--destructive":N(u),"--destructive-foreground":N(z(u))},M=H(c),I=H(g),P=Math.abs(M-I),D=H(f),$=Math.abs(D-I);return P>$+.15&&(h["--foreground"]=N(c)),{id:t,name:s,mode:m,tokens:h}}function Se(t){return xe.find(s=>s.id===t)}function Ls(t){const s=document.documentElement;s.classList.toggle("dark",t.mode==="dark");for(const[r,a]of Object.entries(t.tokens))s.style.setProperty(r,a)}const xe=[V("ceilings-light","Ceilings Unlimited — Light",["#7CC242","#1F2937","#111827","#F3F4F6","#FAFAFA","#E5E7EB","#DC2626"]),V("ceilings-dark","Ceilings Unlimited — Dark",["#7CC242","#94A3B8","#F1F5F9","#1E293B","#0F172A","#334155","#EF4444"]),V("future-grid","Future Grid",["#3B82F6","#06B6D4","#E2E8F0","#111827","#0B1220","#1F2937","#F43F5E"]),V("ivory-corporate","Ivory Corporate",["#2563EB","#64748B","#111827","#FFFFFF","#F8FAFC","#E2E8F0","#DC2626"]),V("graphite-pro","Graphite Pro",["#D4AF37","#94A3B8","#F8FAFC","#1C1F26","#121417","#2A2F38","#EF4444"])],le="lld-theme";function Rs(t){return t==="ceilings-dark"||t==="graphite-pro"||t==="future-grid"}function Ms(t){return t&&["ceilings-light","ceilings-dark","future-grid","ivory-corporate","graphite-pro"].includes(t)?t:null}function Ce(t){const s=document.documentElement,r=xe.find(a=>a.id===t);if(r){s.dataset.theme=t,s.classList.remove("dark","light");for(const[a,o]of Object.entries(r.tokens))s.style.setProperty(a,o)}}function Os(){const[t,s]=n.useState("ivory-corporate");n.useEffect(()=>{const i=Ms(localStorage.getItem(le))??"ivory-corporate";s(i),Ce(i),localStorage.setItem(le,i)},[]);const r=l=>{s(l),localStorage.setItem(le,l),Ce(l)},a=()=>{r(t==="ceilings-dark"?"ceilings-light":"ceilings-dark")},o=n.useMemo(()=>Rs(t),[t]);return{theme:t,setTheme:r,toggle:a,isDark:o}}function $s(){const{isDark:t,toggle:s}=Os();return e.jsx("button",{type:"button",onClick:s,className:"p-2 rounded-lg border border-border hover:bg-card transition-colors","aria-label":"Toggle theme",title:"Toggle theme",children:t?e.jsx($t,{className:"w-4 h-4 text-foreground"}):e.jsx(Bt,{className:"w-4 h-4 text-foreground"})})}const Bs={weekEndingDay:"Sunday",timesheetPeriod:1,companyName:"",companyLogo:"",lunchDefaultMinutes:30,roundingMinutes:15,features:{analytics:!0,weatherAlerts:!0,teamCollaboration:!0,approvalWorkflow:!1,customReports:!0,autoCarryForward:!0,aiSummary:!0,notifications:!0}},Tr=["Suspended Ceilings / 2-way","Rondo Ceilings","Partition Walls","Aluminium","Plasterboard / Linings","Stopping","Insulation","Carpentry","Fire Rating","Timber Partitions","Electrical","Plumbing","HVAC","Painting","Concrete","Roofing","Landscaping","General Labour","Other"],Pr=[{code:"101",label:"Suspended Ceilings / 2-way"},{code:"102",label:"Rondo Ceilings"},{code:"103",label:"Partition Walls"},{code:"104",label:"Aluminium"},{code:"105",label:"Plasterboard / Linings"},{code:"106",label:"Stopping"},{code:"107",label:"Insulation"},{code:"108",label:"Carpentry"},{code:"109",label:"Other"},{code:"110",label:"Carpet"},{code:"111",label:"FIRE RATING"},{code:"115",label:"Timber Partitions"},{code:"ACCOM",label:"Accommodation Allowance"},{code:"Other",label:"Other (please specify)"},{code:"P&G",label:"Preliminary and General"},{code:"P&Gs",label:"P&G Supervision"},{code:"P&Gt",label:"P&G Travel"},{code:"R/M",label:"Repairs and Maintenance"},{code:"Safety",label:"Safety Equipment"},{code:"Staff",label:"Staff Purchases on Company account"},{code:"Tools",label:"Tools"},{code:"training",label:"Staff Training"}],zs=["Clear","Partly Cloudy","Overcast","Light Rain","Heavy Rain","Wind","Storm","Snow","Fog","Hot","Cold"],Ar=[{value:"note",label:"General Note",color:"bg-primary"},{value:"reminder",label:"Reminder",color:"bg-purple-500"},{value:"meeting",label:"Meeting",color:"bg-indigo-500"},{value:"deadline",label:"Deadline",color:"bg-red-500"},{value:"inspection",label:"Inspection",color:"bg-primary"},{value:"delivery",label:"Delivery",color:"bg-green-500"}],G=[{value:"site_manager",label:"Site Manager",description:"Full access to all features including settings, reports, and team management"},{value:"foreman",label:"Foreman",description:"Access to daily logs, timesheets, calendar, and basic reports"},{value:"safety_officer",label:"Safety Officer",description:"Access to daily logs, safety reports, and inspections"}],ot={site_manager:["dashboard","onsite-walk","daily-logs","calendar","timesheets","reports","job-audit","archive","settings"],foreman:["dashboard","onsite-walk","daily-logs","calendar","timesheets","reports"],safety_officer:["dashboard","onsite-walk","daily-logs","calendar","reports"]},qs="Long Line Diary",nt={appName:qs},ke=[{key:"dashboard",label:"Dashboard",icon:zt},{key:"daily-logs",label:"Daily Logs",icon:qt},{key:"calendar",label:"Calendar",icon:Ut},{key:"timesheets",label:"Timesheets",icon:Vt},{key:"onsite-walk",label:"Onsite Walk",icon:Ht},{key:"reports",label:"Reports",icon:Wt},{key:"archive",label:"Archive",icon:Gt},{key:"settings",label:"Settings",icon:Jt}],Fe=({currentPage:t,onNavigate:s,collapsed:r,onToggle:a,onQuickAdd:o,stats:l,userRole:i})=>{const d=i?ot[i]:ke.map(c=>c.key);return e.jsxs("aside",{className:`fixed left-0 top-0 h-full z-40 flex flex-col bg-card border-r border-border transition-all duration-300 ${r?"w-16":"w-60"}`,children:[e.jsxs("div",{className:"flex items-center gap-3 px-4 h-16 border-b border-border",children:[e.jsx("img",{src:"./icons/ll-developer-logo.png",alt:"Long Line Developer",className:"w-16 h-16 object-contain flex-shrink-0"}),!r&&e.jsxs("div",{className:"overflow-hidden",children:[e.jsx("h1",{className:"text-base font-bold text-foreground tracking-tight leading-none",children:nt.appName}),e.jsx("p",{className:"text-[10px] text-muted-foreground mt-0.5",children:"Construction Diary"})]})]}),o&&e.jsx("div",{className:"px-3 mt-4",children:e.jsxs("button",{onClick:o,className:`w-full flex items-center gap-2 px-3 py-2 rounded-lg bg-primary hover:opacity-90 text-primary-foreground font-semibold text-sm transition ${r?"justify-center":""}`,children:[e.jsx(Yt,{className:"w-4 h-4"}),!r&&e.jsx("span",{children:"New Job"})]})}),e.jsx("nav",{className:"flex-1 mt-4 px-2 space-y-1",children:ke.map(({key:c,label:u,icon:m})=>{const S=t===c,F=c==="dashboard"&&l&&l.overdue>0,g=!d.includes(c);return e.jsxs("button",{onClick:()=>!g&&s(c),disabled:g,title:g?`${u} requires a higher role`:u,className:`w-full flex items-center gap-3 px-3 py-2.5 rounded-lg text-sm font-medium transition-all relative border ${g?"text-muted-foreground/50 cursor-not-allowed border-transparent opacity-60":S?"bg-primary/10 text-primary border-primary/20":"text-muted-foreground hover:text-foreground hover:bg-muted border-transparent"} ${r?"justify-center":""}`,children:[e.jsx(m,{className:"w-5 h-5 flex-shrink-0"}),!r&&e.jsx("span",{children:u}),g&&!r&&e.jsx(Q,{className:"w-3 h-3 ml-auto text-muted-foreground/60"}),F&&!g&&e.jsx("span",{className:`${r?"absolute -top-1 -right-1":"ml-auto"} bg-destructive text-destructive-foreground text-[10px] font-bold rounded-full min-w-[18px] h-[18px] flex items-center justify-center px-1`,children:l.overdue})]},c)})}),e.jsx("div",{className:"px-3 pb-4",children:e.jsx("button",{onClick:a,className:"w-full flex items-center justify-center gap-2 px-3 py-2 rounded-lg text-muted-foreground hover:text-foreground hover:bg-muted transition text-sm",children:r?e.jsx(Qt,{className:"w-4 h-4"}):e.jsxs(e.Fragment,{children:[e.jsx(Kt,{className:"w-4 h-4"}),e.jsx("span",{children:"Collapse"})]})})})]})};function Dr(t){if(!t)return"low";const s=new Date;s.setHours(0,0,0,0);const r=De(t),a=Ct(r,s);return a<=3?"high":a<=7?"medium":"low"}function Ir(t){switch(t){case"high":return"bg-red-500";case"medium":return"bg-primary";case"low":return"bg-emerald-500"}}function Lr(t){if(!t)return"";try{return Ae(De(t),"dd MMM yyyy")}catch{return t}}function Ee(){return Ae(new Date,"yyyy-MM-dd")}function Rr(t,s,r=0){if(!/^\d{2}:\d{2}$/.test(t)||!/^\d{2}:\d{2}$/.test(s))return 0;const[a,o]=t.split(":").map(Number),[l,i]=s.split(":").map(Number),d=a*60+o;let c=l*60+i;c<d&&(c+=24*60);const u=Math.max(0,c-d-r);return Math.round(u/15)*15/60}function Us(t,s){const r=new Date(t,s,1),a=new Date(t,s+1,0);return St({start:r,end:a})}function Mr(t,s){const r=Us(t,s),a=r[0].getDay(),o=[];let l=[];for(let i=0;i<a;i++)l.push(null);for(const i of r)l.push(i),l.length===7&&(o.push(l),l=[]);if(l.length>0){for(;l.length<7;)l.push(null);o.push(l)}return o}function Or(t){if(!t)return null;const s=new Date(t);if(Number.isNaN(s.getTime()))return null;const r=d=>new Date(d.getFullYear(),d.getMonth(),d.getDate()),a=r(new Date),l=r(s).getTime()-a.getTime(),i=Math.round(l/(1e3*60*60*24));return i===0?"Today":i===1?"Tomorrow":i>1?`In ${i} days`:i===-1?"Yesterday":`${Math.abs(i)} days overdue`}async function be(){var s;const{data:t}=await k.auth.getUser();return((s=t==null?void 0:t.user)==null?void 0:s.id)??null}async function Vs(){var s;const t=await be();if(!t)return null;try{const r=await k.from("profiles").select("company_id").eq("id",t).single();return((s=r==null?void 0:r.data)==null?void 0:s.company_id)??null}catch{return null}}async function ae(t){const s=await be();return s?{...t,owner_id:s}:t}function U(t,s){const r={};for(const a of s)a in t&&(r[a]=t[a]);return r}async function Hs(){const{data:t,error:s}=await k.from("projects").select("*").order("created_at",{ascending:!1});if(s)throw s;return t||[]}async function Ws(t){const s=U(t,["name","status"]),r=await ae(s);console.log("createProject uid",await be());const{data:a,error:o}=await k.from("projects").insert(r).select().single();if(o)throw o;const l=a;try{const i=new Date;i.setDate(i.getDate()+1);const d=i.toISOString().slice(0,10);await Ys({project_id:l.id,title:`Complete job card setup for: ${l.name}`,details:"Fill out the job card fields when you get a chance (job number, location, client, dates, etc).",category:"admin",priority:"medium",status:"open",due_date:d,source:"project_setup",source_ref:{type:"project_created_needs_setup"},pinned:!1})}catch(i){console.warn("createProject follow-up action item failed",i)}return l}async function $r(t){let s=k.from("daily_logs").select("*, projects(*)").order("log_date",{ascending:!1});t!=null&&t.date&&(s=s.eq("log_date",t.date)),t!=null&&t.project_id&&(s=s.eq("project_id",t.project_id));const{data:r,error:a}=await s;if(a)throw a;return(r||[]).map(o=>({...o,project:o.projects}))}async function Br(t){const s=await k.from("daily_logs").select("*, projects(*)").eq("id",t).single();if(s.error)throw s.error;const r=s.data;return{...r,project:r.projects,crew:[],activities:[],materials:[],equipment:[],visitors:[]}}async function Gs(t){const s=U(t,["project_id","log_date","notes"]),r=await ae(s),{data:a,error:o}=await k.from("daily_logs").insert(r).select("*, projects(*)").single();if(o)throw o;return{...a,project:a.projects}}async function zr(t,s){const r=U(s,["project_id","log_date","notes"]),{data:a,error:o}=await k.from("daily_logs").update(r).eq("id",t).select("*, projects(*)").single();if(o)throw o;return{...a,project:a.projects}}async function qr(t){const{error:s}=await k.from("daily_logs").delete().eq("id",t);if(s)throw s}async function Ur(t){throw new Error("crew_attendance table does not exist in this Supabase project.")}async function Vr(t,s){throw new Error("crew_attendance table does not exist in this Supabase project.")}async function Hr(t){throw new Error("crew_attendance table does not exist in this Supabase project.")}async function Wr(t){throw new Error("work_activities table does not exist in this Supabase project.")}async function Gr(t,s){throw new Error("work_activities table does not exist in this Supabase project.")}async function Jr(t){throw new Error("work_activities table does not exist in this Supabase project.")}async function Yr(t){throw new Error("materials table does not exist in this Supabase project.")}async function Qr(t,s){throw new Error("materials table does not exist in this Supabase project.")}async function Kr(t){throw new Error("materials table does not exist in this Supabase project.")}async function Xr(t){throw new Error("equipment_logs table does not exist in this Supabase project.")}async function Zr(t,s){throw new Error("equipment_logs table does not exist in this Supabase project.")}async function ea(t){throw new Error("equipment_logs table does not exist in this Supabase project.")}async function ta(t){throw new Error("visitors table does not exist in this Supabase project.")}async function sa(t,s){throw new Error("visitors table does not exist in this Supabase project.")}async function ra(t){throw new Error("visitors table does not exist in this Supabase project.")}async function aa(t,s){let r=k.from("calendar_notes").select("*").order("note_date");if(t!==void 0&&s!==void 0){const l=`${s}-${String(t+1).padStart(2,"0")}-01`,i=t===11?0:t+1,c=`${t===11?s+1:s}-${String(i+1).padStart(2,"0")}-01`;r=r.gte("note_date",l).lt("note_date",c)}const{data:a,error:o}=await r;if(o)throw o;return a||[]}async function oa(t){const s=U(t,["note_date","title","description","note_type","priority","project_id","action_item_id","is_completed"]),r=await ae(s),{data:a,error:o}=await k.from("calendar_notes").insert(r).select().single();if(o)throw o;return a}async function na(t,s){const r=U(s,["note_date","title","description","note_type","priority","project_id","action_item_id","is_completed"]),{data:a,error:o}=await k.from("calendar_notes").update(r).eq("id",t).select().single();if(o)throw o;return a}async function ia(t){const{error:s}=await k.from("calendar_notes").delete().eq("id",t);if(s)throw s}async function la(){return Bs}async function ca(t){}async function da(){const{data:t,error:s}=await k.rpc("get_command_center_rows");if(s)throw s;const r=t??[],a=c=>{const u=(c.title??"").toString(),m=(c.details??"").toString();return{id:c.id,title:u,description:m||u,notes:m||null,equipment_name:u||null,worker_name:u||null,priority:c.priority??"medium",due_date:c.due_date??null,status:c.status,category:c.category,project_id:c.project_id??null,site_name:c.site_name??null,bucket:c.bucket,created_at:c.created_at,updated_at:c.updated_at}},o=[],l=[],i=[],d=[];for(const c of r){const u=a(c),m=(c.category??"").toLowerCase();m.includes("material")?l.push(u):m.includes("equip")?i.push(u):m.includes("crew")?d.push(u):o.push(u)}return{activities:o,materials:l,equipment:i,crew:d}}async function Js(){const t=new Date().toISOString().split("T")[0],[s,r,a]=await Promise.all([k.from("projects").select("id, status").eq("status","active"),k.from("daily_logs").select("id, log_date").eq("log_date",t),k.from("calendar_notes").select("id, priority, is_completed, note_date")]);if(s.error)throw s.error;if(r.error)throw r.error;if(a.error)throw a.error;const o=(s.data||[]).length,l=(r.data||[]).length,d=(a.data||[]).filter(g=>g.is_completed===!1).filter(g=>g.priority==="high").length;return{activeProjects:o,totalLogs:l,highPriorityLogs:d,safetyIncidents:0,overdueActivities:0,overdueMaterials:0,pendingMaterials:0,totalOverdue:0}}async function Ys(t){let s=U(t,["company_id","project_id","site_name","title","details","category","priority","status","due_date","defer_until","pinned","source","source_ref"]);if(!s.company_id){const l=await Vs();if(!l)throw new Error("No company assigned to this user (profiles.company_id is null). Set company_id in profiles, then retry.");s={...s,company_id:l}}const r=await ae(s),{data:a,error:o}=await k.from("action_items").insert(r).select("*").single();if(o)throw o;return a}async function ua(t){const s=Math.min(Math.max((t==null?void 0:t.limit)??10,1),50);let r=k.from("action_items").select("id, project_id, title, details, category, priority, status, due_date, defer_until, pinned, source, created_at").is("deleted_at",null).order("created_at",{ascending:!1}).limit(s);t!=null&&t.project_id&&(r=r.eq("project_id",t.project_id));const{data:a,error:o}=await r;if(o)throw o;return a||[]}const Qs=({open:t,onClose:s,onCreated:r})=>{const[a,o]=n.useState([]),[l,i]=n.useState("new"),[d,c]=n.useState(""),[u,m]=n.useState(!1),[S,F]=n.useState(""),[g,C]=n.useState(""),[p,x]=n.useState(""),[f,v]=n.useState(""),[_,w]=n.useState(Ee()),[h,M]=n.useState(""),[I,P]=n.useState(""),[D,$]=n.useState(""),[R,L]=n.useState(""),[A,y]=n.useState("low"),[j,B]=n.useState("");n.useEffect(()=>{t&&Hs().then(o).catch(console.error)},[t]);const J=async b=>{b.preventDefault(),m(!0);try{let Y=d;l==="new"&&(Y=(await Ws({name:S,job_number:g,location:p,client:f,status:"active"})).id);const jt=await Gs({project_id:Y,log_date:_,weather:h,temperature:I,wind:D,site_conditions:R,priority:A,notes:j,safety_incidents:"",critical_items:"",is_completed:!1});r(jt.id),vt()}catch(Y){console.error(Y),alert("Failed to create job")}m(!1)},vt=()=>{F(""),C(""),x(""),v(""),w(Ee()),M(""),P(""),$(""),L(""),y("low"),B(""),c(""),i("new")};return t?e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm",onClick:s,children:e.jsxs("div",{className:"bg-card border border-border rounded-2xl w-full max-w-lg max-h-[90vh] overflow-y-auto shadow-2xl",onClick:b=>b.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-border",children:[e.jsx("h2",{className:"text-lg font-bold text-foreground",children:"New Job Entry"}),e.jsx("button",{onClick:s,className:"p-1 rounded-lg hover:bg-surface-3/60 text-muted-foreground hover:text-foreground",children:e.jsx(re,{className:"w-5 h-5"})})]}),e.jsxs("form",{onSubmit:J,className:"p-4 space-y-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"button",onClick:()=>i("new"),className:`flex-1 py-2 rounded-lg text-sm font-medium transition-colors ${l==="new"?"bg-primary text-primary-foreground":"bg-surface-2 text-foreground/80 hover:bg-surface-3/60"}`,children:"New Project"}),e.jsx("button",{type:"button",onClick:()=>i("existing"),className:`flex-1 py-2 rounded-lg text-sm font-medium transition-colors ${l==="existing"?"bg-primary text-primary-foreground":"bg-surface-2 text-foreground/80 hover:bg-surface-3/60"}`,children:"Existing Project"})]}),l==="existing"?e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-muted-foreground mb-1",children:"Select Project"}),e.jsxs("select",{value:d,onChange:b=>c(b.target.value),required:!0,className:"lld-input w-full px-3 py-2 rounded-lg text-sm",children:[e.jsx("option",{value:"",children:"Choose a project..."}),a.map(b=>e.jsxs("option",{value:b.id,children:[b.job_number?`[${b.job_number}] `:"",b.name]},b.id))]})]}):e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-muted-foreground mb-1",children:"Project Name *"}),e.jsx("input",{value:S,onChange:b=>F(b.target.value),required:!0,className:"lld-input w-full px-3 py-2 rounded-lg text-sm",placeholder:"e.g. Smith St Fitout"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-muted-foreground mb-1",children:"Job Number"}),e.jsx("input",{value:g,onChange:b=>C(b.target.value),className:"lld-input w-full px-3 py-2 rounded-lg text-sm",placeholder:"e.g. 1234"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-muted-foreground mb-1",children:"Location"}),e.jsx("input",{value:p,onChange:b=>x(b.target.value),className:"lld-input w-full px-3 py-2 rounded-lg text-sm",placeholder:"e.g. Auckland CBD"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-muted-foreground mb-1",children:"Client"}),e.jsx("input",{value:f,onChange:b=>v(b.target.value),className:"lld-input w-full px-3 py-2 rounded-lg text-sm",placeholder:"e.g. ABC Corp"})]})]})]}),e.jsx("hr",{className:"border-border"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-muted-foreground mb-1",children:"Date *"}),e.jsx("input",{type:"date",value:_,onChange:b=>w(b.target.value),required:!0,className:"lld-input w-full px-3 py-2 rounded-lg text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-muted-foreground mb-1",children:"Priority"}),e.jsxs("select",{value:A,onChange:b=>y(b.target.value),className:"lld-input w-full px-3 py-2 rounded-lg text-sm",children:[e.jsx("option",{value:"low",children:"Low"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"high",children:"High"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-muted-foreground mb-1",children:"Weather"}),e.jsxs("select",{value:h,onChange:b=>M(b.target.value),className:"lld-input w-full px-3 py-2 rounded-lg text-sm",children:[e.jsx("option",{value:"",children:"Select..."}),zs.map(b=>e.jsx("option",{value:b,children:b},b))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-muted-foreground mb-1",children:"Temperature"}),e.jsx("input",{value:I,onChange:b=>P(b.target.value),className:"lld-input w-full px-3 py-2 rounded-lg text-sm",placeholder:"e.g. 18Â°C"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-muted-foreground mb-1",children:"Wind"}),e.jsx("input",{value:D,onChange:b=>$(b.target.value),className:"lld-input w-full px-3 py-2 rounded-lg text-sm",placeholder:"e.g. Light NW"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-muted-foreground mb-1",children:"Site Conditions"}),e.jsx("input",{value:R,onChange:b=>L(b.target.value),className:"lld-input w-full px-3 py-2 rounded-lg text-sm",placeholder:"e.g. Dry, good access"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-muted-foreground mb-1",children:"Notes"}),e.jsx("textarea",{value:j,onChange:b=>B(b.target.value),rows:2,className:"lld-input w-full px-3 py-2 rounded-lg text-sm resize-none",placeholder:"Any additional notes..."})]}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx("button",{type:"button",onClick:s,className:"flex-1 py-2.5 rounded-lg bg-surface-2 text-foreground/80 hover:bg-surface-3/60 text-sm font-medium transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:u,className:"flex-1 py-2.5 rounded-lg bg-primary hover:bg-primary/90 text-primary-foreground text-sm font-bold transition-colors disabled:opacity-50",children:u?"Creating...":"Create Job"})]})]})]})}):null},q="lld-input w-full pl-10 pr-4 py-3 rounded-xl text-sm transition-all",ue=({open:t,onClose:s})=>{var A;const{signIn:r,signUp:a}=he(),[o,l]=n.useState("signin"),[i,d]=n.useState(""),[c,u]=n.useState(""),[m,S]=n.useState(""),[F,g]=n.useState(""),[C,p]=n.useState("foreman"),[x,f]=n.useState(!1),[v,_]=n.useState(!1),[w,h]=n.useState(null),[M,I]=n.useState(null),P=()=>{d(""),u(""),S(""),g(""),p("foreman"),h(null),I(null)};n.useEffect(()=>{t&&(l("signin"),P())},[t]);const D=y=>{l(y),P()},$=async y=>{if(y.preventDefault(),h(null),!i||!c){h("Please fill in all fields");return}_(!0);const{error:j}=await r(i,c);if(_(!1),j){h(j);return}s(),P()},R=async y=>{if(y.preventDefault(),h(null),!i||!c||!F){h("Please fill in all fields");return}if(c.length<6){h("Password must be at least 6 characters");return}if(c!==m){h("Passwords do not match");return}_(!0);const{error:j}=await a(i,c,F,C);if(_(!1),j){h(j);return}I("Account created! You can now sign in."),setTimeout(()=>{D("signin")},1500)};if(!t)return null;const L={site_manager:Qe,foreman:Ye,safety_officer:ce};return e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:s}),e.jsxs("div",{className:"relative w-full max-w-md bg-card border border-border/50 rounded-2xl shadow-2xl overflow-hidden",children:[e.jsxs("div",{className:"relative bg-surface-2/60 px-6 pt-6 pb-4",children:[e.jsx("button",{onClick:s,className:"absolute top-4 right-4 p-2 rounded-lg hover:bg-surface-2 text-muted-foreground hover:text-foreground transition-colors",children:e.jsx(re,{className:"w-5 h-5"})}),e.jsxs("div",{className:"flex items-center gap-5 mb-4",children:[e.jsx("img",{src:"./icons/ll-developer-logo-v2.png",alt:"Long Line Diary",className:"w-16 h-16 object-contain flex-shrink-0"}),e.jsxs("div",{className:"ml-2",children:[e.jsx("h2",{className:"text-lg font-bold text-foreground leading-tight",children:nt.appName}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Construction Management Platform"})]})]}),e.jsxs("div",{className:"flex bg-surface-2 rounded-xl p-1",children:[e.jsx("button",{onClick:()=>D("signin"),className:`flex-1 py-2 px-4 rounded-lg text-sm font-medium transition-all ${o==="signin"?"bg-primary text-primary-foreground shadow-lg shadow-primary/15":"text-muted-foreground hover:text-foreground"}`,children:"Sign In"}),e.jsx("button",{onClick:()=>D("signup"),className:`flex-1 py-2 px-4 rounded-lg text-sm font-medium transition-all ${o==="signup"?"bg-primary text-primary-foreground shadow-lg shadow-primary/15":"text-muted-foreground hover:text-foreground"}`,children:"Create Account"})]})]}),e.jsxs("div",{className:"px-6 pb-6 pt-2",children:[w&&e.jsxs("div",{className:"flex items-center gap-2 p-3 mb-4 rounded-xl bg-red-500/10 border border-red-500/20 text-red-400 text-sm",children:[e.jsx(ce,{className:"w-4 h-4 flex-shrink-0"}),e.jsx("span",{children:w})]}),M&&e.jsxs("div",{className:"flex items-center gap-2 p-3 mb-4 rounded-xl bg-green-500/10 border border-green-500/20 text-green-400 text-sm",children:[e.jsx(Xt,{className:"w-4 h-4 flex-shrink-0"}),e.jsx("span",{children:M})]}),o==="signin"?e.jsxs("form",{onSubmit:$,className:"space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(ye,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx("input",{type:"email",placeholder:"Email address",value:i,onChange:y=>d(y.target.value),className:q,autoComplete:"email"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(Q,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx("input",{type:x?"text":"password",placeholder:"Password",value:c,onChange:y=>u(y.target.value),className:`${q} pr-10`,autoComplete:"current-password"}),e.jsx("button",{type:"button",onClick:()=>f(!x),className:"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground transition-colors",children:x?e.jsx(ve,{className:"w-4 h-4"}):e.jsx(je,{className:"w-4 h-4"})})]}),e.jsxs("button",{type:"submit",disabled:v,className:"w-full py-3 rounded-xl bg-primary text-primary-foreground font-semibold text-sm transition-all shadow-lg shadow-primary/15 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[v?e.jsx(we,{className:"w-4 h-4 animate-spin"}):null,v?"Signing in...":"Sign In"]})]}):e.jsxs("form",{onSubmit:R,className:"space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(de,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx("input",{type:"text",placeholder:"Full name",value:F,onChange:y=>g(y.target.value),className:q,autoComplete:"name"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(ye,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx("input",{type:"email",placeholder:"Email address",value:i,onChange:y=>d(y.target.value),className:q,autoComplete:"email"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-muted-foreground mb-2",children:"Your Role"}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:G.map(y=>{const j=L[y.value],B=C===y.value;return e.jsxs("button",{type:"button",onClick:()=>p(y.value),className:`flex flex-col items-center gap-1.5 p-3 rounded-xl border transition-all text-center ${B?"bg-primary/10 border-primary/40 text-primary":"bg-surface-2/70 border-border/50 text-muted-foreground hover:border-border"}`,children:[e.jsx(j,{className:"w-5 h-5"}),e.jsx("span",{className:"text-xs font-medium leading-tight",children:y.label})]},y.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground/80 mt-1.5",children:(A=G.find(y=>y.value===C))==null?void 0:A.description})]}),e.jsxs("div",{className:"relative",children:[e.jsx(Q,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx("input",{type:x?"text":"password",placeholder:"Password (min 6 characters)",value:c,onChange:y=>u(y.target.value),className:`${q} pr-10`,autoComplete:"new-password"}),e.jsx("button",{type:"button",onClick:()=>f(!x),className:"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground transition-colors",children:x?e.jsx(ve,{className:"w-4 h-4"}):e.jsx(je,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"relative",children:[e.jsx(Q,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx("input",{type:x?"text":"password",placeholder:"Confirm password",value:m,onChange:y=>S(y.target.value),className:q,autoComplete:"new-password"})]}),e.jsxs("button",{type:"submit",disabled:v,className:"w-full py-3 rounded-xl bg-primary text-primary-foreground font-semibold text-sm transition-all shadow-lg shadow-primary/15 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[v?e.jsx(we,{className:"w-4 h-4 animate-spin"}):null,v?"Creating account...":"Create Account"]})]}),e.jsx("p",{className:"text-center text-xs text-muted-foreground/80 mt-4",children:o==="signin"?e.jsxs(e.Fragment,{children:["Don't have an account?"," ",e.jsx("button",{onClick:()=>D("signup"),className:"text-primary hover:text-primary/90 font-medium",children:"Create one"})]}):e.jsxs(e.Fragment,{children:["Already have an account?"," ",e.jsx("button",{onClick:()=>D("signin"),className:"text-primary hover:text-primary/90 font-medium",children:"Sign in"})]})})]})]})]})},Te=n.lazy(()=>O(()=>import("./DashboardPage-BfPzem9r.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8]),import.meta.url)),Ks=n.lazy(()=>O(()=>import("./DailyLogsPage-Bz7KPwnr.js"),__vite__mapDeps([9,1,2,3,5,6,7,8]),import.meta.url)),Xs=n.lazy(()=>O(()=>import("./CalendarPage-MZCCMkeg.js"),__vite__mapDeps([10,1,2,3,5,6,7,8]),import.meta.url)),Zs=n.lazy(()=>O(()=>import("./TimesheetPage-CvFk_FS_.js"),__vite__mapDeps([11,1,3,5,6,7,8]),import.meta.url)),er=n.lazy(()=>O(()=>import("./OnsiteWalkPage-bVu4wlwh.js"),__vite__mapDeps([12,1,5,3,6,7,8]),import.meta.url)),tr=n.lazy(()=>O(()=>import("./ReportsPage-dP1DLSiw.js"),__vite__mapDeps([13,1,2,3,5,6,7,8]),import.meta.url)),sr=n.lazy(()=>O(()=>import("./JobAuditReportPage-D5ogiVUm.js"),__vite__mapDeps([14,1,3,5,6,7,8]),import.meta.url)),rr=n.lazy(()=>O(()=>import("./ArchivePage-BNtCbPyz.js"),__vite__mapDeps([15,1,4,2,3,5,6,7,8]),import.meta.url)),ar=n.lazy(()=>O(()=>import("./SettingsPage-DHVkI18a.js"),__vite__mapDeps([16,1,3,5,6,7,8]),import.meta.url)),or={site_manager:Qe,foreman:Ye,safety_officer:ce},nr=()=>{var A,y;const{user:t,profile:s,loading:r,signOut:a}=he(),[o,l]=n.useState("dashboard"),[i,d]=n.useState(!1),[c,u]=n.useState(!1),[m,S]=n.useState(!1),[F,g]=n.useState(!1),[C,p]=n.useState(!1),[x,f]=n.useState(null),[v,_]=n.useState(0),w=(s==null?void 0:s.role)||null;n.useEffect(()=>{if(!t){_(0);return}Js().then(j=>_(j.totalOverdue)).catch(()=>{})},[t==null?void 0:t.id,o]),n.useEffect(()=>{if(!C)return;const j=B=>p(!1);return document.addEventListener("click",j),()=>document.removeEventListener("click",j)},[C]);const h=n.useCallback((j,B)=>{const J=j;w&&!ot[w].includes(J)||(l(J),f(B||null),u(!1))},[w]),M=n.useCallback(j=>{S(!1),l("daily-logs"),f({logId:j})},[]),I=async()=>{await a(),p(!1),l("dashboard")},P=()=>{switch(o){case"dashboard":return e.jsx(Te,{onNavigate:h,onQuickAdd:()=>S(!0)});case"daily-logs":return e.jsx(Ks,{initialData:x});case"calendar":return e.jsx(Xs,{onNavigate:h,initialData:x});case"timesheets":return e.jsx(Zs,{});case"onsite-walk":return e.jsx(er,{});case"reports":return e.jsx(tr,{onNavigate:h});case"job-audit":return e.jsx(sr,{});case"archive":return e.jsx(rr,{});case"settings":return e.jsx(ar,{userRole:w});default:return e.jsx(Te,{onNavigate:h,onQuickAdd:()=>S(!0)})}},D=(s==null?void 0:s.full_name)||((A=t==null?void 0:t.email)==null?void 0:A.split("@")[0])||"",$=(t==null?void 0:t.email)||"",R=w?or[w]:de,L=w&&((y=G.find(j=>j.value===w))==null?void 0:y.label)||"";return r?e.jsx("div",{className:"min-h-screen flex items-center justify-center text-foreground",children:"Loading..."}):t?e.jsxs("div",{className:"min-h-screen bg-background",children:[c&&e.jsx("div",{className:"fixed inset-0 z-30 bg-black/50 lg:hidden",onClick:()=>u(!1)}),e.jsx("div",{className:"hidden lg:block print:hidden",children:e.jsx(Fe,{currentPage:o,onNavigate:j=>{h(j)},collapsed:i,onToggle:()=>d(!i),onQuickAdd:()=>S(!0),stats:{overdue:v,highPriority:0},userRole:w})}),e.jsx("div",{className:`lg:hidden fixed inset-y-0 left-0 z-40 transition-transform duration-300 print:hidden ${c?"translate-x-0":"-translate-x-full"}`,children:e.jsx(Fe,{currentPage:o,onNavigate:j=>{h(j)},collapsed:i,onToggle:()=>d(!i),onQuickAdd:()=>{S(!0),u(!1)},stats:{overdue:v,highPriority:0},userRole:w})}),e.jsxs("main",{className:`transition-all duration-300 min-h-screen print:ml-0 ${i?"ml-16":"ml-60"}`,children:[e.jsx("header",{className:"sticky top-0 z-20 bg-background/80 backdrop-blur-xl border-b border-border/50 px-4 lg:px-6 py-3 print:hidden",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx($s,{}),e.jsx("button",{onClick:()=>u(!c),className:"lg:hidden p-2 rounded-lg hover:bg-card text-foreground",children:c?e.jsx(re,{className:"w-5 h-5"}):e.jsx(Zt,{className:"w-5 h-5"})}),e.jsx("h2",{className:"text-sm font-bold text-foreground dark:text-primary capitalize",children:o.replace("-"," ")})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-xs text-foreground hidden sm:inline",children:new Date().toLocaleDateString("en-NZ",{weekday:"long",day:"numeric",month:"long",year:"numeric"})}),r?e.jsx("div",{className:"w-8 h-8 rounded-full bg-card animate-pulse"}):t?e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:j=>{j.stopPropagation(),p(!C)},className:"flex items-center gap-2 pl-2 pr-3 py-1.5 rounded-xl bg-card/80 border border-border/50 hover:border-border transition-all",children:[e.jsx("div",{className:"w-7 h-7 rounded-lg bg-primary flex items-center justify-center",children:e.jsx("span",{className:"text-xs font-bold text-foreground",children:D.charAt(0).toUpperCase()||"U"})}),e.jsxs("div",{className:"hidden sm:block text-left",children:[e.jsx("p",{className:"text-xs font-medium text-foreground dark:text-primary leading-none",children:D}),e.jsx("p",{className:"text-[10px] text-foreground leading-none mt-0.5",children:L})]}),e.jsx(ge,{className:"w-3 h-3 text-foreground"})]}),C&&e.jsxs("div",{className:"absolute right-0 top-full mt-2 w-64 bg-card border border-border/50 rounded-xl shadow-2xl overflow-hidden",onClick:j=>j.stopPropagation(),children:[e.jsxs("div",{className:"px-4 py-3 border-b border-border/50",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-primary flex items-center justify-center",children:e.jsx("span",{className:"text-sm font-bold text-foreground",children:D.charAt(0).toUpperCase()||"U"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-semibold text-foreground dark:text-primary truncate",children:D}),e.jsx("p",{className:"text-xs text-foreground truncate",children:$})]})]}),e.jsxs("div",{className:"flex items-center gap-1.5 mt-2 px-2 py-1 rounded-lg bg-card/50 w-fit",children:[e.jsx(R,{className:"w-3 h-3 text-primary"}),e.jsx("span",{className:"text-[10px] font-medium text-primary",children:L})]})]}),e.jsxs("div",{className:"p-1.5",children:[e.jsxs("button",{onClick:()=>{p(!1),h("settings")},className:"w-full flex items-center gap-3 px-3 py-2 rounded-lg text-sm text-foreground hover:bg-card/50 hover:text-foreground transition-colors",children:[e.jsx(de,{className:"w-4 h-4"}),e.jsx("span",{children:"Profile & Settings"})]}),e.jsxs("button",{onClick:I,className:"w-full flex items-center gap-3 px-3 py-2 rounded-lg text-sm text-red-400 hover:bg-red-500/10 transition-colors",children:[e.jsx(es,{className:"w-4 h-4"}),e.jsx("span",{children:"Sign Out"})]})]})]})]}):e.jsxs("button",{onClick:()=>g(!0),className:"flex items-center gap-2 px-4 py-2 rounded-xl bg-primary hover:bg-primary/90 text-foreground font-semibold text-xs transition-all shadow-lg shadow-primary/20",children:[e.jsx(ts,{className:"w-3.5 h-3.5"}),e.jsx("span",{children:"Sign In"})]})]})]})}),e.jsx("div",{className:"p-4 lg:p-6",children:e.jsx(n.Suspense,{fallback:e.jsx("div",{className:"p-6 text-foreground text-sm",children:"Loading…"}),children:P()})})]}),e.jsx(Qs,{open:m,onClose:()=>S(!1),onCreated:M}),e.jsx(ue,{open:F,onClose:()=>g(!1)})]}):e.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center gap-6 bg-background",children:[e.jsx("div",{className:"text-2xl font-semibold",children:"Long Line Diary"}),e.jsx("button",{onClick:()=>g(!0),className:"px-6 py-3 rounded-lg bg-primary text-primary-foreground font-semibold",children:"Sign In"}),e.jsx(ue,{open:F,onClose:()=>g(!1)})]})},ir=()=>{const t=is();return n.useEffect(()=>{console.error("404 Error: User attempted to access non-existent route:",t.pathname)},[t.pathname]),e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background",children:e.jsxs("div",{className:"text-center p-8 rounded-lg border border-border bg-card shadow-md animate-slide-in",children:[e.jsx("h1",{className:"text-5xl font-bold mb-6 text-primary",children:"404"}),e.jsx("p",{className:"text-xl text-card-foreground mb-6",children:"Page not found"}),e.jsx("a",{href:"/",className:"text-primary hover:text-primary/80 underline transition-colors",children:"Return to Home"})]})})},it=""+new URL("login-landing-DB_GgVW8.jpg",import.meta.url).href;function lr(){const[t,s]=n.useState(!1);return e.jsx("div",{className:"min-h-screen w-full bg-cover bg-center bg-no-repeat",style:{backgroundImage:"url("+it+")"},children:e.jsx("div",{className:"min-h-screen w-full flex items-center justify-center bg-black/20 p-6",children:e.jsxs("div",{className:"w-full max-w-md text-center",children:[e.jsx("img",{src:"./icons/ll-developer-logo-v2.png",alt:"Long Line Diary",className:"mx-auto w-72 md:w-96 object-contain cursor-pointer opacity-40 hover:opacity-70 transition-opacity duration-500",onClick:()=>s(!0)}),e.jsx(ue,{open:t,onClose:()=>s(!1)})]})})})}const lt=n.forwardRef(({className:t,...s},r)=>e.jsx("div",{ref:r,className:E("rounded-lg border border-border/40 bg-background shadow-sm",t),...s}));lt.displayName="Card";const ct=n.forwardRef(({className:t,...s},r)=>e.jsx("div",{ref:r,className:E("flex flex-col space-y-1.5 p-6",t),...s}));ct.displayName="CardHeader";const dt=n.forwardRef(({className:t,...s},r)=>e.jsx("h3",{ref:r,className:E("text-2xl font-semibold leading-none tracking-tight text-foreground",t),...s}));dt.displayName="CardTitle";const ut=n.forwardRef(({className:t,...s},r)=>e.jsx("p",{ref:r,className:E("text-sm text-muted-foreground",t),...s}));ut.displayName="CardDescription";const mt=n.forwardRef(({className:t,...s},r)=>e.jsx("div",{ref:r,className:E("p-6 pt-0",t),...s}));mt.displayName="CardContent";const cr=n.forwardRef(({className:t,...s},r)=>e.jsx("div",{ref:r,className:E("flex items-center p-6 pt-0",t),...s}));cr.displayName="CardFooter";const me=n.forwardRef(({className:t,type:s,...r},a)=>e.jsx("input",{type:s,className:E("flex h-10 w-full rounded-md border border-border/60 bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:a,...r}));me.displayName="Input";const dr=fe("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",{variants:{variant:{default:"text-foreground",muted:"text-muted-foreground",accent:"text-primary"},size:{default:"text-sm",xs:"text-xs",sm:"text-sm",lg:"text-base"}},defaultVariants:{variant:"default",size:"default"}}),te=n.forwardRef(({className:t,variant:s,size:r,...a},o)=>e.jsx(ze,{ref:o,className:E(dr({variant:s,size:r}),t),...a}));te.displayName=ze.displayName;const ur=fe("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),pe=n.forwardRef(({className:t,variant:s,size:r,asChild:a=!1,...o},l)=>{const i=a?Pt:"button";return e.jsx(i,{className:E(ur({variant:s,size:r,className:t})),ref:l,...o})});pe.displayName="Button";const mr=Mt,pr=Ot,pt=n.forwardRef(({className:t,children:s,...r},a)=>e.jsxs(qe,{ref:a,className:E("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground/60 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-primary focus-visible:border-primary/50 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1 transition-colors",t),...r,children:[s,e.jsx(At,{asChild:!0,children:e.jsx(ge,{className:"h-4 w-4 opacity-50 transition-transform duration-200 ease-in-out group-data-[state=open]:rotate-180"})})]}));pt.displayName=qe.displayName;const ft=n.forwardRef(({className:t,...s},r)=>e.jsx(Ue,{ref:r,className:E("flex cursor-default items-center justify-center py-1 text-muted-foreground",t),...s,children:e.jsx(ss,{className:"h-4 w-4"})}));ft.displayName=Ue.displayName;const gt=n.forwardRef(({className:t,...s},r)=>e.jsx(Ve,{ref:r,className:E("flex cursor-default items-center justify-center py-1 text-muted-foreground",t),...s,children:e.jsx(ge,{className:"h-4 w-4"})}));gt.displayName=Ve.displayName;const ht=n.forwardRef(({className:t,children:s,position:r="popper",...a},o)=>e.jsx(Dt,{children:e.jsxs(He,{ref:o,className:E("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border border-border/40 bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 duration-200",r==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:r,...a,children:[e.jsx(ft,{}),e.jsx(It,{className:E("p-1",r==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:s}),e.jsx(gt,{})]})}));ht.displayName=He.displayName;const fr=n.forwardRef(({className:t,...s},r)=>e.jsx(We,{ref:r,className:E("py-1.5 pl-8 pr-2 text-sm font-medium text-muted-foreground",t),...s}));fr.displayName=We.displayName;const xt=n.forwardRef(({className:t,children:s,...r},a)=>e.jsxs(Ge,{ref:a,className:E("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent/50 focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 transition-colors",t),...r,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(Lt,{children:e.jsx(rs,{className:"h-4 w-4 text-primary"})})}),e.jsx(Rt,{children:s})]}));xt.displayName=Ge.displayName;const gr=n.forwardRef(({className:t,...s},r)=>e.jsx(Je,{ref:r,className:E("-mx-1 my-1 h-px bg-muted",t),...s}));gr.displayName=Je.displayName;function hr(){const{user:t,loading:s,profile:r,updateProfile:a,signOut:o}=he(),[l,i]=n.useState(!1),[d,c]=n.useState(null),[u,m]=n.useState(null),[S,F]=n.useState(null),[g,C]=n.useState(""),[p,x]=n.useState(""),[f,v]=n.useState(void 0),_=n.useMemo(()=>!!(r&&r.onboarded===!1),[r]);if(n.useEffect(()=>{_&&(C(w=>w||((r==null?void 0:r.company_name)??"")),x(w=>w||((r==null?void 0:r.site_name)??"")),v(w=>w||(r==null?void 0:r.role)))},[_,r==null?void 0:r.company_name,r==null?void 0:r.site_name,r==null?void 0:r.role]),s)return e.jsx("div",{className:"min-h-screen w-full flex items-center justify-center text-foreground",children:"Loading..."});if(!t)return e.jsx(lr,{});if(_){const w=G.find(h=>h.value===f);return e.jsx("div",{className:"min-h-screen w-full bg-cover bg-center bg-no-repeat",style:{backgroundImage:"url("+it+")"},children:e.jsx("div",{className:"min-h-screen w-full flex items-center justify-center bg-black/40 p-6",children:e.jsxs(lt,{className:"w-full max-w-md shadow-2xl backdrop-blur-sm bg-background/95",children:[e.jsxs(ct,{className:"relative",children:[e.jsx("div",{className:"absolute right-6 top-6",children:e.jsx(pe,{type:"button",variant:"ghost",size:"sm",disabled:l,onClick:async()=>{try{c(null),await o()}catch(h){c((h==null?void 0:h.message)||"Failed to sign out.")}},children:"Sign out"})}),e.jsx(dt,{children:"Welcome to Long Line Diary"}),e.jsx(ut,{children:"Set up your company profile to continue."})]}),e.jsxs(mt,{className:"space-y-5",children:[d&&e.jsx("div",{className:"text-sm text-red-600 bg-red-50 border border-red-200 rounded-lg p-3",children:d}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(te,{children:"Company Name"}),e.jsx(me,{value:g,onChange:h=>{C(h.target.value),u&&m(null),d&&c(null)},placeholder:"Enter company name",autoFocus:!0}),u&&e.jsx("div",{className:"text-xs text-red-600",children:u})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(te,{children:"Role"}),e.jsxs(mr,{value:f,onValueChange:h=>{v(h),S&&F(null),d&&c(null)},children:[e.jsx(pt,{className:"h-auto min-h-10 items-start",children:e.jsx(pr,{placeholder:"Select your role",className:"whitespace-normal break-words text-left"})}),e.jsx(ht,{className:"max-w-[var(--radix-select-trigger-width)]",children:G.map(h=>e.jsx(xt,{value:h.value,children:e.jsxs("div",{className:"flex flex-col text-left whitespace-normal break-words",children:[e.jsx("div",{className:"text-sm leading-snug whitespace-normal break-words",children:h.label}),e.jsx("div",{className:"text-xs opacity-70 leading-snug whitespace-normal break-words",children:h.description})]})},h.value))})]}),w!=null&&w.description?e.jsx("div",{className:"text-xs opacity-70 whitespace-normal break-words",children:w.description}):null,S&&e.jsx("div",{className:"text-xs text-red-600",children:S})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(te,{children:"Primary Site (Optional)"}),e.jsx(me,{value:p,onChange:h=>{x(h.target.value),d&&c(null)},placeholder:"e.g. Bethlehem Medical Centre"})]}),e.jsx(pe,{className:"w-full mt-4",disabled:l,onClick:async()=>{const h=g.trim(),M=p.trim();let I=!0;if(h?m(null):(m("Company name is required."),I=!1),f?F(null):(F("Please select a role."),I=!1),!!I)try{i(!0),c(null);const P=await a({company_name:h,site_name:M||null,role:f,onboarded:!0});P!=null&&P.error&&c(P.error)}catch(P){c((P==null?void 0:P.message)||"Failed to complete onboarding.")}finally{i(!1)}},children:l?"Saving...":"Continue to Dashboard"})]})]})})})}return e.jsx(ls,{basename:"./",future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:e.jsxs(cs,{children:[e.jsx(oe,{path:"/",element:e.jsx(ds,{to:"/dashboard",replace:!0})}),e.jsx(oe,{path:"/*",element:e.jsx(nr,{})}),e.jsx(oe,{path:"*",element:e.jsx(ir,{})})]})})}const xr=new as,br=()=>e.jsx(js,{defaultTheme:"light",children:e.jsx(os,{client:xr,children:e.jsxs(_s,{children:[e.jsx(vs,{}),e.jsx(Ns,{}),e.jsx(Fs,{children:e.jsx(Ps,{children:e.jsx(hr,{})})})]})})}),bt="lld.themeId";function yr(){try{return localStorage.getItem(bt)}catch{return null}}function vr(t){try{localStorage.setItem(bt,t)}catch{}}function jr(){return xe[0]}function wr(){const t=yr(),s=t&&Se(t)?Se(t):jr();return Ls(s),t||vr(s.id),s}wr();function yt(t){try{const s=document.createElement("pre");s.style.whiteSpace="pre-wrap",s.style.wordBreak="break-word",s.style.padding="16px",s.style.margin="0",s.style.fontFamily="ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New', monospace",s.textContent=t,document.body.innerHTML="",document.body.appendChild(s)}catch{}}window.addEventListener("error",t=>{const s=t==null?void 0:t.error,r=`FATAL: window.error

`+String((t==null?void 0:t.message)||"Unknown error")+(s!=null&&s.stack?`

`+s.stack:"");yt(r)});window.addEventListener("unhandledrejection",t=>{const s=t==null?void 0:t.reason,r=`FATAL: unhandledrejection

`+String((s==null?void 0:s.message)||s||"Unknown rejection")+(s!=null&&s.stack?`

`+s.stack:"");yt(r)});"serviceWorker"in navigator&&navigator.serviceWorker.getRegistrations().then(t=>{t.forEach(s=>s.unregister())});kt(document.getElementById("root")).render(e.jsx(Ft.StrictMode,{children:e.jsx(br,{})}));export{Yr as A,Xr as B,ta as C,aa as D,na as E,gs as F,ia as G,oa as H,la as I,Pr as J,ua as K,Ys as L,Ws as M,Ar as N,he as O,Os as P,Bs as Q,nt as R,xe as S,Tr as T,G as U,ca as V,zs as W,$r as a,da as b,Lr as c,Br as d,Ir as e,Hs as f,Mr as g,qr as h,Vr as i,Hr as j,Gr as k,Jr as l,Qr as m,Kr as n,Zr as o,ea as p,sa as q,Or as r,k as s,Ee as t,zr as u,ra as v,Rr as w,Ur as x,Dr as y,Wr as z};
