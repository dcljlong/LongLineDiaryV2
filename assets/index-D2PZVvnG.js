const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/DashboardPage-C9e1CwR0.js","assets/vendor-PYixsk0d.js","assets/PriorityBadge-DGNu8hBn.js","assets/icons-DUP5S1G1.js","assets/radix-D8qNXTYQ.js","assets/tanstack-C9VkMA4e.js","assets/supabase-BGS_MQFj.js","assets/router-DIvsDq8X.js","assets/DailyLogsPage-FTwlxZw-.js","assets/CalendarPage-nGDJC_HM.js","assets/TimesheetPage-C8jRUMOr.js","assets/ReportsPage-Qf-Bzvu3.js","assets/SettingsPage-BoHu2Wil.js"])))=>i.map(i=>d[i]);
import{r as n,B as yt,C as vt,j as e,D as ue,$ as jt,E as Ee,F as Pe,G as wt,H as Nt,J as Ct}from"./vendor-PYixsk0d.js";import{V as Te,R as De,A as Ae,C as Ie,T as Le,D as Re,P as St,a as Oe,b as _t,c as Me,S as kt,d as qe,I as Ft,e as Be,f as $e,g as Et,h as Ve,i as Pt,L as ze,j as Ue,k as Tt,l as Dt,m as Ge,n as At,o as It}from"./radix-D8qNXTYQ.js";import{X as re,S as Lt,M as Rt,L as Ot,C as Mt,a as qt,b as Bt,c as $t,d as Vt,P as zt,e as Y,f as Ut,g as Gt,h as ie,i as Ht,j as xe,E as he,k as be,l as ye,U as le,H as He,m as We,n as Wt,o as me,p as Jt,q as Qt,r as Yt,s as Xt}from"./icons-DUP5S1G1.js";import{Q as Zt,a as Kt}from"./tanstack-C9VkMA4e.js";import{c as er}from"./supabase-BGS_MQFj.js";import{u as tr,B as rr,R as sr,a as se,N as ar}from"./router-DIvsDq8X.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))a(o);new MutationObserver(o=>{for(const l of o)if(l.type==="childList")for(const i of l.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&a(i)}).observe(document,{childList:!0,subtree:!0});function s(o){const l={};return o.integrity&&(l.integrity=o.integrity),o.referrerPolicy&&(l.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?l.credentials="include":o.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function a(o){if(o.ep)return;o.ep=!0;const l=s(o);fetch(o.href,l)}})();const or=1,nr=1e6;let ae=0;function ir(){return ae=(ae+1)%Number.MAX_SAFE_INTEGER,ae.toString()}const oe=new Map,ve=t=>{if(oe.has(t))return;const r=setTimeout(()=>{oe.delete(t),H({type:"REMOVE_TOAST",toastId:t})},nr);oe.set(t,r)},lr=(t,r)=>{switch(r.type){case"ADD_TOAST":return{...t,toasts:[r.toast,...t.toasts].slice(0,or)};case"UPDATE_TOAST":return{...t,toasts:t.toasts.map(s=>s.id===r.toast.id?{...s,...r.toast}:s)};case"DISMISS_TOAST":{const{toastId:s}=r;return s?ve(s):t.toasts.forEach(a=>{ve(a.id)}),{...t,toasts:t.toasts.map(a=>a.id===s||s===void 0?{...a,open:!1}:a)}}case"REMOVE_TOAST":return r.toastId===void 0?{...t,toasts:[]}:{...t,toasts:t.toasts.filter(s=>s.id!==r.toastId)}}},X=[];let Z={toasts:[]};function H(t){Z=lr(Z,t),X.forEach(r=>{r(Z)})}function cr({...t}){const r=ir(),s=o=>H({type:"UPDATE_TOAST",toast:{...o,id:r}}),a=()=>H({type:"DISMISS_TOAST",toastId:r});return H({type:"ADD_TOAST",toast:{...t,id:r,open:!0,onOpenChange:o=>{o||a()}}}),{id:r,dismiss:a,update:s}}function dr(){const[t,r]=n.useState(Z);return n.useEffect(()=>(X.push(r),()=>{const s=X.indexOf(r);s>-1&&X.splice(s,1)}),[t]),{...t,toast:cr,dismiss:s=>H({type:"DISMISS_TOAST",toastId:s})}}function F(...t){return yt(vt(t))}const ur=St,Je=n.forwardRef(({className:t,...r},s)=>e.jsx(Te,{ref:s,className:F("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",t),...r}));Je.displayName=Te.displayName;const mr=ue("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),Qe=n.forwardRef(({className:t,variant:r,...s},a)=>e.jsx(De,{ref:a,className:F(mr({variant:r}),t),...s}));Qe.displayName=De.displayName;const fr=n.forwardRef(({className:t,...r},s)=>e.jsx(Ae,{ref:s,className:F("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",t),...r}));fr.displayName=Ae.displayName;const Ye=n.forwardRef(({className:t,...r},s)=>e.jsx(Ie,{ref:s,className:F("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",t),"toast-close":"",...r,children:e.jsx(re,{className:"h-4 w-4"})}));Ye.displayName=Ie.displayName;const Xe=n.forwardRef(({className:t,...r},s)=>e.jsx(Le,{ref:s,className:F("text-sm font-semibold",t),...r}));Xe.displayName=Le.displayName;const Ze=n.forwardRef(({className:t,...r},s)=>e.jsx(Re,{ref:s,className:F("text-sm opacity-90",t),...r}));Ze.displayName=Re.displayName;function gr(){const{toasts:t}=dr();return e.jsxs(ur,{children:[t.map(function({id:r,title:s,description:a,action:o,...l}){return e.jsxs(Qe,{...l,children:[e.jsxs("div",{className:"grid gap-1",children:[s&&e.jsx(Xe,{children:s}),a&&e.jsx(Ze,{children:a})]}),o,e.jsx(Ye,{})]},r)}),e.jsx(Je,{})]})}const Ke=n.createContext(null);function pr({children:t,defaultTheme:r="system",value:s,...a}){const[o,l]=n.useState(()=>{if(typeof window<"u"){const d=localStorage.getItem("theme");return d&&(d==="dark"||d==="light"||d==="system")?d:r}return r});n.useEffect(()=>{const d=window.document.documentElement;d.classList.remove("dark"),d.classList.add("light")},[]);const i={theme:o,setTheme:d=>{localStorage.setItem("theme",d),l(d)}};return e.jsx(Ke.Provider,{value:i,...a,children:t})}const xr=()=>{const t=n.useContext(Ke);if(!t)throw new Error("useTheme must be used within a ThemeProvider");return t},hr=({...t})=>{const{theme:r}=xr();return e.jsx(jt,{theme:r,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...t})},br=_t,yr=n.forwardRef(({className:t,sideOffset:r=4,...s},a)=>e.jsx(Oe,{ref:a,sideOffset:r,className:F("z-50 overflow-hidden rounded-md border border-border/40 bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-lg animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...s}));yr.displayName=Oe.displayName;const vr="https://qbqceybdmesgqsvvhfzl.supabase.co",jr="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InFicWNleWJkbWVzZ3FzdnZoZnpsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzE4Nzc2NzQsImV4cCI6MjA4NzQ1MzY3NH0.UgDmKnVvvX3WcESuXp8EVkuZDIIQ7KblubQX-hcpR3c",u=er(vr,jr),et=n.createContext({user:null,session:null,profile:null,loading:!0,signUp:async()=>({error:null}),signIn:async()=>({error:null}),signOut:async()=>{},updateProfile:async()=>({error:null})}),fe=()=>n.useContext(et),wr=({children:t})=>{const[r,s]=n.useState(null),[a,o]=n.useState(null),[l,i]=n.useState(null),[d,c]=n.useState(!0),m=n.useCallback(async p=>{try{const{data:x,error:g}=await u.from("profiles").select("*").eq("id",p).maybeSingle();return g?(console.error("Profile fetch error:",g),null):x}catch(x){return console.error("Profile fetch exception:",x),null}},[]),f=n.useCallback(async p=>{const x=await m(p.id);if(x)return x;const g=p.user_metadata??{},j={id:p.id,full_name:g.full_name??"",role:g.role??"foreman",onboarded:!1};try{const{error:h}=await u.from("profiles").insert(j);return h?(console.error("Profile insert error:",h),null):await m(p.id)}catch(h){return console.error("Profile insert exception:",h),null}},[m]);n.useEffect(()=>{(async()=>{try{const{data:{session:g}}=await u.auth.getSession();if(o(g),s((g==null?void 0:g.user)??null),g!=null&&g.user){const j=await f(g.user);i(j)}}catch(g){console.error("Auth init error:",g)}c(!1)})();const{data:{subscription:x}}=u.auth.onAuthStateChange(async(g,j)=>{if(o(j),s((j==null?void 0:j.user)??null),j!=null&&j.user)if(g==="SIGNED_IN")setTimeout(async()=>{const h=await f(j.user);i(h)},500);else{const h=await f(j.user);i(h)}else{i(null);try{localStorage.removeItem("sc_timesheet")}catch{}}});return()=>{x.unsubscribe()}},[m]);const y=async(p,x,g,j)=>{try{const{error:h}=await u.auth.signUp({email:p,password:x,options:{emailRedirectTo:window.location.origin+"/LongLineDiaryV2/",data:{full_name:g,role:j}}});return h?{error:h.message}:{error:null}}catch(h){return{error:h.message||"Sign up failed"}}},b=async(p,x)=>{try{const{error:g}=await u.auth.signInWithPassword({email:p,password:x});return g?{error:g.message}:{error:null}}catch(g){return{error:g.message||"Sign in failed"}}},S=async()=>{await u.auth.signOut(),s(null),o(null),i(null)},E=async p=>{if(!r)return{error:"Not authenticated"};try{const{error:x}=await u.from("profiles").update({...p,updated_at:new Date().toISOString()}).eq("id",r.id);if(x)return{error:x.message};const g=await m(r.id);return i(g),{error:null}}catch(x){return{error:x.message||"Update failed"}}};return e.jsx(et.Provider,{value:{user:r,session:a,profile:l,loading:d,signUp:y,signIn:b,signOut:S,updateProfile:E},children:t})},Nr={sidebarOpen:!1,toggleSidebar:()=>{}},Cr=n.createContext(Nr),Sr=({children:t})=>{const[r,s]=n.useState(!1),a=()=>{s(o=>!o)};return e.jsx(Cr.Provider,{value:{sidebarOpen:r,toggleSidebar:a},children:t})},_r="modulepreload",kr=function(t){return"/LongLineDiaryV2/"+t},je={},z=function(r,s,a){let o=Promise.resolve();if(s&&s.length>0){document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),d=(i==null?void 0:i.nonce)||(i==null?void 0:i.getAttribute("nonce"));o=Promise.allSettled(s.map(c=>{if(c=kr(c),c in je)return;je[c]=!0;const m=c.endsWith(".css"),f=m?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${f}`))return;const y=document.createElement("link");if(y.rel=m?"stylesheet":_r,m||(y.as="script"),y.crossOrigin="",y.href=c,d&&y.setAttribute("nonce",d),document.head.appendChild(y),m)return new Promise((b,S)=>{y.addEventListener("load",b),y.addEventListener("error",()=>S(new Error(`Unable to preload CSS for ${c}`)))})}))}function l(i){const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=i,window.dispatchEvent(d),!d.defaultPrevented)throw i}return o.then(i=>{for(const d of i||[])d.status==="rejected"&&l(d.reason);return r().catch(l)})};function te(t){const r=t.replace("#","").trim(),s=r.length===3?r.split("").map(i=>i+i).join(""):r,a=parseInt(s.slice(0,2),16),o=parseInt(s.slice(2,4),16),l=parseInt(s.slice(4,6),16);return{r:a,g:o,b:l}}function Fr(t,r,s){const a=t/255,o=r/255,l=s/255,i=Math.max(a,o,l),d=Math.min(a,o,l);let c=0;const m=(i+d)/2,f=i-d;let y=0;if(f!==0){switch(y=f/(1-Math.abs(2*m-1)),i){case a:c=(o-l)/f%6;break;case o:c=(l-a)/f+2;break;case l:c=(a-o)/f+4;break}c*=60,c<0&&(c+=360)}const b=Math.round(c),S=Math.round(y*1e3)/10,E=Math.round(m*1e3)/10;return`${b} ${S}% ${E}%`}function _(t){const{r,g:s,b:a}=te(t);return Fr(r,s,a)}function G(t){const{r,g:s,b:a}=te(t),o=[r,s,a].map(l=>{const i=l/255;return i<=.04045?i/12.92:Math.pow((i+.055)/1.055,2.4)});return .2126*o[0]+.7152*o[1]+.0722*o[2]}function K(t){return G(t)<.45}function tt(t){return Math.min(1,Math.max(0,t))}function P(t,r,s){const a=te(t),o=te(r),l=tt(s),i=Math.round(a.r+(o.r-a.r)*l),d=Math.round(a.g+(o.g-a.g)*l),c=Math.round(a.b+(o.b-a.b)*l);return`#${[i,d,c].map(m=>m.toString(16).padStart(2,"0")).join("")}`.toUpperCase()}function $(t){return K(t)?"#F8FAFC":"#0B1220"}function U(t,r,s){const a=s.map(R=>R.toUpperCase()),o=a[0]??"#4C8CFF",l=a[1]??P(o,"#FFFFFF",.25),i=a.length>=5?a[4]:a[2]??"#0B1220",d=a.length>=4?a[3]:K(i)?P(i,"#FFFFFF",.06):P(i,"#000000",.04),c=a.length>=3?a[2]:$(i);a.length>=6?a[5]:K(i)?P(d,"#FFFFFF",.14):P(d,"#000000",.12);const m=a.length>=7?a[6]:"#EF4444",f=K(i)?"dark":"light";function y(R,L,D){return P(R,L==="dark"?"#0B1220":"#F8FAFC",tt(D))}function b(R,L){let D=R;for(let w=0;w<6;w++){const C=G(D);if(L==="dark"?C>=.03&&C<=.1:C>=.86&&C<=.98)break;D=y(D,L,.16)}return D=y(D,L,.18),D}const S=b(i,f),E=b(d,f),p=f==="dark"?P(E,"#FFFFFF",.06):P(E,"#000000",.05),x=f==="dark"?P(p,"#FFFFFF",.1):P(p,"#000000",.1),g=$(S),j=$(p),h=j,N=$(o),k={"--background":_(S),"--foreground":_(g),"--card":_(p),"--card-foreground":_(j),"--popover":_(p),"--popover-foreground":_(h),"--primary":_(o),"--primary-foreground":_(N),"--secondary":_(l),"--secondary-foreground":_($(l)),"--muted":_(f==="dark"?P(S,p,.55):P(S,p,.45)),"--muted-foreground":_(f==="dark"?P(g,"#94A3B8",.55):P(g,"#334155",.55)),"--accent":_(l),"--accent-foreground":_($(l)),"--border":_(x),"--input":_(x),"--ring":_(o),"--success":_("#16A34A"),"--success-foreground":_("#FFFFFF"),"--warning":_("#F59E0B"),"--warning-foreground":_("#111827"),"--danger":_("#DC2626"),"--danger-foreground":_("#FFFFFF"),"--info":_("#2563EB"),"--info-foreground":_("#FFFFFF"),"--surface-2":_(f==="dark"?P(p,"#FFFFFF",.04):P(p,"#000000",.03)),"--surface-3":_(f==="dark"?P(p,"#FFFFFF",.08):P(p,"#000000",.06)),"--input-bg":_(f==="dark"?P(p,"#FFFFFF",.02):P(p,"#000000",.02)),"--input-border":_(x),"--destructive":_(m),"--destructive-foreground":_($(m))},I=G(c),T=G(S),O=Math.abs(I-T),A=G(g),M=Math.abs(A-T);return O>M+.15&&(k["--foreground"]=_(c)),{id:t,name:r,mode:f,tokens:k}}function we(t){return ge.find(r=>r.id===t)}function Er(t){const r=document.documentElement;r.classList.toggle("dark",t.mode==="dark");for(const[s,a]of Object.entries(t.tokens))r.style.setProperty(s,a)}const ge=[U("ceilings-light","Ceilings Unlimited — Light",["#7CC242","#1F2937","#111827","#F3F4F6","#FAFAFA","#E5E7EB","#DC2626"]),U("ceilings-dark","Ceilings Unlimited — Dark",["#7CC242","#94A3B8","#F1F5F9","#1E293B","#0F172A","#334155","#EF4444"]),U("future-grid","Future Grid",["#3B82F6","#06B6D4","#E2E8F0","#111827","#0B1220","#1F2937","#F43F5E"]),U("ivory-corporate","Ivory Corporate",["#2563EB","#64748B","#111827","#FFFFFF","#F8FAFC","#E2E8F0","#DC2626"]),U("graphite-pro","Graphite Pro",["#D4AF37","#94A3B8","#F8FAFC","#1C1F26","#121417","#2A2F38","#EF4444"])],ne="lld-theme";function Pr(t){return t==="ceilings-dark"||t==="graphite-pro"||t==="future-grid"}function Tr(t){return t&&["ceilings-light","ceilings-dark","future-grid","ivory-corporate","graphite-pro"].includes(t)?t:null}function Ne(t){const r=document.documentElement,s=ge.find(a=>a.id===t);if(s){r.dataset.theme=t,r.classList.remove("dark","light");for(const[a,o]of Object.entries(s.tokens))r.style.setProperty(a,o)}}function Dr(){const[t,r]=n.useState("ivory-corporate");n.useEffect(()=>{const i=Tr(localStorage.getItem(ne))??"ivory-corporate";r(i),Ne(i),localStorage.setItem(ne,i)},[]);const s=l=>{r(l),localStorage.setItem(ne,l),Ne(l)},a=()=>{s(t==="ceilings-dark"?"ceilings-light":"ceilings-dark")},o=n.useMemo(()=>Pr(t),[t]);return{theme:t,setTheme:s,toggle:a,isDark:o}}function Ar(){const{isDark:t,toggle:r}=Dr();return e.jsx("button",{type:"button",onClick:r,className:"p-2 rounded-lg border border-border hover:bg-card transition-colors","aria-label":"Toggle theme",title:"Toggle theme",children:t?e.jsx(Lt,{className:"w-4 h-4 text-foreground"}):e.jsx(Rt,{className:"w-4 h-4 text-foreground"})})}const Ce={weekEndingDay:"Sunday",timesheetPeriod:1,companyName:"",companyLogo:"",lunchDefaultMinutes:30,roundingMinutes:15,features:{analytics:!0,weatherAlerts:!0,teamCollaboration:!0,approvalWorkflow:!1,customReports:!0,autoCarryForward:!0,aiSummary:!0,notifications:!0}},bs=["Suspended Ceilings / 2-way","Rondo Ceilings","Partition Walls","Aluminium","Plasterboard / Linings","Stopping","Insulation","Carpentry","Fire Rating","Timber Partitions","Electrical","Plumbing","HVAC","Painting","Concrete","Roofing","Landscaping","General Labour","Other"],ys=[{code:"101",label:"Suspended Ceilings / 2-way"},{code:"102",label:"Rondo Ceilings"},{code:"103",label:"Partition Walls"},{code:"104",label:"Aluminium"},{code:"105",label:"Plasterboard / Linings"},{code:"106",label:"Stopping"},{code:"107",label:"Insulation"},{code:"108",label:"Carpentry"},{code:"109",label:"Other"},{code:"110",label:"Carpet"},{code:"111",label:"FIRE RATING"},{code:"115",label:"Timber Partitions"},{code:"ACCOM",label:"Accommodation Allowance"},{code:"Other",label:"Other (please specify)"},{code:"P&G",label:"Preliminary and General"},{code:"P&Gs",label:"P&G Supervision"},{code:"P&Gt",label:"P&G Travel"},{code:"R/M",label:"Repairs and Maintenance"},{code:"Safety",label:"Safety Equipment"},{code:"Staff",label:"Staff Purchases on Company account"},{code:"Tools",label:"Tools"},{code:"training",label:"Staff Training"}],Ir=["Clear","Partly Cloudy","Overcast","Light Rain","Heavy Rain","Wind","Storm","Snow","Fog","Hot","Cold"],vs=[{value:"note",label:"General Note",color:"bg-primary"},{value:"reminder",label:"Reminder",color:"bg-purple-500"},{value:"meeting",label:"Meeting",color:"bg-indigo-500"},{value:"deadline",label:"Deadline",color:"bg-red-500"},{value:"inspection",label:"Inspection",color:"bg-primary"},{value:"delivery",label:"Delivery",color:"bg-green-500"}],W=[{value:"site_manager",label:"Site Manager",description:"Full access to all features including settings, reports, and team management"},{value:"foreman",label:"Foreman",description:"Access to daily logs, timesheets, calendar, and basic reports"},{value:"safety_officer",label:"Safety Officer",description:"Access to daily logs, safety reports, and inspections"}],rt={site_manager:["dashboard","daily-logs","calendar","timesheets","reports","settings"],foreman:["dashboard","daily-logs","calendar","timesheets","reports"],safety_officer:["dashboard","daily-logs","calendar","reports"]},Lr="Long Line Diary",st={appName:Lr},Se=[{key:"dashboard",label:"Dashboard",icon:Ot},{key:"daily-logs",label:"Daily Logs",icon:Mt},{key:"calendar",label:"Calendar",icon:qt},{key:"timesheets",label:"Timesheets",icon:Bt},{key:"reports",label:"Reports",icon:$t},{key:"settings",label:"Settings",icon:Vt}],_e=({currentPage:t,onNavigate:r,collapsed:s,onToggle:a,onQuickAdd:o,stats:l,userRole:i})=>{const d=i?rt[i]:Se.map(c=>c.key);return e.jsxs("aside",{className:`fixed left-0 top-0 h-full z-40 flex flex-col bg-card border-r border-border transition-all duration-300 ${s?"w-16":"w-60"}`,children:[e.jsxs("div",{className:"flex items-center gap-3 px-4 h-16 border-b border-border",children:[e.jsx("img",{src:"/LongLineDiaryV2/icons/ll-developer-logo.png",alt:"Long Line Developer",className:"w-16 h-16 object-contain flex-shrink-0"}),!s&&e.jsxs("div",{className:"overflow-hidden",children:[e.jsx("h1",{className:"text-base font-bold text-foreground tracking-tight leading-none",children:st.appName}),e.jsx("p",{className:"text-[10px] text-muted-foreground mt-0.5",children:"Construction Diary"})]})]}),o&&e.jsx("div",{className:"px-3 mt-4",children:e.jsxs("button",{onClick:o,className:`w-full flex items-center gap-2 px-3 py-2 rounded-lg bg-primary hover:opacity-90 text-primary-foreground font-semibold text-sm transition ${s?"justify-center":""}`,children:[e.jsx(zt,{className:"w-4 h-4"}),!s&&e.jsx("span",{children:"New Job"})]})}),e.jsx("nav",{className:"flex-1 mt-4 px-2 space-y-1",children:Se.map(({key:c,label:m,icon:f})=>{const y=t===c,b=c==="dashboard"&&l&&l.overdue>0,S=!d.includes(c);return e.jsxs("button",{onClick:()=>!S&&r(c),disabled:S,title:S?`${m} requires a higher role`:m,className:`w-full flex items-center gap-3 px-3 py-2.5 rounded-lg text-sm font-medium transition-all relative border ${S?"text-muted-foreground/50 cursor-not-allowed border-transparent opacity-60":y?"bg-primary/10 text-primary border-primary/20":"text-muted-foreground hover:text-foreground hover:bg-muted border-transparent"} ${s?"justify-center":""}`,children:[e.jsx(f,{className:"w-5 h-5 flex-shrink-0"}),!s&&e.jsx("span",{children:m}),S&&!s&&e.jsx(Y,{className:"w-3 h-3 ml-auto text-muted-foreground/60"}),b&&!S&&e.jsx("span",{className:`${s?"absolute -top-1 -right-1":"ml-auto"} bg-destructive text-destructive-foreground text-[10px] font-bold rounded-full min-w-[18px] h-[18px] flex items-center justify-center px-1`,children:l.overdue})]},c)})}),e.jsx("div",{className:"px-3 pb-4",children:e.jsx("button",{onClick:a,className:"w-full flex items-center justify-center gap-2 px-3 py-2 rounded-lg text-muted-foreground hover:text-foreground hover:bg-muted transition text-sm",children:s?e.jsx(Ut,{className:"w-4 h-4"}):e.jsxs(e.Fragment,{children:[e.jsx(Gt,{className:"w-4 h-4"}),e.jsx("span",{children:"Collapse"})]})})})]})};function js(t){if(!t)return"low";const r=new Date;r.setHours(0,0,0,0);const s=Pe(t),a=wt(s,r);return a<=3?"high":a<=7?"medium":"low"}function ws(t){switch(t){case"high":return"bg-red-500/10 border-red-500/30 text-red-400";case"medium":return"bg-primary/10 border-primary/30 text-primary";case"low":return"bg-emerald-500/10 border-emerald-500/30 text-emerald-400"}}function Ns(t){switch(t){case"high":return"bg-red-500";case"medium":return"bg-primary";case"low":return"bg-emerald-500"}}function Cs(t){if(!t)return"";try{return Ee(Pe(t),"dd MMM yyyy")}catch{return t}}function ke(){return Ee(new Date,"yyyy-MM-dd")}function Ss(t,r,s=0){if(!/^\d{2}:\d{2}$/.test(t)||!/^\d{2}:\d{2}$/.test(r))return 0;const[a,o]=t.split(":").map(Number),[l,i]=r.split(":").map(Number),d=a*60+o;let c=l*60+i;c<d&&(c+=24*60);const m=Math.max(0,c-d-s);return Math.round(m/15)*15/60}function Rr(t,r){const s=new Date(t,r,1),a=new Date(t,r+1,0);return Nt({start:s,end:a})}function _s(t,r){const s=Rr(t,r),a=s[0].getDay(),o=[];let l=[];for(let i=0;i<a;i++)l.push(null);for(const i of s)l.push(i),l.length===7&&(o.push(l),l=[]);if(l.length>0){for(;l.length<7;)l.push(null);o.push(l)}return o}async function pe(){const{data:{user:t}}=await u.auth.getUser();return(t==null?void 0:t.id)??null}async function B(t){const r=await pe();return r?{...t,user_id:r}:t}async function Or(){const{data:t,error:r}=await u.from("projects").select("*").order("created_at",{ascending:!1});if(r)throw r;return t||[]}async function Mr(t){const r=await B(t),{data:s,error:a}=await u.from("projects").insert(r).select().single();if(a)throw a;return s}async function ks(t){let r=u.from("daily_logs").select("*, projects(*)").order("log_date",{ascending:!1});t!=null&&t.date&&(r=r.eq("log_date",t.date)),t!=null&&t.project_id&&(r=r.eq("project_id",t.project_id));const{data:s,error:a}=await r;if(a)throw a;return(s||[]).map(o=>({...o,project:o.projects}))}async function Fs(t){const[r,s,a,o,l,i]=await Promise.all([u.from("daily_logs").select("*, projects(*)").eq("id",t).single(),u.from("crew_attendance").select("*").eq("daily_log_id",t).order("created_at"),u.from("work_activities").select("*").eq("daily_log_id",t).order("created_at"),u.from("materials").select("*").eq("daily_log_id",t).order("created_at"),u.from("equipment_logs").select("*").eq("daily_log_id",t).order("created_at"),u.from("visitors").select("*").eq("daily_log_id",t).order("created_at")]);if(r.error)throw r.error;const d=r.data;return{...d,project:d.projects,crew:s.data||[],activities:a.data||[],materials:o.data||[],equipment:l.data||[],visitors:i.data||[]}}async function qr(t){const{project:r,crew:s,activities:a,materials:o,equipment:l,visitors:i,...d}=t,c=await B(d),{data:m,error:f}=await u.from("daily_logs").insert(c).select("*, projects(*)").single();if(f)throw f;return{...m,project:m.projects}}async function Es(t,r){const{project:s,crew:a,activities:o,materials:l,equipment:i,visitors:d,...c}=r,{data:m,error:f}=await u.from("daily_logs").update(c).eq("id",t).select("*, projects(*)").single();if(f)throw f;return{...m,project:m.projects}}async function Ps(t){const{error:r}=await u.from("daily_logs").delete().eq("id",t);if(r)throw r}async function Ts(t){const r=await B(t),{data:s,error:a}=await u.from("crew_attendance").insert(r).select().single();if(a)throw a;return s}async function Ds(t,r){const{data:s,error:a}=await u.from("crew_attendance").update(r).eq("id",t).select().single();if(a)throw a;return s}async function As(t){const{error:r}=await u.from("crew_attendance").delete().eq("id",t);if(r)throw r}async function Is(t){const r=await B(t),{data:s,error:a}=await u.from("work_activities").insert(r).select().single();if(a)throw a;return s}async function Ls(t,r){const{data:s,error:a}=await u.from("work_activities").update(r).eq("id",t).select().single();if(a)throw a;return s}async function Rs(t){const{error:r}=await u.from("work_activities").delete().eq("id",t);if(r)throw r}async function Os(t){const r=await B(t),{data:s,error:a}=await u.from("materials").insert(r).select().single();if(a)throw a;return s}async function Ms(t,r){const{data:s,error:a}=await u.from("materials").update(r).eq("id",t).select().single();if(a)throw a;return s}async function qs(t){const{error:r}=await u.from("materials").delete().eq("id",t);if(r)throw r}async function Bs(t){const r=await B(t),{data:s,error:a}=await u.from("equipment_logs").insert(r).select().single();if(a)throw a;return s}async function $s(t,r){const{data:s,error:a}=await u.from("equipment_logs").update(r).eq("id",t).select().single();if(a)throw a;return s}async function Vs(t){const{error:r}=await u.from("equipment_logs").delete().eq("id",t);if(r)throw r}async function zs(t){const r=await B(t),{data:s,error:a}=await u.from("visitors").insert(r).select().single();if(a)throw a;return s}async function Us(t,r){const{data:s,error:a}=await u.from("visitors").update(r).eq("id",t).select().single();if(a)throw a;return s}async function Gs(t){const{error:r}=await u.from("visitors").delete().eq("id",t);if(r)throw r}async function Hs(t,r){let s=u.from("calendar_notes").select("*").order("note_date");if(t!==void 0&&r!==void 0){const l=`${r}-${String(t+1).padStart(2,"0")}-01`,i=t===11?0:t+1,c=`${t===11?r+1:r}-${String(i+1).padStart(2,"0")}-01`;s=s.gte("note_date",l).lt("note_date",c)}const{data:a,error:o}=await s;if(o)throw o;return a||[]}async function Ws(t){const r=await B(t),{data:s,error:a}=await u.from("calendar_notes").insert(r).select().single();if(a)throw a;return s}async function Js(t,r){const{data:s,error:a}=await u.from("calendar_notes").update(r).eq("id",t).select().single();if(a)throw a;return s}async function Qs(t){const{error:r}=await u.from("calendar_notes").delete().eq("id",t);if(r)throw r}async function Ys(){const t=await pe();let r=u.from("app_settings").select("*").eq("setting_key","main");t&&(r=r.eq("user_id",t));const{data:s}=await r;return s&&s.length>0&&s[0].setting_value?{...Ce,...s[0].setting_value}:Ce}async function Xs(t){const r=await pe(),s={setting_key:"main",setting_value:t,updated_at:new Date().toISOString()};r&&(s.user_id=r);const{error:a}=await u.from("app_settings").upsert(s,{onConflict:"setting_key"});if(a)throw a}async function Zs(){const[t,r,s,a]=await Promise.all([u.from("work_activities").select("*, daily_logs(*, projects(*))").eq("is_completed",!1).order("due_date"),u.from("materials").select("*, daily_logs(*, projects(*))").eq("is_completed",!1).order("required_date"),u.from("equipment_logs").select("*, daily_logs(*, projects(*))").eq("is_completed",!1).order("due_date"),u.from("crew_attendance").select("*, daily_logs(*, projects(*))").eq("is_completed",!1).order("due_date")]);return{activities:t.data||[],materials:r.data||[],equipment:s.data||[],crew:a.data||[]}}async function Br(){const[t,r,s,a]=await Promise.all([u.from("projects").select("id, status").eq("status","active"),u.from("daily_logs").select("id, priority, safety_incidents, is_completed"),u.from("work_activities").select("id, is_completed, due_date"),u.from("materials").select("id, is_completed, required_date, status")]),o=(t.data||[]).length,l=(r.data||[]).length,i=(r.data||[]).filter(b=>b.priority==="high").length,d=(r.data||[]).filter(b=>b.safety_incidents&&b.safety_incidents.trim()).length,c=new Date().toISOString().split("T")[0],m=(s.data||[]).filter(b=>!b.is_completed&&b.due_date&&b.due_date<c).length,f=(a.data||[]).filter(b=>!b.is_completed&&b.required_date&&b.required_date<c).length,y=(a.data||[]).filter(b=>b.status==="pending").length;return{activeProjects:o,totalLogs:l,highPriorityLogs:i,safetyIncidents:d,overdueActivities:m,overdueMaterials:f,pendingMaterials:y,totalOverdue:m+f}}const $r=({open:t,onClose:r,onCreated:s})=>{const[a,o]=n.useState([]),[l,i]=n.useState("new"),[d,c]=n.useState(""),[m,f]=n.useState(!1),[y,b]=n.useState(""),[S,E]=n.useState(""),[p,x]=n.useState(""),[g,j]=n.useState(""),[h,N]=n.useState(ke()),[k,I]=n.useState(""),[T,O]=n.useState(""),[A,M]=n.useState(""),[R,L]=n.useState(""),[D,w]=n.useState("low"),[C,q]=n.useState("");n.useEffect(()=>{t&&Or().then(o).catch(console.error)},[t]);const J=async v=>{v.preventDefault(),f(!0);try{let Q=d;l==="new"&&(Q=(await Mr({name:y,job_number:S,location:p,client:g,status:"active"})).id);const bt=await qr({project_id:Q,log_date:h,weather:k,temperature:T,wind:A,site_conditions:R,priority:D,notes:C,safety_incidents:"",critical_items:"",is_completed:!1});s(bt.id),ht()}catch(Q){console.error(Q),alert("Failed to create job")}f(!1)},ht=()=>{b(""),E(""),x(""),j(""),N(ke()),I(""),O(""),M(""),L(""),w("low"),q(""),c(""),i("new")};return t?e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm",onClick:r,children:e.jsxs("div",{className:"bg-card border border-border rounded-2xl w-full max-w-lg max-h-[90vh] overflow-y-auto shadow-2xl",onClick:v=>v.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-border",children:[e.jsx("h2",{className:"text-lg font-bold text-foreground",children:"New Job Entry"}),e.jsx("button",{onClick:r,className:"p-1 rounded-lg hover:bg-surface-3/60 text-muted-foreground hover:text-foreground",children:e.jsx(re,{className:"w-5 h-5"})})]}),e.jsxs("form",{onSubmit:J,className:"p-4 space-y-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"button",onClick:()=>i("new"),className:`flex-1 py-2 rounded-lg text-sm font-medium transition-colors ${l==="new"?"bg-primary text-primary-foreground":"bg-surface-2 text-foreground/80 hover:bg-surface-3/60"}`,children:"New Project"}),e.jsx("button",{type:"button",onClick:()=>i("existing"),className:`flex-1 py-2 rounded-lg text-sm font-medium transition-colors ${l==="existing"?"bg-primary text-primary-foreground":"bg-surface-2 text-foreground/80 hover:bg-surface-3/60"}`,children:"Existing Project"})]}),l==="existing"?e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-muted-foreground mb-1",children:"Select Project"}),e.jsxs("select",{value:d,onChange:v=>c(v.target.value),required:!0,className:"lld-input w-full px-3 py-2 rounded-lg text-sm",children:[e.jsx("option",{value:"",children:"Choose a project..."}),a.map(v=>e.jsxs("option",{value:v.id,children:[v.job_number?`[${v.job_number}] `:"",v.name]},v.id))]})]}):e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-muted-foreground mb-1",children:"Project Name *"}),e.jsx("input",{value:y,onChange:v=>b(v.target.value),required:!0,className:"lld-input w-full px-3 py-2 rounded-lg text-sm",placeholder:"e.g. Smith St Fitout"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-muted-foreground mb-1",children:"Job Number"}),e.jsx("input",{value:S,onChange:v=>E(v.target.value),className:"lld-input w-full px-3 py-2 rounded-lg text-sm",placeholder:"e.g. 1234"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-muted-foreground mb-1",children:"Location"}),e.jsx("input",{value:p,onChange:v=>x(v.target.value),className:"lld-input w-full px-3 py-2 rounded-lg text-sm",placeholder:"e.g. Auckland CBD"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-muted-foreground mb-1",children:"Client"}),e.jsx("input",{value:g,onChange:v=>j(v.target.value),className:"lld-input w-full px-3 py-2 rounded-lg text-sm",placeholder:"e.g. ABC Corp"})]})]})]}),e.jsx("hr",{className:"border-border"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-muted-foreground mb-1",children:"Date *"}),e.jsx("input",{type:"date",value:h,onChange:v=>N(v.target.value),required:!0,className:"lld-input w-full px-3 py-2 rounded-lg text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-muted-foreground mb-1",children:"Priority"}),e.jsxs("select",{value:D,onChange:v=>w(v.target.value),className:"lld-input w-full px-3 py-2 rounded-lg text-sm",children:[e.jsx("option",{value:"low",children:"Low"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"high",children:"High"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-muted-foreground mb-1",children:"Weather"}),e.jsxs("select",{value:k,onChange:v=>I(v.target.value),className:"lld-input w-full px-3 py-2 rounded-lg text-sm",children:[e.jsx("option",{value:"",children:"Select..."}),Ir.map(v=>e.jsx("option",{value:v,children:v},v))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-muted-foreground mb-1",children:"Temperature"}),e.jsx("input",{value:T,onChange:v=>O(v.target.value),className:"lld-input w-full px-3 py-2 rounded-lg text-sm",placeholder:"e.g. 18Â°C"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-muted-foreground mb-1",children:"Wind"}),e.jsx("input",{value:A,onChange:v=>M(v.target.value),className:"lld-input w-full px-3 py-2 rounded-lg text-sm",placeholder:"e.g. Light NW"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-muted-foreground mb-1",children:"Site Conditions"}),e.jsx("input",{value:R,onChange:v=>L(v.target.value),className:"lld-input w-full px-3 py-2 rounded-lg text-sm",placeholder:"e.g. Dry, good access"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-muted-foreground mb-1",children:"Notes"}),e.jsx("textarea",{value:C,onChange:v=>q(v.target.value),rows:2,className:"lld-input w-full px-3 py-2 rounded-lg text-sm resize-none",placeholder:"Any additional notes..."})]}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx("button",{type:"button",onClick:r,className:"flex-1 py-2.5 rounded-lg bg-surface-2 text-foreground/80 hover:bg-surface-3/60 text-sm font-medium transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:m,className:"flex-1 py-2.5 rounded-lg bg-primary hover:bg-primary/90 text-primary-foreground text-sm font-bold transition-colors disabled:opacity-50",children:m?"Creating...":"Create Job"})]})]})]})}):null},V="lld-input w-full pl-10 pr-4 py-3 rounded-xl text-sm transition-all",ce=({open:t,onClose:r})=>{var D;const{signIn:s,signUp:a}=fe(),[o,l]=n.useState("signin"),[i,d]=n.useState(""),[c,m]=n.useState(""),[f,y]=n.useState(""),[b,S]=n.useState(""),[E,p]=n.useState("foreman"),[x,g]=n.useState(!1),[j,h]=n.useState(!1),[N,k]=n.useState(null),[I,T]=n.useState(null),O=()=>{d(""),m(""),y(""),S(""),p("foreman"),k(null),T(null)};n.useEffect(()=>{t&&(l("signin"),O())},[t]);const A=w=>{l(w),O()},M=async w=>{if(w.preventDefault(),k(null),!i||!c){k("Please fill in all fields");return}h(!0);const{error:C}=await s(i,c);if(h(!1),C){k(C);return}r(),O()},R=async w=>{if(w.preventDefault(),k(null),!i||!c||!b){k("Please fill in all fields");return}if(c.length<6){k("Password must be at least 6 characters");return}if(c!==f){k("Passwords do not match");return}h(!0);const{error:C}=await a(i,c,b,E);if(h(!1),C){k(C);return}T("Account created! You can now sign in."),setTimeout(()=>{A("signin")},1500)};if(!t)return null;const L={site_manager:We,foreman:He,safety_officer:ie};return e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:r}),e.jsxs("div",{className:"relative w-full max-w-md bg-card border border-border/50 rounded-2xl shadow-2xl overflow-hidden",children:[e.jsxs("div",{className:"relative bg-surface-2/60 px-6 pt-6 pb-4",children:[e.jsx("button",{onClick:r,className:"absolute top-4 right-4 p-2 rounded-lg hover:bg-surface-2 text-muted-foreground hover:text-foreground transition-colors",children:e.jsx(re,{className:"w-5 h-5"})}),e.jsxs("div",{className:"flex items-center gap-5 mb-4",children:[e.jsx("img",{src:"/LongLineDiaryV2/icons/ll-developer-logo-v2.png",alt:"Long Line Diary",className:"w-16 h-16 object-contain flex-shrink-0"}),e.jsxs("div",{className:"ml-2",children:[e.jsx("h2",{className:"text-lg font-bold text-foreground leading-tight",children:st.appName}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Construction Management Platform"})]})]}),e.jsxs("div",{className:"flex bg-surface-2 rounded-xl p-1",children:[e.jsx("button",{onClick:()=>A("signin"),className:`flex-1 py-2 px-4 rounded-lg text-sm font-medium transition-all ${o==="signin"?"bg-primary text-primary-foreground shadow-lg shadow-primary/15":"text-muted-foreground hover:text-foreground"}`,children:"Sign In"}),e.jsx("button",{onClick:()=>A("signup"),className:`flex-1 py-2 px-4 rounded-lg text-sm font-medium transition-all ${o==="signup"?"bg-primary text-primary-foreground shadow-lg shadow-primary/15":"text-muted-foreground hover:text-foreground"}`,children:"Create Account"})]})]}),e.jsxs("div",{className:"px-6 pb-6 pt-2",children:[N&&e.jsxs("div",{className:"flex items-center gap-2 p-3 mb-4 rounded-xl bg-red-500/10 border border-red-500/20 text-red-400 text-sm",children:[e.jsx(ie,{className:"w-4 h-4 flex-shrink-0"}),e.jsx("span",{children:N})]}),I&&e.jsxs("div",{className:"flex items-center gap-2 p-3 mb-4 rounded-xl bg-green-500/10 border border-green-500/20 text-green-400 text-sm",children:[e.jsx(Ht,{className:"w-4 h-4 flex-shrink-0"}),e.jsx("span",{children:I})]}),o==="signin"?e.jsxs("form",{onSubmit:M,className:"space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(xe,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx("input",{type:"email",placeholder:"Email address",value:i,onChange:w=>d(w.target.value),className:V,autoComplete:"email"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(Y,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx("input",{type:x?"text":"password",placeholder:"Password",value:c,onChange:w=>m(w.target.value),className:`${V} pr-10`,autoComplete:"current-password"}),e.jsx("button",{type:"button",onClick:()=>g(!x),className:"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground transition-colors",children:x?e.jsx(he,{className:"w-4 h-4"}):e.jsx(be,{className:"w-4 h-4"})})]}),e.jsxs("button",{type:"submit",disabled:j,className:"w-full py-3 rounded-xl bg-primary text-primary-foreground font-semibold text-sm transition-all shadow-lg shadow-primary/15 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[j?e.jsx(ye,{className:"w-4 h-4 animate-spin"}):null,j?"Signing in...":"Sign In"]})]}):e.jsxs("form",{onSubmit:R,className:"space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(le,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx("input",{type:"text",placeholder:"Full name",value:b,onChange:w=>S(w.target.value),className:V,autoComplete:"name"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(xe,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx("input",{type:"email",placeholder:"Email address",value:i,onChange:w=>d(w.target.value),className:V,autoComplete:"email"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-muted-foreground mb-2",children:"Your Role"}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:W.map(w=>{const C=L[w.value],q=E===w.value;return e.jsxs("button",{type:"button",onClick:()=>p(w.value),className:`flex flex-col items-center gap-1.5 p-3 rounded-xl border transition-all text-center ${q?"bg-primary/10 border-primary/40 text-primary":"bg-surface-2/70 border-border/50 text-muted-foreground hover:border-border"}`,children:[e.jsx(C,{className:"w-5 h-5"}),e.jsx("span",{className:"text-xs font-medium leading-tight",children:w.label})]},w.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground/80 mt-1.5",children:(D=W.find(w=>w.value===E))==null?void 0:D.description})]}),e.jsxs("div",{className:"relative",children:[e.jsx(Y,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx("input",{type:x?"text":"password",placeholder:"Password (min 6 characters)",value:c,onChange:w=>m(w.target.value),className:`${V} pr-10`,autoComplete:"new-password"}),e.jsx("button",{type:"button",onClick:()=>g(!x),className:"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground transition-colors",children:x?e.jsx(he,{className:"w-4 h-4"}):e.jsx(be,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"relative",children:[e.jsx(Y,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx("input",{type:x?"text":"password",placeholder:"Confirm password",value:f,onChange:w=>y(w.target.value),className:V,autoComplete:"new-password"})]}),e.jsxs("button",{type:"submit",disabled:j,className:"w-full py-3 rounded-xl bg-primary text-primary-foreground font-semibold text-sm transition-all shadow-lg shadow-primary/15 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[j?e.jsx(ye,{className:"w-4 h-4 animate-spin"}):null,j?"Creating account...":"Create Account"]})]}),e.jsx("p",{className:"text-center text-xs text-muted-foreground/80 mt-4",children:o==="signin"?e.jsxs(e.Fragment,{children:["Don't have an account?"," ",e.jsx("button",{onClick:()=>A("signup"),className:"text-primary hover:text-primary/90 font-medium",children:"Create one"})]}):e.jsxs(e.Fragment,{children:["Already have an account?"," ",e.jsx("button",{onClick:()=>A("signin"),className:"text-primary hover:text-primary/90 font-medium",children:"Sign in"})]})})]})]})]})},Fe=n.lazy(()=>z(()=>import("./DashboardPage-C9e1CwR0.js"),__vite__mapDeps([0,1,2,3,4,5,6,7]))),Vr=n.lazy(()=>z(()=>import("./DailyLogsPage-FTwlxZw-.js"),__vite__mapDeps([8,1,2,3,4,5,6,7]))),zr=n.lazy(()=>z(()=>import("./CalendarPage-nGDJC_HM.js"),__vite__mapDeps([9,1,2,3,4,5,6,7]))),Ur=n.lazy(()=>z(()=>import("./TimesheetPage-C8jRUMOr.js"),__vite__mapDeps([10,1,3,4,5,6,7]))),Gr=n.lazy(()=>z(()=>import("./ReportsPage-Qf-Bzvu3.js"),__vite__mapDeps([11,1,2,3,4,5,6,7]))),Hr=n.lazy(()=>z(()=>import("./SettingsPage-BoHu2Wil.js"),__vite__mapDeps([12,1,3,4,5,6,7]))),Wr={site_manager:We,foreman:He,safety_officer:ie},Jr=()=>{var D,w;const{user:t,profile:r,loading:s,signOut:a}=fe(),[o,l]=n.useState("dashboard"),[i,d]=n.useState(!1),[c,m]=n.useState(!1),[f,y]=n.useState(!1),[b,S]=n.useState(!1),[E,p]=n.useState(!1),[x,g]=n.useState(null),[j,h]=n.useState(0),N=(r==null?void 0:r.role)||null;n.useEffect(()=>{if(!t){h(0);return}Br().then(C=>h(C.totalOverdue)).catch(()=>{})},[t==null?void 0:t.id,o]),n.useEffect(()=>{if(!E)return;const C=q=>p(!1);return document.addEventListener("click",C),()=>document.removeEventListener("click",C)},[E]);const k=n.useCallback((C,q)=>{const J=C;N&&!rt[N].includes(J)||(l(J),g(q||null),m(!1))},[N]),I=n.useCallback(C=>{y(!1),l("daily-logs"),g({logId:C})},[]),T=async()=>{await a(),p(!1),l("dashboard")},O=()=>{switch(o){case"dashboard":return e.jsx(Fe,{onNavigate:k,onQuickAdd:()=>y(!0)});case"daily-logs":return e.jsx(Vr,{initialData:x});case"calendar":return e.jsx(zr,{onNavigate:k,initialData:x});case"timesheets":return e.jsx(Ur,{});case"reports":return e.jsx(Gr,{onNavigate:k});case"settings":return e.jsx(Hr,{userRole:N});default:return e.jsx(Fe,{onNavigate:k,onQuickAdd:()=>y(!0)})}},A=(r==null?void 0:r.full_name)||((D=t==null?void 0:t.email)==null?void 0:D.split("@")[0])||"",M=(t==null?void 0:t.email)||"",R=N?Wr[N]:le,L=N&&((w=W.find(C=>C.value===N))==null?void 0:w.label)||"";return s?e.jsx("div",{className:"min-h-screen flex items-center justify-center text-foreground",children:"Loading..."}):t?e.jsxs("div",{className:"min-h-screen bg-background",children:[c&&e.jsx("div",{className:"fixed inset-0 z-30 bg-black/50 lg:hidden",onClick:()=>m(!1)}),e.jsx("div",{className:"hidden lg:block",children:e.jsx(_e,{currentPage:o,onNavigate:C=>{k(C)},collapsed:i,onToggle:()=>d(!i),onQuickAdd:()=>y(!0),stats:{overdue:j,highPriority:0},userRole:N})}),e.jsx("div",{className:`lg:hidden fixed inset-y-0 left-0 z-40 transition-transform duration-300 ${c?"translate-x-0":"-translate-x-full"}`,children:e.jsx(_e,{currentPage:o,onNavigate:C=>{k(C)},collapsed:i,onToggle:()=>d(!i),onQuickAdd:()=>{y(!0),m(!1)},stats:{overdue:j,highPriority:0},userRole:N})}),e.jsxs("main",{className:`transition-all duration-300 min-h-screen ${i?"ml-16":"ml-60"}`,children:[e.jsx("header",{className:"sticky top-0 z-20 bg-background/80 backdrop-blur-xl border-b border-border/50 px-4 lg:px-6 py-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ar,{}),e.jsx("button",{onClick:()=>m(!c),className:"lg:hidden p-2 rounded-lg hover:bg-card text-foreground",children:c?e.jsx(re,{className:"w-5 h-5"}):e.jsx(Wt,{className:"w-5 h-5"})}),e.jsx("h2",{className:"text-sm font-bold text-foreground dark:text-primary capitalize",children:o.replace("-"," ")})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-xs text-foreground hidden sm:inline",children:new Date().toLocaleDateString("en-NZ",{weekday:"long",day:"numeric",month:"long",year:"numeric"})}),s?e.jsx("div",{className:"w-8 h-8 rounded-full bg-card animate-pulse"}):t?e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:C=>{C.stopPropagation(),p(!E)},className:"flex items-center gap-2 pl-2 pr-3 py-1.5 rounded-xl bg-card/80 border border-border/50 hover:border-border transition-all",children:[e.jsx("div",{className:"w-7 h-7 rounded-lg bg-primary flex items-center justify-center",children:e.jsx("span",{className:"text-xs font-bold text-foreground",children:A.charAt(0).toUpperCase()||"U"})}),e.jsxs("div",{className:"hidden sm:block text-left",children:[e.jsx("p",{className:"text-xs font-medium text-foreground dark:text-primary leading-none",children:A}),e.jsx("p",{className:"text-[10px] text-foreground leading-none mt-0.5",children:L})]}),e.jsx(me,{className:"w-3 h-3 text-foreground"})]}),E&&e.jsxs("div",{className:"absolute right-0 top-full mt-2 w-64 bg-card border border-border/50 rounded-xl shadow-2xl overflow-hidden",onClick:C=>C.stopPropagation(),children:[e.jsxs("div",{className:"px-4 py-3 border-b border-border/50",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-primary flex items-center justify-center",children:e.jsx("span",{className:"text-sm font-bold text-foreground",children:A.charAt(0).toUpperCase()||"U"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-semibold text-foreground dark:text-primary truncate",children:A}),e.jsx("p",{className:"text-xs text-foreground truncate",children:M})]})]}),e.jsxs("div",{className:"flex items-center gap-1.5 mt-2 px-2 py-1 rounded-lg bg-card/50 w-fit",children:[e.jsx(R,{className:"w-3 h-3 text-primary"}),e.jsx("span",{className:"text-[10px] font-medium text-primary",children:L})]})]}),e.jsxs("div",{className:"p-1.5",children:[e.jsxs("button",{onClick:()=>{p(!1),k("settings")},className:"w-full flex items-center gap-3 px-3 py-2 rounded-lg text-sm text-foreground hover:bg-card/50 hover:text-foreground transition-colors",children:[e.jsx(le,{className:"w-4 h-4"}),e.jsx("span",{children:"Profile & Settings"})]}),e.jsxs("button",{onClick:T,className:"w-full flex items-center gap-3 px-3 py-2 rounded-lg text-sm text-red-400 hover:bg-red-500/10 transition-colors",children:[e.jsx(Jt,{className:"w-4 h-4"}),e.jsx("span",{children:"Sign Out"})]})]})]})]}):e.jsxs("button",{onClick:()=>S(!0),className:"flex items-center gap-2 px-4 py-2 rounded-xl bg-primary hover:bg-primary/90 text-foreground font-semibold text-xs transition-all shadow-lg shadow-primary/20",children:[e.jsx(Qt,{className:"w-3.5 h-3.5"}),e.jsx("span",{children:"Sign In"})]})]})]})}),e.jsx("div",{className:"p-4 lg:p-6",children:e.jsx(n.Suspense,{fallback:e.jsx("div",{className:"p-6 text-foreground text-sm",children:"Loading…"}),children:O()})})]}),e.jsx($r,{open:f,onClose:()=>y(!1),onCreated:I}),e.jsx(ce,{open:b,onClose:()=>S(!1)})]}):e.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center gap-6 bg-background",children:[e.jsx("div",{className:"text-2xl font-semibold",children:"Long Line Diary"}),e.jsx("button",{onClick:()=>S(!0),className:"px-6 py-3 rounded-lg bg-primary text-primary-foreground font-semibold",children:"Sign In"}),e.jsx(ce,{open:b,onClose:()=>S(!1)})]})},Qr=()=>{const t=tr();return n.useEffect(()=>{console.error("404 Error: User attempted to access non-existent route:",t.pathname)},[t.pathname]),e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background",children:e.jsxs("div",{className:"text-center p-8 rounded-lg border border-border bg-card shadow-md animate-slide-in",children:[e.jsx("h1",{className:"text-5xl font-bold mb-6 text-primary",children:"404"}),e.jsx("p",{className:"text-xl text-card-foreground mb-6",children:"Page not found"}),e.jsx("a",{href:"/",className:"text-primary hover:text-primary/80 underline transition-colors",children:"Return to Home"})]})})},at="/LongLineDiaryV2/assets/login-landing-DB_GgVW8.jpg";function Yr(){const[t,r]=n.useState(!1);return e.jsx("div",{className:"min-h-screen w-full bg-cover bg-center bg-no-repeat",style:{backgroundImage:"url("+at+")"},children:e.jsx("div",{className:"min-h-screen w-full flex items-center justify-center bg-black/20 p-6",children:e.jsxs("div",{className:"w-full max-w-md text-center",children:[e.jsx("img",{src:"/LongLineDiaryV2/icons/ll-developer-logo-v2.png",alt:"Long Line Diary",className:"mx-auto w-72 md:w-96 object-contain cursor-pointer opacity-40 hover:opacity-70 transition-opacity duration-500",onClick:()=>r(!0)}),e.jsx(ce,{open:t,onClose:()=>r(!1)})]})})})}const ot=n.forwardRef(({className:t,...r},s)=>e.jsx("div",{ref:s,className:F("rounded-lg border border-border/40 bg-background shadow-sm",t),...r}));ot.displayName="Card";const nt=n.forwardRef(({className:t,...r},s)=>e.jsx("div",{ref:s,className:F("flex flex-col space-y-1.5 p-6",t),...r}));nt.displayName="CardHeader";const it=n.forwardRef(({className:t,...r},s)=>e.jsx("h3",{ref:s,className:F("text-2xl font-semibold leading-none tracking-tight text-foreground",t),...r}));it.displayName="CardTitle";const lt=n.forwardRef(({className:t,...r},s)=>e.jsx("p",{ref:s,className:F("text-sm text-muted-foreground",t),...r}));lt.displayName="CardDescription";const ct=n.forwardRef(({className:t,...r},s)=>e.jsx("div",{ref:s,className:F("p-6 pt-0",t),...r}));ct.displayName="CardContent";const Xr=n.forwardRef(({className:t,...r},s)=>e.jsx("div",{ref:s,className:F("flex items-center p-6 pt-0",t),...r}));Xr.displayName="CardFooter";const de=n.forwardRef(({className:t,type:r,...s},a)=>e.jsx("input",{type:r,className:F("flex h-10 w-full rounded-md border border-border/60 bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:a,...s}));de.displayName="Input";const Zr=ue("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",{variants:{variant:{default:"text-foreground",muted:"text-muted-foreground",accent:"text-primary"},size:{default:"text-sm",xs:"text-xs",sm:"text-sm",lg:"text-base"}},defaultVariants:{variant:"default",size:"default"}}),ee=n.forwardRef(({className:t,variant:r,size:s,...a},o)=>e.jsx(Me,{ref:o,className:F(Zr({variant:r,size:s}),t),...a}));ee.displayName=Me.displayName;const Kr=ue("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),dt=n.forwardRef(({className:t,variant:r,size:s,asChild:a=!1,...o},l)=>{const i=a?kt:"button";return e.jsx(i,{className:F(Kr({variant:r,size:s,className:t})),ref:l,...o})});dt.displayName="Button";const es=At,ts=It,ut=n.forwardRef(({className:t,children:r,...s},a)=>e.jsxs(qe,{ref:a,className:F("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground/60 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-primary focus-visible:border-primary/50 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1 transition-colors",t),...s,children:[r,e.jsx(Ft,{asChild:!0,children:e.jsx(me,{className:"h-4 w-4 opacity-50 transition-transform duration-200 ease-in-out group-data-[state=open]:rotate-180"})})]}));ut.displayName=qe.displayName;const mt=n.forwardRef(({className:t,...r},s)=>e.jsx(Be,{ref:s,className:F("flex cursor-default items-center justify-center py-1 text-muted-foreground",t),...r,children:e.jsx(Yt,{className:"h-4 w-4"})}));mt.displayName=Be.displayName;const ft=n.forwardRef(({className:t,...r},s)=>e.jsx($e,{ref:s,className:F("flex cursor-default items-center justify-center py-1 text-muted-foreground",t),...r,children:e.jsx(me,{className:"h-4 w-4"})}));ft.displayName=$e.displayName;const gt=n.forwardRef(({className:t,children:r,position:s="popper",...a},o)=>e.jsx(Et,{children:e.jsxs(Ve,{ref:o,className:F("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border border-border/40 bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 duration-200",s==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:s,...a,children:[e.jsx(mt,{}),e.jsx(Pt,{className:F("p-1",s==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:r}),e.jsx(ft,{})]})}));gt.displayName=Ve.displayName;const rs=n.forwardRef(({className:t,...r},s)=>e.jsx(ze,{ref:s,className:F("py-1.5 pl-8 pr-2 text-sm font-medium text-muted-foreground",t),...r}));rs.displayName=ze.displayName;const pt=n.forwardRef(({className:t,children:r,...s},a)=>e.jsxs(Ue,{ref:a,className:F("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent/50 focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 transition-colors",t),...s,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(Tt,{children:e.jsx(Xt,{className:"h-4 w-4 text-primary"})})}),e.jsx(Dt,{children:r})]}));pt.displayName=Ue.displayName;const ss=n.forwardRef(({className:t,...r},s)=>e.jsx(Ge,{ref:s,className:F("-mx-1 my-1 h-px bg-muted",t),...r}));ss.displayName=Ge.displayName;function as(){const{user:t,loading:r,profile:s,updateProfile:a}=fe(),[o,l]=n.useState(!1),[i,d]=n.useState(null),[c,m]=n.useState(null),[f,y]=n.useState(null),[b,S]=n.useState(""),[E,p]=n.useState(""),[x,g]=n.useState(void 0),j=n.useMemo(()=>!!(s&&s.onboarded===!1),[s]);if(n.useEffect(()=>{j&&(S(h=>h||((s==null?void 0:s.company_name)??"")),p(h=>h||((s==null?void 0:s.site_name)??"")),g(h=>h||(s==null?void 0:s.role)))},[j,s==null?void 0:s.company_name,s==null?void 0:s.site_name,s==null?void 0:s.role]),r)return e.jsx("div",{className:"min-h-screen w-full flex items-center justify-center text-foreground",children:"Loading..."});if(!t)return e.jsx(Yr,{});if(j){const h=W.find(N=>N.value===x);return e.jsx("div",{className:"min-h-screen w-full bg-cover bg-center bg-no-repeat",style:{backgroundImage:"url("+at+")"},children:e.jsx("div",{className:"min-h-screen w-full flex items-center justify-center bg-black/40 p-6",children:e.jsxs(ot,{className:"w-full max-w-md shadow-2xl backdrop-blur-sm bg-background/95",children:[e.jsxs(nt,{children:[e.jsx(it,{children:"Welcome to Long Line Diary"}),e.jsx(lt,{children:"Set up your company profile to continue."})]}),e.jsxs(ct,{className:"space-y-5",children:[i&&e.jsx("div",{className:"text-sm text-red-600 bg-red-50 border border-red-200 rounded-lg p-3",children:i}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(ee,{children:"Company Name"}),e.jsx(de,{value:b,onChange:N=>{S(N.target.value),c&&m(null),i&&d(null)},placeholder:"Enter company name",autoFocus:!0}),c&&e.jsx("div",{className:"text-xs text-red-600",children:c})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(ee,{children:"Role"}),e.jsxs(es,{value:x,onValueChange:N=>{g(N),f&&y(null),i&&d(null)},children:[e.jsx(ut,{children:e.jsx(ts,{placeholder:"Select your role"})}),e.jsx(gt,{children:W.map(N=>e.jsx(pt,{value:N.value,children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("div",{className:"text-sm",children:N.label}),e.jsx("div",{className:"text-xs opacity-70",children:N.description})]})},N.value))})]}),h!=null&&h.description?e.jsx("div",{className:"text-xs opacity-70",children:h.description}):null,f&&e.jsx("div",{className:"text-xs text-red-600",children:f})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(ee,{children:"Primary Site (Optional)"}),e.jsx(de,{value:E,onChange:N=>{p(N.target.value),i&&d(null)},placeholder:"e.g. Bethlehem Medical Centre"})]}),e.jsx(dt,{className:"w-full mt-4",disabled:o,onClick:async()=>{const N=b.trim(),k=E.trim();let I=!0;if(N?m(null):(m("Company name is required."),I=!1),x?y(null):(y("Please select a role."),I=!1),!!I)try{l(!0),d(null);const T=await a({company_name:N,site_name:k||null,role:x,onboarded:!0});T!=null&&T.error&&d(T.error)}catch(T){d((T==null?void 0:T.message)||"Failed to complete onboarding.")}finally{l(!1)}},children:o?"Saving...":"Continue to Dashboard"})]})]})})})}return e.jsx(rr,{basename:"/LongLineDiaryV2/",future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:e.jsxs(sr,{children:[e.jsx(se,{path:"/",element:e.jsx(ar,{to:"/dashboard",replace:!0})}),e.jsx(se,{path:"/*",element:e.jsx(Jr,{})}),e.jsx(se,{path:"*",element:e.jsx(Qr,{})})]})})}const os=new Zt,ns=()=>e.jsx(pr,{defaultTheme:"light",children:e.jsx(Kt,{client:os,children:e.jsxs(br,{children:[e.jsx(gr,{}),e.jsx(hr,{}),e.jsx(wr,{children:e.jsx(Sr,{children:e.jsx(as,{})})})]})})}),xt="lld.themeId";function is(){try{return localStorage.getItem(xt)}catch{return null}}function ls(t){try{localStorage.setItem(xt,t)}catch{}}function cs(){return ge[0]}function ds(){const t=is(),r=t&&we(t)?we(t):cs();return Er(r),t||ls(r.id),r}ds();Ct(document.getElementById("root")).render(e.jsx(ns,{}));export{Bs as A,zs as B,Hs as C,Js as D,Qs as E,Ws as F,Ys as G,ys as H,ws as I,fe as J,Dr as K,Ce as L,st as M,vs as N,ge as O,Xs as P,bs as T,W as U,Ir as W,ks as a,Br as b,Zs as c,js as d,Cs as e,Or as f,Ns as g,Fs as h,_s as i,Ps as j,Ds as k,As as l,Ls as m,Rs as n,Ms as o,qs as p,$s as q,Vs as r,Us as s,ke as t,Es as u,Gs as v,Ss as w,Ts as x,Is as y,Os as z};
