const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/DashboardPage-DgesRlp2.js","assets/vendor-C-VYnThq.js","assets/PriorityBadge-CUSKiaeB.js","assets/icons-BqMI43qa.js","assets/radix-BjS9lnSI.js","assets/tanstack-BiweuTX4.js","assets/router-DAcHDSWI.js","assets/supabase-DOe0D9WC.js","assets/DailyLogsPage-Db4haiY4.js","assets/CalendarPage-CMsQs9a8.js","assets/TimesheetPage-BnP5sQZq.js","assets/ReportsPage-CtgfbqBS.js","assets/SettingsPage-CiRbiuw4.js"])))=>i.map(i=>d[i]);
import{r as l,y as Ke,z as Xe,j as e,B as Se,$ as et,C as ke,D as Fe,E as tt,F as st,G as at}from"./vendor-C-VYnThq.js";import{S as rt,V as Te,R as Pe,A as Ee,C as Ae,T as De,D as Ie,P as ot,a as Le,b as nt}from"./radix-BjS9lnSI.js";import{X as te,S as it,M as lt,L as ct,C as dt,a as ut,b as mt,c as gt,d as pt,P as ft,e as Z,f as ht,g as xt,H as oe,h as ne,i as bt,j as me,E as ge,k as pe,l as fe,U as ie,m as Oe,n as yt,o as vt,p as jt,q as wt}from"./icons-BqMI43qa.js";import{Q as Nt,a as Ct}from"./tanstack-BiweuTX4.js";import{u as _t,B as St,R as kt,a as Y,N as Ft}from"./router-DAcHDSWI.js";import{c as Tt}from"./supabase-DOe0D9WC.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const n of i.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&r(n)}).observe(document,{childList:!0,subtree:!0});function a(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(o){if(o.ep)return;o.ep=!0;const i=a(o);fetch(o.href,i)}})();const Pt="modulepreload",Et=function(t){return"/LongLineDiaryV2/"+t},he={},$=function(s,a,r){let o=Promise.resolve();if(a&&a.length>0){document.getElementsByTagName("link");const n=document.querySelector("meta[property=csp-nonce]"),d=(n==null?void 0:n.nonce)||(n==null?void 0:n.getAttribute("nonce"));o=Promise.allSettled(a.map(c=>{if(c=Et(c),c in he)return;he[c]=!0;const g=c.endsWith(".css"),f=g?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${f}`))return;const u=document.createElement("link");if(u.rel=g?"stylesheet":Pt,g||(u.as="script"),u.crossOrigin="",u.href=c,d&&u.setAttribute("nonce",d),document.head.appendChild(u),g)return new Promise((b,N)=>{u.addEventListener("load",b),u.addEventListener("error",()=>N(new Error(`Unable to preload CSS for ${c}`)))})}))}function i(n){const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=n,window.dispatchEvent(d),!d.defaultPrevented)throw n}return o.then(n=>{for(const d of n||[])d.status==="rejected"&&i(d.reason);return s().catch(i)})};function At(t={}){const{immediate:s=!1,onNeedRefresh:a,onOfflineReady:r,onRegistered:o,onRegisteredSW:i,onRegisterError:n}=t;let d,c;const g=async(u=!0)=>{await c};async function f(){if("serviceWorker"in navigator){if(d=await $(async()=>{const{Workbox:u}=await import("./vendor-C-VYnThq.js").then(b=>b.N);return{Workbox:u}},[]).then(({Workbox:u})=>new u("/LongLineDiaryV2/sw.js",{scope:"/LongLineDiaryV2/",type:"classic"})).catch(u=>{n==null||n(u)}),!d)return;d.addEventListener("activated",u=>{(u.isUpdate||u.isExternal)&&window.location.reload()}),d.addEventListener("installed",u=>{u.isUpdate||r==null||r()}),d.register({immediate:s}).then(u=>{i?i("/LongLineDiaryV2/sw.js",u):o==null||o(u)}).catch(u=>{n==null||n(u)})}}return c=f(),g}function ee(t){const s=t.replace("#","").trim(),a=s.length===3?s.split("").map(n=>n+n).join(""):s,r=parseInt(a.slice(0,2),16),o=parseInt(a.slice(2,4),16),i=parseInt(a.slice(4,6),16);return{r,g:o,b:i}}function Dt(t,s,a){const r=t/255,o=s/255,i=a/255,n=Math.max(r,o,i),d=Math.min(r,o,i);let c=0;const g=(n+d)/2,f=n-d;let u=0;if(f!==0){switch(u=f/(1-Math.abs(2*g-1)),n){case r:c=(o-i)/f%6;break;case o:c=(i-r)/f+2;break;case i:c=(r-o)/f+4;break}c*=60,c<0&&(c+=360)}const b=Math.round(c),N=Math.round(u*1e3)/10,C=Math.round(g*1e3)/10;return`${b} ${N}% ${C}%`}function j(t){const{r:s,g:a,b:r}=ee(t);return Dt(s,a,r)}function W(t){const{r:s,g:a,b:r}=ee(t),o=[s,a,r].map(i=>{const n=i/255;return n<=.04045?n/12.92:Math.pow((n+.055)/1.055,2.4)});return .2126*o[0]+.7152*o[1]+.0722*o[2]}function Q(t){return W(t)<.45}function Me(t){return Math.min(1,Math.max(0,t))}function k(t,s,a){const r=ee(t),o=ee(s),i=Me(a),n=Math.round(r.r+(o.r-r.r)*i),d=Math.round(r.g+(o.g-r.g)*i),c=Math.round(r.b+(o.b-r.b)*i);return`#${[n,d,c].map(g=>g.toString(16).padStart(2,"0")).join("")}`.toUpperCase()}function B(t){return Q(t)?"#F8FAFC":"#0B1220"}function V(t,s,a){const r=a.map(A=>A.toUpperCase()),o=r[0]??"#4C8CFF",i=r[1]??k(o,"#FFFFFF",.25),n=r.length>=5?r[4]:r[2]??"#0B1220",d=r.length>=4?r[3]:Q(n)?k(n,"#FFFFFF",.06):k(n,"#000000",.04),c=r.length>=3?r[2]:B(n);r.length>=6?r[5]:Q(n)?k(d,"#FFFFFF",.14):k(d,"#000000",.12);const g=r.length>=7?r[6]:"#EF4444",f=Q(n)?"dark":"light";function u(A,E,T){return k(A,E==="dark"?"#0B1220":"#F8FAFC",Me(T))}function b(A,E){let T=A;for(let y=0;y<6;y++){const v=W(T);if(E==="dark"?v>=.03&&v<=.1:v>=.86&&v<=.98)break;T=u(T,E,.16)}return T=u(T,E,.18),T}const N=b(n,f),C=b(d,f),h=f==="dark"?k(C,"#FFFFFF",.06):k(C,"#000000",.05),p=f==="dark"?k(h,"#FFFFFF",.1):k(h,"#000000",.1),w=B(N),_=B(h),D=_,F=B(o),S={"--background":j(N),"--foreground":j(w),"--card":j(h),"--card-foreground":j(_),"--popover":j(h),"--popover-foreground":j(D),"--primary":j(o),"--primary-foreground":j(F),"--secondary":j(i),"--secondary-foreground":j(B(i)),"--muted":j(f==="dark"?k(N,h,.55):k(N,h,.45)),"--muted-foreground":j(f==="dark"?k(w,"#94A3B8",.55):k(w,"#475569",.55)),"--accent":j(i),"--accent-foreground":j(B(i)),"--border":j(p),"--input":j(p),"--ring":j(o),"--success":j("#16A34A"),"--success-foreground":j("#FFFFFF"),"--warning":j("#F59E0B"),"--warning-foreground":j("#111827"),"--danger":j("#DC2626"),"--danger-foreground":j("#FFFFFF"),"--info":j("#2563EB"),"--info-foreground":j("#FFFFFF"),"--surface-2":j(f==="dark"?k(h,"#FFFFFF",.04):k(h,"#000000",.03)),"--surface-3":j(f==="dark"?k(h,"#FFFFFF",.08):k(h,"#000000",.06)),"--input-bg":j(f==="dark"?k(h,"#FFFFFF",.02):k(h,"#000000",.02)),"--input-border":j(p),"--destructive":j(g),"--destructive-foreground":j(B(g))},L=W(c),I=W(N),O=Math.abs(L-I),P=W(w),M=Math.abs(P-I);return O>M+.15&&(S["--foreground"]=j(c)),{id:t,name:s,mode:f,tokens:S}}function xe(t){return de.find(s=>s.id===t)}function It(t){const s=document.documentElement;s.classList.toggle("dark",t.mode==="dark");for(const[a,r]of Object.entries(t.tokens))s.style.setProperty(a,r)}const de=[V("ceilings-light","Ceilings Unlimited — Light",["#7CC242","#1F2937","#111827","#F3F4F6","#FAFAFA","#E5E7EB","#DC2626"]),V("ceilings-dark","Ceilings Unlimited — Dark",["#7CC242","#94A3B8","#F1F5F9","#1E293B","#0F172A","#334155","#EF4444"]),V("future-grid","Future Grid",["#3B82F6","#06B6D4","#E2E8F0","#111827","#0B1220","#1F2937","#F43F5E"]),V("ivory-corporate","Ivory Corporate",["#2563EB","#64748B","#111827","#FFFFFF","#F8FAFC","#E2E8F0","#DC2626"]),V("graphite-pro","Graphite Pro",["#D4AF37","#94A3B8","#F8FAFC","#1C1F26","#121417","#2A2F38","#EF4444"])],se="lld-theme";function be(t){return t==="ceilings-dark"||t==="graphite-pro"||t==="future-grid"}function Lt(t){return t&&["ceilings-light","ceilings-dark","future-grid","ivory-corporate","graphite-pro"].includes(t)?t:null}function ye(t){const s=document.documentElement,a=de.find(r=>r.id===t);if(a){s.dataset.theme=t,a.mode==="dark"?s.classList.add("dark"):s.classList.remove("dark");for(const[r,o]of Object.entries(a.tokens))s.style.setProperty(r,o)}}function Re(){const[t,s]=l.useState("ceilings-dark");l.useEffect(()=>{const n=Lt(localStorage.getItem(se))??"ceilings-dark";s(n),ye(n),localStorage.setItem(se,n)},[]);const a=i=>{s(i),localStorage.setItem(se,i),ye(i)},r=()=>{be(t)?a("ivory-corporate"):a("ceilings-dark")},o=l.useMemo(()=>be(t),[t]);return{theme:t,setTheme:a,toggle:r,isDark:o}}function q(...t){return Ke(Xe(t))}const Ot=Se("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),le=l.forwardRef(({className:t,variant:s,size:a,asChild:r=!1,...o},i)=>{const n=r?rt:"button";return e.jsx(n,{className:q(Ot({variant:s,size:a,className:t})),ref:i,...o})});le.displayName="Button";function Mt(){const{theme:t,setTheme:s}=Re();return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx("h1",{className:"text-2xl font-semibold",children:"Settings"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"text-muted-foreground text-sm",children:"Theme Mode"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(le,{variant:t==="light"?"default":"outline",onClick:()=>s("light"),children:"Light"}),e.jsx(le,{variant:t==="dark"?"default":"outline",onClick:()=>s("dark"),children:"Dark"})]})]})]})}const Rt=1,qt=1e6;let ae=0;function Ut(){return ae=(ae+1)%Number.MAX_SAFE_INTEGER,ae.toString()}const re=new Map,ve=t=>{if(re.has(t))return;const s=setTimeout(()=>{re.delete(t),G({type:"REMOVE_TOAST",toastId:t})},qt);re.set(t,s)},Bt=(t,s)=>{switch(s.type){case"ADD_TOAST":return{...t,toasts:[s.toast,...t.toasts].slice(0,Rt)};case"UPDATE_TOAST":return{...t,toasts:t.toasts.map(a=>a.id===s.toast.id?{...a,...s.toast}:a)};case"DISMISS_TOAST":{const{toastId:a}=s;return a?ve(a):t.toasts.forEach(r=>{ve(r.id)}),{...t,toasts:t.toasts.map(r=>r.id===a||a===void 0?{...r,open:!1}:r)}}case"REMOVE_TOAST":return s.toastId===void 0?{...t,toasts:[]}:{...t,toasts:t.toasts.filter(a=>a.id!==s.toastId)}}},K=[];let X={toasts:[]};function G(t){X=Bt(X,t),K.forEach(s=>{s(X)})}function $t({...t}){const s=Ut(),a=o=>G({type:"UPDATE_TOAST",toast:{...o,id:s}}),r=()=>G({type:"DISMISS_TOAST",toastId:s});return G({type:"ADD_TOAST",toast:{...t,id:s,open:!0,onOpenChange:o=>{o||r()}}}),{id:s,dismiss:r,update:a}}function zt(){const[t,s]=l.useState(X);return l.useEffect(()=>(K.push(s),()=>{const a=K.indexOf(s);a>-1&&K.splice(a,1)}),[t]),{...t,toast:$t,dismiss:a=>G({type:"DISMISS_TOAST",toastId:a})}}const Vt=ot,qe=l.forwardRef(({className:t,...s},a)=>e.jsx(Te,{ref:a,className:q("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",t),...s}));qe.displayName=Te.displayName;const Wt=Se("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),Ue=l.forwardRef(({className:t,variant:s,...a},r)=>e.jsx(Pe,{ref:r,className:q(Wt({variant:s}),t),...a}));Ue.displayName=Pe.displayName;const Gt=l.forwardRef(({className:t,...s},a)=>e.jsx(Ee,{ref:a,className:q("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",t),...s}));Gt.displayName=Ee.displayName;const Be=l.forwardRef(({className:t,...s},a)=>e.jsx(Ae,{ref:a,className:q("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",t),"toast-close":"",...s,children:e.jsx(te,{className:"h-4 w-4"})}));Be.displayName=Ae.displayName;const $e=l.forwardRef(({className:t,...s},a)=>e.jsx(De,{ref:a,className:q("text-sm font-semibold",t),...s}));$e.displayName=De.displayName;const ze=l.forwardRef(({className:t,...s},a)=>e.jsx(Ie,{ref:a,className:q("text-sm opacity-90",t),...s}));ze.displayName=Ie.displayName;function Ht(){const{toasts:t}=zt();return e.jsxs(Vt,{children:[t.map(function({id:s,title:a,description:r,action:o,...i}){return e.jsxs(Ue,{...i,children:[e.jsxs("div",{className:"grid gap-1",children:[a&&e.jsx($e,{children:a}),r&&e.jsx(ze,{children:r})]}),o,e.jsx(Be,{})]},s)}),e.jsx(qe,{})]})}const Ve=l.createContext(null);function Jt({children:t,defaultTheme:s="system",value:a,...r}){const[o,i]=l.useState(()=>{if(typeof window<"u"){const d=localStorage.getItem("theme");return d&&(d==="dark"||d==="light"||d==="system")?d:s}return s});l.useEffect(()=>{const d=window.document.documentElement;if(d.classList.remove("light","dark"),o==="system"){const c=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";d.classList.add(c);return}d.classList.add(o)},[o]);const n={theme:o,setTheme:d=>{localStorage.setItem("theme",d),i(d)}};return e.jsx(Ve.Provider,{value:n,...r,children:t})}const Yt=()=>{const t=l.useContext(Ve);if(!t)throw new Error("useTheme must be used within a ThemeProvider");return t},Zt=({...t})=>{const{theme:s}=Yt();return e.jsx(et,{theme:s,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...t})},Qt=nt,Kt=l.forwardRef(({className:t,sideOffset:s=4,...a},r)=>e.jsx(Le,{ref:r,sideOffset:s,className:q("z-50 overflow-hidden rounded-md border border-border/40 bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-lg animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...a}));Kt.displayName=Le.displayName;const Xt="https://ubksjxlfjdeqzpfgiogb.databasepad.com",es="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6IjAzZjAwZDdjLTkwMGQtNGUxOC1hN2QwLWJiZDNhZjdmYjViMCJ9.eyJwcm9qZWN0SWQiOiJ1YmtzanhsZmpkZXF6cGZnaW9nYiIsInJvbGUiOiJhbm9uIiwiaWF0IjoxNzcxMzk5ODU1LCJleHAiOjIwODY3NTk4NTUsImlzcyI6ImZhbW91cy5kYXRhYmFzZXBhZCIsImF1ZCI6ImZhbW91cy5jbGllbnRzIn0.lQ5leJRhas9OqWFb5HKBX8reGnGyN2FC8aKAooMBMe4",m=Tt(Xt,es),We=l.createContext({user:null,session:null,profile:null,loading:!0,signUp:async()=>({error:null}),signIn:async()=>({error:null}),signOut:async()=>{},updateProfile:async()=>({error:null})}),Ge=()=>l.useContext(We),ts=({children:t})=>{const[s,a]=l.useState(null),[r,o]=l.useState(null),[i,n]=l.useState(null),[d,c]=l.useState(!0),g=l.useCallback(async C=>{try{const{data:h,error:p}=await m.from("profiles").select("*").eq("user_id",C).single();return p?(console.error("Profile fetch error:",p),null):h}catch(h){return console.error("Profile fetch exception:",h),null}},[]);l.useEffect(()=>{(async()=>{try{const{data:{session:p}}=await m.auth.getSession();if(o(p),a((p==null?void 0:p.user)??null),p!=null&&p.user){const w=await g(p.user.id);n(w)}}catch(p){console.error("Auth init error:",p)}c(!1)})();const{data:{subscription:h}}=m.auth.onAuthStateChange(async(p,w)=>{if(o(w),a((w==null?void 0:w.user)??null),w!=null&&w.user)if(p==="SIGNED_IN")setTimeout(async()=>{const _=await g(w.user.id);n(_)},500);else{const _=await g(w.user.id);n(_)}else n(null)});return()=>{h.unsubscribe()}},[g]);const f=async(C,h,p,w)=>{try{const{error:_}=await m.auth.signUp({email:C,password:h,options:{data:{full_name:p,role:w}}});return _?{error:_.message}:{error:null}}catch(_){return{error:_.message||"Sign up failed"}}},u=async(C,h)=>{try{const{error:p}=await m.auth.signInWithPassword({email:C,password:h});return p?{error:p.message}:{error:null}}catch(p){return{error:p.message||"Sign in failed"}}},b=async()=>{await m.auth.signOut(),a(null),o(null),n(null)},N=async C=>{if(!s)return{error:"Not authenticated"};try{const{error:h}=await m.from("profiles").update({...C,updated_at:new Date().toISOString()}).eq("user_id",s.id);if(h)return{error:h.message};const p=await g(s.id);return n(p),{error:null}}catch(h){return{error:h.message||"Update failed"}}};return e.jsx(We.Provider,{value:{user:s,session:r,profile:i,loading:d,signUp:f,signIn:u,signOut:b,updateProfile:N},children:t})},ss={sidebarOpen:!1,toggleSidebar:()=>{}},as=l.createContext(ss),rs=({children:t})=>{const[s,a]=l.useState(!1),r=()=>{a(o=>!o)};return e.jsx(as.Provider,{value:{sidebarOpen:s,toggleSidebar:r},children:t})};function os(){const{isDark:t,toggle:s}=Re();return e.jsx("button",{type:"button",onClick:s,className:"p-2 rounded-lg border border-border hover:bg-card transition-colors","aria-label":"Toggle theme",title:"Toggle theme",children:t?e.jsx(it,{className:"w-4 h-4 text-foreground"}):e.jsx(lt,{className:"w-4 h-4 text-foreground"})})}const je={weekEndingDay:"Sunday",timesheetPeriod:1,companyName:"",companyLogo:"",lunchDefaultMinutes:30,roundingMinutes:15,features:{analytics:!0,weatherAlerts:!0,teamCollaboration:!0,approvalWorkflow:!1,customReports:!0,autoCarryForward:!0,aiSummary:!0,notifications:!0}},Os=["Suspended Ceilings / 2-way","Rondo Ceilings","Partition Walls","Aluminium","Plasterboard / Linings","Stopping","Insulation","Carpentry","Fire Rating","Timber Partitions","Electrical","Plumbing","HVAC","Painting","Concrete","Roofing","Landscaping","General Labour","Other"],Ms=[{code:"101",label:"Suspended Ceilings / 2-way"},{code:"102",label:"Rondo Ceilings"},{code:"103",label:"Partition Walls"},{code:"104",label:"Aluminium"},{code:"105",label:"Plasterboard / Linings"},{code:"106",label:"Stopping"},{code:"107",label:"Insulation"},{code:"108",label:"Carpentry"},{code:"109",label:"Other"},{code:"110",label:"Carpet"},{code:"111",label:"FIRE RATING"},{code:"115",label:"Timber Partitions"},{code:"ACCOM",label:"Accommodation Allowance"},{code:"Other",label:"Other (please specify)"},{code:"P&G",label:"Preliminary and General"},{code:"P&Gs",label:"P&G Supervision"},{code:"P&Gt",label:"P&G Travel"},{code:"R/M",label:"Repairs and Maintenance"},{code:"Safety",label:"Safety Equipment"},{code:"Staff",label:"Staff Purchases on Company account"},{code:"Tools",label:"Tools"},{code:"training",label:"Staff Training"}],ns=["Clear","Partly Cloudy","Overcast","Light Rain","Heavy Rain","Wind","Storm","Snow","Fog","Hot","Cold"],Rs=[{value:"note",label:"General Note",color:"bg-primary"},{value:"reminder",label:"Reminder",color:"bg-purple-500"},{value:"meeting",label:"Meeting",color:"bg-indigo-500"},{value:"deadline",label:"Deadline",color:"bg-red-500"},{value:"inspection",label:"Inspection",color:"bg-primary"},{value:"delivery",label:"Delivery",color:"bg-green-500"}],ce=[{value:"site_manager",label:"Site Manager",description:"Full access to all features including settings, reports, and team management"},{value:"foreman",label:"Foreman",description:"Access to daily logs, timesheets, calendar, and basic reports"},{value:"safety_officer",label:"Safety Officer",description:"Access to daily logs, safety reports, and inspections"}],He={site_manager:["dashboard","daily-logs","calendar","timesheets","reports","settings"],foreman:["dashboard","daily-logs","calendar","timesheets","reports"],safety_officer:["dashboard","daily-logs","calendar","reports"]},is="Long Line Diary",Je={appName:is},we=[{key:"dashboard",label:"Dashboard",icon:ct},{key:"daily-logs",label:"Daily Logs",icon:dt},{key:"calendar",label:"Calendar",icon:ut},{key:"timesheets",label:"Timesheets",icon:mt},{key:"reports",label:"Reports",icon:gt},{key:"settings",label:"Settings",icon:pt}],Ne=({currentPage:t,onNavigate:s,collapsed:a,onToggle:r,onQuickAdd:o,stats:i,userRole:n})=>{const d=n?He[n]:we.map(c=>c.key);return e.jsxs("aside",{className:`fixed left-0 top-0 h-full z-40 flex flex-col bg-card border-r border-border transition-all duration-300 ${a?"w-16":"w-60"}`,children:[e.jsxs("div",{className:"flex items-center gap-3 px-4 h-16 border-b border-border",children:[e.jsx("img",{src:"/LongLineDiaryV2/icons/ll-developer-logo.png",alt:"Long Line Developer",className:"w-16 h-16 object-contain flex-shrink-0"}),!a&&e.jsxs("div",{className:"overflow-hidden",children:[e.jsx("h1",{className:"text-base font-bold text-foreground tracking-tight leading-none",children:Je.appName}),e.jsx("p",{className:"text-[10px] text-muted-foreground mt-0.5",children:"Construction Diary"})]})]}),o&&e.jsx("div",{className:"px-3 mt-4",children:e.jsxs("button",{onClick:o,className:`w-full flex items-center gap-2 px-3 py-2 rounded-lg bg-primary hover:opacity-90 text-primary-foreground font-semibold text-sm transition ${a?"justify-center":""}`,children:[e.jsx(ft,{className:"w-4 h-4"}),!a&&e.jsx("span",{children:"New Job"})]})}),e.jsx("nav",{className:"flex-1 mt-4 px-2 space-y-1",children:we.map(({key:c,label:g,icon:f})=>{const u=t===c,b=c==="dashboard"&&i&&i.overdue>0,N=!d.includes(c);return e.jsxs("button",{onClick:()=>!N&&s(c),disabled:N,title:N?`${g} requires a higher role`:g,className:`w-full flex items-center gap-3 px-3 py-2.5 rounded-lg text-sm font-medium transition-all relative border ${N?"text-muted-foreground/50 cursor-not-allowed border-transparent opacity-60":u?"bg-primary/10 text-primary border-primary/20":"text-muted-foreground hover:text-foreground hover:bg-muted border-transparent"} ${a?"justify-center":""}`,children:[e.jsx(f,{className:"w-5 h-5 flex-shrink-0"}),!a&&e.jsx("span",{children:g}),N&&!a&&e.jsx(Z,{className:"w-3 h-3 ml-auto text-muted-foreground/60"}),b&&!N&&e.jsx("span",{className:`${a?"absolute -top-1 -right-1":"ml-auto"} bg-destructive text-destructive-foreground text-[10px] font-bold rounded-full min-w-[18px] h-[18px] flex items-center justify-center px-1`,children:i.overdue})]},c)})}),e.jsx("div",{className:"px-3 pb-4",children:e.jsx("button",{onClick:r,className:"w-full flex items-center justify-center gap-2 px-3 py-2 rounded-lg text-muted-foreground hover:text-foreground hover:bg-muted transition text-sm",children:a?e.jsx(ht,{className:"w-4 h-4"}):e.jsxs(e.Fragment,{children:[e.jsx(xt,{className:"w-4 h-4"}),e.jsx("span",{children:"Collapse"})]})})})]})};function qs(t){if(!t)return"low";const s=new Date;s.setHours(0,0,0,0);const a=Fe(t),r=tt(a,s);return r<=3?"high":r<=7?"medium":"low"}function Us(t){switch(t){case"high":return"bg-red-500/10 border-red-500/30 text-red-400";case"medium":return"bg-primary/10 border-primary/30 text-primary";case"low":return"bg-emerald-500/10 border-emerald-500/30 text-emerald-400"}}function Bs(t){switch(t){case"high":return"bg-red-500";case"medium":return"bg-primary";case"low":return"bg-emerald-500"}}function $s(t){if(!t)return"";try{return ke(Fe(t),"dd MMM yyyy")}catch{return t}}function Ce(){return ke(new Date,"yyyy-MM-dd")}function zs(t,s,a=0){if(!/^\d{2}:\d{2}$/.test(t)||!/^\d{2}:\d{2}$/.test(s))return 0;const[r,o]=t.split(":").map(Number),[i,n]=s.split(":").map(Number),d=r*60+o;let c=i*60+n;c<d&&(c+=24*60);const g=Math.max(0,c-d-a);return Math.round(g/15)*15/60}function ls(t,s){const a=new Date(t,s,1),r=new Date(t,s+1,0);return st({start:a,end:r})}function Vs(t,s){const a=ls(t,s),r=a[0].getDay(),o=[];let i=[];for(let n=0;n<r;n++)i.push(null);for(const n of a)i.push(n),i.length===7&&(o.push(i),i=[]);if(i.length>0){for(;i.length<7;)i.push(null);o.push(i)}return o}async function ue(){const{data:{user:t}}=await m.auth.getUser();return(t==null?void 0:t.id)??null}async function U(t){const s=await ue();return s?{...t,user_id:s}:t}async function cs(){const{data:t,error:s}=await m.from("projects").select("*").order("created_at",{ascending:!1});if(s)throw s;return t||[]}async function ds(t){const s=await U(t),{data:a,error:r}=await m.from("projects").insert(s).select().single();if(r)throw r;return a}async function Ws(t){let s=m.from("daily_logs").select("*, projects(*)").order("log_date",{ascending:!1});t!=null&&t.date&&(s=s.eq("log_date",t.date)),t!=null&&t.project_id&&(s=s.eq("project_id",t.project_id));const{data:a,error:r}=await s;if(r)throw r;return(a||[]).map(o=>({...o,project:o.projects}))}async function Gs(t){const[s,a,r,o,i,n]=await Promise.all([m.from("daily_logs").select("*, projects(*)").eq("id",t).single(),m.from("crew_attendance").select("*").eq("daily_log_id",t).order("created_at"),m.from("work_activities").select("*").eq("daily_log_id",t).order("created_at"),m.from("materials").select("*").eq("daily_log_id",t).order("created_at"),m.from("equipment_logs").select("*").eq("daily_log_id",t).order("created_at"),m.from("visitors").select("*").eq("daily_log_id",t).order("created_at")]);if(s.error)throw s.error;const d=s.data;return{...d,project:d.projects,crew:a.data||[],activities:r.data||[],materials:o.data||[],equipment:i.data||[],visitors:n.data||[]}}async function us(t){const{project:s,crew:a,activities:r,materials:o,equipment:i,visitors:n,...d}=t,c=await U(d),{data:g,error:f}=await m.from("daily_logs").insert(c).select("*, projects(*)").single();if(f)throw f;return{...g,project:g.projects}}async function Hs(t,s){const{project:a,crew:r,activities:o,materials:i,equipment:n,visitors:d,...c}=s,{data:g,error:f}=await m.from("daily_logs").update(c).eq("id",t).select("*, projects(*)").single();if(f)throw f;return{...g,project:g.projects}}async function Js(t){const{error:s}=await m.from("daily_logs").delete().eq("id",t);if(s)throw s}async function Ys(t){const s=await U(t),{data:a,error:r}=await m.from("crew_attendance").insert(s).select().single();if(r)throw r;return a}async function Zs(t,s){const{data:a,error:r}=await m.from("crew_attendance").update(s).eq("id",t).select().single();if(r)throw r;return a}async function Qs(t){const{error:s}=await m.from("crew_attendance").delete().eq("id",t);if(s)throw s}async function Ks(t){const s=await U(t),{data:a,error:r}=await m.from("work_activities").insert(s).select().single();if(r)throw r;return a}async function Xs(t,s){const{data:a,error:r}=await m.from("work_activities").update(s).eq("id",t).select().single();if(r)throw r;return a}async function ea(t){const{error:s}=await m.from("work_activities").delete().eq("id",t);if(s)throw s}async function ta(t){const s=await U(t),{data:a,error:r}=await m.from("materials").insert(s).select().single();if(r)throw r;return a}async function sa(t,s){const{data:a,error:r}=await m.from("materials").update(s).eq("id",t).select().single();if(r)throw r;return a}async function aa(t){const{error:s}=await m.from("materials").delete().eq("id",t);if(s)throw s}async function ra(t){const s=await U(t),{data:a,error:r}=await m.from("equipment_logs").insert(s).select().single();if(r)throw r;return a}async function oa(t,s){const{data:a,error:r}=await m.from("equipment_logs").update(s).eq("id",t).select().single();if(r)throw r;return a}async function na(t){const{error:s}=await m.from("equipment_logs").delete().eq("id",t);if(s)throw s}async function ia(t){const s=await U(t),{data:a,error:r}=await m.from("visitors").insert(s).select().single();if(r)throw r;return a}async function la(t,s){const{data:a,error:r}=await m.from("visitors").update(s).eq("id",t).select().single();if(r)throw r;return a}async function ca(t){const{error:s}=await m.from("visitors").delete().eq("id",t);if(s)throw s}async function da(t,s){let a=m.from("calendar_notes").select("*").order("note_date");if(t!==void 0&&s!==void 0){const i=`${s}-${String(t+1).padStart(2,"0")}-01`,n=t===11?0:t+1,c=`${t===11?s+1:s}-${String(n+1).padStart(2,"0")}-01`;a=a.gte("note_date",i).lt("note_date",c)}const{data:r,error:o}=await a;if(o)throw o;return r||[]}async function ua(t){const s=await U(t),{data:a,error:r}=await m.from("calendar_notes").insert(s).select().single();if(r)throw r;return a}async function ma(t,s){const{data:a,error:r}=await m.from("calendar_notes").update(s).eq("id",t).select().single();if(r)throw r;return a}async function ga(t){const{error:s}=await m.from("calendar_notes").delete().eq("id",t);if(s)throw s}async function pa(){const t=await ue();let s=m.from("app_settings").select("*").eq("setting_key","main");t&&(s=s.eq("user_id",t));const{data:a}=await s;return a&&a.length>0&&a[0].setting_value?{...je,...a[0].setting_value}:je}async function fa(t){const s=await ue(),a={setting_key:"main",setting_value:t,updated_at:new Date().toISOString()};s&&(a.user_id=s);const{error:r}=await m.from("app_settings").upsert(a,{onConflict:"setting_key"});if(r)throw r}async function ha(){const[t,s,a,r]=await Promise.all([m.from("work_activities").select("*, daily_logs(*, projects(*))").eq("is_completed",!1).order("due_date"),m.from("materials").select("*, daily_logs(*, projects(*))").eq("is_completed",!1).order("required_date"),m.from("equipment_logs").select("*, daily_logs(*, projects(*))").eq("is_completed",!1).order("due_date"),m.from("crew_attendance").select("*, daily_logs(*, projects(*))").eq("is_completed",!1).order("due_date")]);return{activities:t.data||[],materials:s.data||[],equipment:a.data||[],crew:r.data||[]}}async function ms(){const[t,s,a,r]=await Promise.all([m.from("projects").select("id, status").eq("status","active"),m.from("daily_logs").select("id, priority, safety_incidents, is_completed"),m.from("work_activities").select("id, is_completed, due_date"),m.from("materials").select("id, is_completed, required_date, status")]),o=(t.data||[]).length,i=(s.data||[]).length,n=(s.data||[]).filter(b=>b.priority==="high").length,d=(s.data||[]).filter(b=>b.safety_incidents&&b.safety_incidents.trim()).length,c=new Date().toISOString().split("T")[0],g=(a.data||[]).filter(b=>!b.is_completed&&b.due_date&&b.due_date<c).length,f=(r.data||[]).filter(b=>!b.is_completed&&b.required_date&&b.required_date<c).length,u=(r.data||[]).filter(b=>b.status==="pending").length;return{activeProjects:o,totalLogs:i,highPriorityLogs:n,safetyIncidents:d,overdueActivities:g,overdueMaterials:f,pendingMaterials:u,totalOverdue:g+f}}const gs=({open:t,onClose:s,onCreated:a})=>{const[r,o]=l.useState([]),[i,n]=l.useState("new"),[d,c]=l.useState(""),[g,f]=l.useState(!1),[u,b]=l.useState(""),[N,C]=l.useState(""),[h,p]=l.useState(""),[w,_]=l.useState(""),[D,F]=l.useState(Ce()),[S,L]=l.useState(""),[I,O]=l.useState(""),[P,M]=l.useState(""),[A,E]=l.useState(""),[T,y]=l.useState("low"),[v,R]=l.useState("");l.useEffect(()=>{t&&cs().then(o).catch(console.error)},[t]);const H=async x=>{x.preventDefault(),f(!0);try{let J=d;i==="new"&&(J=(await ds({name:u,job_number:N,location:h,client:w,status:"active"})).id);const Qe=await us({project_id:J,log_date:D,weather:S,temperature:I,wind:P,site_conditions:A,priority:T,notes:v,safety_incidents:"",critical_items:"",is_completed:!1});a(Qe.id),Ze()}catch(J){console.error(J),alert("Failed to create job")}f(!1)},Ze=()=>{b(""),C(""),p(""),_(""),F(Ce()),L(""),O(""),M(""),E(""),y("low"),R(""),c(""),n("new")};return t?e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm",onClick:s,children:e.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-2xl w-full max-w-lg max-h-[90vh] overflow-y-auto shadow-2xl",onClick:x=>x.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-slate-700",children:[e.jsx("h2",{className:"text-lg font-bold text-white",children:"New Job Entry"}),e.jsx("button",{onClick:s,className:"p-1 rounded-lg hover:bg-slate-700 text-slate-400 hover:text-white",children:e.jsx(te,{className:"w-5 h-5"})})]}),e.jsxs("form",{onSubmit:H,className:"p-4 space-y-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"button",onClick:()=>n("new"),className:`flex-1 py-2 rounded-lg text-sm font-medium transition-colors ${i==="new"?"bg-amber-500 text-slate-900":"bg-slate-700 text-slate-300 hover:bg-slate-600"}`,children:"New Project"}),e.jsx("button",{type:"button",onClick:()=>n("existing"),className:`flex-1 py-2 rounded-lg text-sm font-medium transition-colors ${i==="existing"?"bg-amber-500 text-slate-900":"bg-slate-700 text-slate-300 hover:bg-slate-600"}`,children:"Existing Project"})]}),i==="existing"?e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-400 mb-1",children:"Select Project"}),e.jsxs("select",{value:d,onChange:x=>c(x.target.value),required:!0,className:"lld-input w-full px-3 py-2 rounded-lg text-sm",children:[e.jsx("option",{value:"",children:"Choose a project..."}),r.map(x=>e.jsxs("option",{value:x.id,children:[x.job_number?`[${x.job_number}] `:"",x.name]},x.id))]})]}):e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-400 mb-1",children:"Project Name *"}),e.jsx("input",{value:u,onChange:x=>b(x.target.value),required:!0,className:"lld-input w-full px-3 py-2 rounded-lg text-sm",placeholder:"e.g. Smith St Fitout"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-400 mb-1",children:"Job Number"}),e.jsx("input",{value:N,onChange:x=>C(x.target.value),className:"lld-input w-full px-3 py-2 rounded-lg text-sm",placeholder:"e.g. 1234"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-400 mb-1",children:"Location"}),e.jsx("input",{value:h,onChange:x=>p(x.target.value),className:"lld-input w-full px-3 py-2 rounded-lg text-sm",placeholder:"e.g. Auckland CBD"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-400 mb-1",children:"Client"}),e.jsx("input",{value:w,onChange:x=>_(x.target.value),className:"lld-input w-full px-3 py-2 rounded-lg text-sm",placeholder:"e.g. ABC Corp"})]})]})]}),e.jsx("hr",{className:"border-slate-700"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-400 mb-1",children:"Date *"}),e.jsx("input",{type:"date",value:D,onChange:x=>F(x.target.value),required:!0,className:"lld-input w-full px-3 py-2 rounded-lg text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-400 mb-1",children:"Priority"}),e.jsxs("select",{value:T,onChange:x=>y(x.target.value),className:"lld-input w-full px-3 py-2 rounded-lg text-sm",children:[e.jsx("option",{value:"low",children:"Low"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"high",children:"High"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-400 mb-1",children:"Weather"}),e.jsxs("select",{value:S,onChange:x=>L(x.target.value),className:"lld-input w-full px-3 py-2 rounded-lg text-sm",children:[e.jsx("option",{value:"",children:"Select..."}),ns.map(x=>e.jsx("option",{value:x,children:x},x))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-400 mb-1",children:"Temperature"}),e.jsx("input",{value:I,onChange:x=>O(x.target.value),className:"lld-input w-full px-3 py-2 rounded-lg text-sm",placeholder:"e.g. 18Â°C"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-400 mb-1",children:"Wind"}),e.jsx("input",{value:P,onChange:x=>M(x.target.value),className:"lld-input w-full px-3 py-2 rounded-lg text-sm",placeholder:"e.g. Light NW"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-400 mb-1",children:"Site Conditions"}),e.jsx("input",{value:A,onChange:x=>E(x.target.value),className:"lld-input w-full px-3 py-2 rounded-lg text-sm",placeholder:"e.g. Dry, good access"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-400 mb-1",children:"Notes"}),e.jsx("textarea",{value:v,onChange:x=>R(x.target.value),rows:2,className:"lld-input w-full px-3 py-2 rounded-lg text-sm resize-none",placeholder:"Any additional notes..."})]}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx("button",{type:"button",onClick:s,className:"flex-1 py-2.5 rounded-lg bg-slate-700 text-slate-300 hover:bg-slate-600 text-sm font-medium transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:g,className:"flex-1 py-2.5 rounded-lg bg-amber-500 hover:bg-amber-400 text-slate-900 text-sm font-bold transition-colors disabled:opacity-50",children:g?"Creating...":"Create Job"})]})]})]})}):null},z="lld-input w-full pl-10 pr-4 py-3 rounded-xl text-sm transition-all",ps=({open:t,onClose:s})=>{var T;const{signIn:a,signUp:r}=Ge(),[o,i]=l.useState("signin"),[n,d]=l.useState(""),[c,g]=l.useState(""),[f,u]=l.useState(""),[b,N]=l.useState(""),[C,h]=l.useState("foreman"),[p,w]=l.useState(!1),[_,D]=l.useState(!1),[F,S]=l.useState(null),[L,I]=l.useState(null),O=()=>{d(""),g(""),u(""),N(""),h("foreman"),S(null),I(null)},P=y=>{i(y),O()},M=async y=>{if(y.preventDefault(),S(null),!n||!c){S("Please fill in all fields");return}D(!0);const{error:v}=await a(n,c);if(D(!1),v){S(v);return}s(),O()},A=async y=>{if(y.preventDefault(),S(null),!n||!c||!b){S("Please fill in all fields");return}if(c.length<6){S("Password must be at least 6 characters");return}if(c!==f){S("Passwords do not match");return}D(!0);const{error:v}=await r(n,c,b,C);if(D(!1),v){S(v);return}I("Account created! You can now sign in."),setTimeout(()=>{P("signin")},1500)};if(!t)return null;const E={site_manager:Oe,foreman:oe,safety_officer:ne};return e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:s}),e.jsxs("div",{className:"relative w-full max-w-md bg-slate-800 border border-slate-700/50 rounded-2xl shadow-2xl overflow-hidden",children:[e.jsxs("div",{className:"relative bg-gradient-to-br from-amber-500/20 via-slate-800 to-slate-800 px-6 pt-6 pb-4",children:[e.jsx("button",{onClick:s,className:"absolute top-4 right-4 p-2 rounded-lg hover:bg-slate-700/50 text-slate-400 hover:text-white transition-colors",children:e.jsx(te,{className:"w-5 h-5"})}),e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-gradient-to-br from-amber-400 to-amber-600 flex items-center justify-center shadow-lg shadow-amber-500/20",children:e.jsx(oe,{className:"w-5 h-5 text-slate-900"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-bold text-white",children:Je.appName}),e.jsx("p",{className:"text-xs text-slate-400",children:"Construction Management Platform"})]})]}),e.jsxs("div",{className:"flex bg-slate-700/50 rounded-xl p-1",children:[e.jsx("button",{onClick:()=>P("signin"),className:`flex-1 py-2 px-4 rounded-lg text-sm font-medium transition-all ${o==="signin"?"bg-amber-500 text-slate-900 shadow-lg shadow-amber-500/20":"text-slate-400 hover:text-white"}`,children:"Sign In"}),e.jsx("button",{onClick:()=>P("signup"),className:`flex-1 py-2 px-4 rounded-lg text-sm font-medium transition-all ${o==="signup"?"bg-amber-500 text-slate-900 shadow-lg shadow-amber-500/20":"text-slate-400 hover:text-white"}`,children:"Create Account"})]})]}),e.jsxs("div",{className:"px-6 pb-6 pt-2",children:[F&&e.jsxs("div",{className:"flex items-center gap-2 p-3 mb-4 rounded-xl bg-red-500/10 border border-red-500/20 text-red-400 text-sm",children:[e.jsx(ne,{className:"w-4 h-4 flex-shrink-0"}),e.jsx("span",{children:F})]}),L&&e.jsxs("div",{className:"flex items-center gap-2 p-3 mb-4 rounded-xl bg-green-500/10 border border-green-500/20 text-green-400 text-sm",children:[e.jsx(bt,{className:"w-4 h-4 flex-shrink-0"}),e.jsx("span",{children:L})]}),o==="signin"?e.jsxs("form",{onSubmit:M,className:"space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(me,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400"}),e.jsx("input",{type:"email",placeholder:"Email address",value:n,onChange:y=>d(y.target.value),className:z,autoComplete:"email"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(Z,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400"}),e.jsx("input",{type:p?"text":"password",placeholder:"Password",value:c,onChange:y=>g(y.target.value),className:`${z} pr-10`,autoComplete:"current-password"}),e.jsx("button",{type:"button",onClick:()=>w(!p),className:"absolute right-3 top-1/2 -translate-y-1/2 text-slate-400 hover:text-white transition-colors",children:p?e.jsx(ge,{className:"w-4 h-4"}):e.jsx(pe,{className:"w-4 h-4"})})]}),e.jsxs("button",{type:"submit",disabled:_,className:"w-full py-3 rounded-xl bg-gradient-to-r from-amber-500 to-amber-600 hover:from-amber-400 hover:to-amber-500 text-slate-900 font-semibold text-sm transition-all shadow-lg shadow-amber-500/20 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[_?e.jsx(fe,{className:"w-4 h-4 animate-spin"}):null,_?"Signing in...":"Sign In"]})]}):e.jsxs("form",{onSubmit:A,className:"space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(ie,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400"}),e.jsx("input",{type:"text",placeholder:"Full name",value:b,onChange:y=>N(y.target.value),className:z,autoComplete:"name"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(me,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400"}),e.jsx("input",{type:"email",placeholder:"Email address",value:n,onChange:y=>d(y.target.value),className:z,autoComplete:"email"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-400 mb-2",children:"Your Role"}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:ce.map(y=>{const v=E[y.value],R=C===y.value;return e.jsxs("button",{type:"button",onClick:()=>h(y.value),className:`flex flex-col items-center gap-1.5 p-3 rounded-xl border transition-all text-center ${R?"bg-amber-500/10 border-amber-500/50 text-amber-400":"bg-slate-700/40 border-slate-600/50 text-slate-400 hover:border-slate-500"}`,children:[e.jsx(v,{className:"w-5 h-5"}),e.jsx("span",{className:"text-xs font-medium leading-tight",children:y.label})]},y.value)})}),e.jsx("p",{className:"text-xs text-slate-500 mt-1.5",children:(T=ce.find(y=>y.value===C))==null?void 0:T.description})]}),e.jsxs("div",{className:"relative",children:[e.jsx(Z,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400"}),e.jsx("input",{type:p?"text":"password",placeholder:"Password (min 6 characters)",value:c,onChange:y=>g(y.target.value),className:`${z} pr-10`,autoComplete:"new-password"}),e.jsx("button",{type:"button",onClick:()=>w(!p),className:"absolute right-3 top-1/2 -translate-y-1/2 text-slate-400 hover:text-white transition-colors",children:p?e.jsx(ge,{className:"w-4 h-4"}):e.jsx(pe,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"relative",children:[e.jsx(Z,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400"}),e.jsx("input",{type:p?"text":"password",placeholder:"Confirm password",value:f,onChange:y=>u(y.target.value),className:z,autoComplete:"new-password"})]}),e.jsxs("button",{type:"submit",disabled:_,className:"w-full py-3 rounded-xl bg-gradient-to-r from-amber-500 to-amber-600 hover:from-amber-400 hover:to-amber-500 text-slate-900 font-semibold text-sm transition-all shadow-lg shadow-amber-500/20 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[_?e.jsx(fe,{className:"w-4 h-4 animate-spin"}):null,_?"Creating account...":"Create Account"]})]}),e.jsx("p",{className:"text-center text-xs text-slate-500 mt-4",children:o==="signin"?e.jsxs(e.Fragment,{children:["Don't have an account?"," ",e.jsx("button",{onClick:()=>P("signup"),className:"text-amber-400 hover:text-amber-300 font-medium",children:"Create one"})]}):e.jsxs(e.Fragment,{children:["Already have an account?"," ",e.jsx("button",{onClick:()=>P("signin"),className:"text-amber-400 hover:text-amber-300 font-medium",children:"Sign in"})]})})]})]})]})},_e=l.lazy(()=>$(()=>import("./DashboardPage-DgesRlp2.js"),__vite__mapDeps([0,1,2,3,4,5,6,7]))),fs=l.lazy(()=>$(()=>import("./DailyLogsPage-Db4haiY4.js"),__vite__mapDeps([8,1,2,3,4,5,6,7]))),hs=l.lazy(()=>$(()=>import("./CalendarPage-CMsQs9a8.js"),__vite__mapDeps([9,1,2,3,4,5,6,7]))),xs=l.lazy(()=>$(()=>import("./TimesheetPage-BnP5sQZq.js"),__vite__mapDeps([10,1,3,4,5,6,7]))),bs=l.lazy(()=>$(()=>import("./ReportsPage-CtgfbqBS.js"),__vite__mapDeps([11,1,2,3,4,5,6,7]))),ys=l.lazy(()=>$(()=>import("./SettingsPage-CiRbiuw4.js"),__vite__mapDeps([12,1,3,4,5,6,7]))),vs={site_manager:Oe,foreman:oe,safety_officer:ne},js=()=>{var T,y;const{user:t,profile:s,loading:a,signOut:r}=Ge(),[o,i]=l.useState("dashboard"),[n,d]=l.useState(!1),[c,g]=l.useState(!1),[f,u]=l.useState(!1),[b,N]=l.useState(!1),[C,h]=l.useState(!1),[p,w]=l.useState(null),[_,D]=l.useState(0),F=(s==null?void 0:s.role)||null;l.useEffect(()=>{ms().then(v=>D(v.totalOverdue)).catch(()=>{})},[o]),l.useEffect(()=>{if(!C)return;const v=R=>h(!1);return document.addEventListener("click",v),()=>document.removeEventListener("click",v)},[C]);const S=l.useCallback((v,R)=>{const H=v;F&&!He[F].includes(H)||(i(H),w(R||null),g(!1))},[F]),L=l.useCallback(v=>{u(!1),i("daily-logs"),w({logId:v})},[]),I=async()=>{await r(),h(!1),i("dashboard")},O=()=>{switch(o){case"dashboard":return e.jsx(_e,{onNavigate:S,onQuickAdd:()=>u(!0)});case"daily-logs":return e.jsx(fs,{initialData:p});case"calendar":return e.jsx(hs,{onNavigate:S,initialData:p});case"timesheets":return e.jsx(xs,{});case"reports":return e.jsx(bs,{onNavigate:S});case"settings":return e.jsx(ys,{userRole:F});default:return e.jsx(_e,{onNavigate:S,onQuickAdd:()=>u(!0)})}},P=(s==null?void 0:s.full_name)||((T=t==null?void 0:t.email)==null?void 0:T.split("@")[0])||"",M=(t==null?void 0:t.email)||"",A=F?vs[F]:ie,E=F&&((y=ce.find(v=>v.value===F))==null?void 0:y.label)||"";return e.jsxs("div",{className:"min-h-screen bg-background",children:[c&&e.jsx("div",{className:"fixed inset-0 z-30 bg-black/50 lg:hidden",onClick:()=>g(!1)}),e.jsx("div",{className:"hidden lg:block",children:e.jsx(Ne,{currentPage:o,onNavigate:v=>{S(v)},collapsed:n,onToggle:()=>d(!n),onQuickAdd:()=>u(!0),stats:{overdue:_,highPriority:0},userRole:F})}),e.jsx("div",{className:`lg:hidden fixed inset-y-0 left-0 z-40 transition-transform duration-300 ${c?"translate-x-0":"-translate-x-full"}`,children:e.jsx(Ne,{currentPage:o,onNavigate:v=>{S(v)},collapsed:n,onToggle:()=>d(!n),onQuickAdd:()=>{u(!0),g(!1)},stats:{overdue:_,highPriority:0},userRole:F})}),e.jsxs("main",{className:`transition-all duration-300 min-h-screen ${n?"ml-16":"ml-60"}`,children:[e.jsx("header",{className:"sticky top-0 z-20 bg-background/80 backdrop-blur-xl border-b border-border/50 px-4 lg:px-6 py-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(os,{}),e.jsx("button",{onClick:()=>g(!c),className:"lg:hidden p-2 rounded-lg hover:bg-card text-muted-foreground",children:c?e.jsx(te,{className:"w-5 h-5"}):e.jsx(yt,{className:"w-5 h-5"})}),e.jsx("h2",{className:"text-sm font-semibold text-muted-foreground capitalize",children:o.replace("-"," ")})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-xs text-muted-foreground hidden sm:inline",children:new Date().toLocaleDateString("en-NZ",{weekday:"long",day:"numeric",month:"long",year:"numeric"})}),a?e.jsx("div",{className:"w-8 h-8 rounded-full bg-card animate-pulse"}):t?e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:v=>{v.stopPropagation(),h(!C)},className:"flex items-center gap-2 pl-2 pr-3 py-1.5 rounded-xl bg-card/80 border border-border/50 hover:border-border transition-all",children:[e.jsx("div",{className:"w-7 h-7 rounded-lg bg-primary flex items-center justify-center",children:e.jsx("span",{className:"text-xs font-bold text-foreground",children:P.charAt(0).toUpperCase()||"U"})}),e.jsxs("div",{className:"hidden sm:block text-left",children:[e.jsx("p",{className:"text-xs font-medium text-white leading-none",children:P}),e.jsx("p",{className:"text-[10px] text-muted-foreground leading-none mt-0.5",children:E})]}),e.jsx(vt,{className:"w-3 h-3 text-muted-foreground"})]}),C&&e.jsxs("div",{className:"absolute right-0 top-full mt-2 w-64 bg-card border border-border/50 rounded-xl shadow-2xl overflow-hidden",onClick:v=>v.stopPropagation(),children:[e.jsxs("div",{className:"px-4 py-3 border-b border-border/50",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-primary flex items-center justify-center",children:e.jsx("span",{className:"text-sm font-bold text-foreground",children:P.charAt(0).toUpperCase()||"U"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-semibold text-white truncate",children:P}),e.jsx("p",{className:"text-xs text-muted-foreground truncate",children:M})]})]}),e.jsxs("div",{className:"flex items-center gap-1.5 mt-2 px-2 py-1 rounded-lg bg-card/50 w-fit",children:[e.jsx(A,{className:"w-3 h-3 text-primary"}),e.jsx("span",{className:"text-[10px] font-medium text-primary",children:E})]})]}),e.jsxs("div",{className:"p-1.5",children:[e.jsxs("button",{onClick:()=>{h(!1),S("settings")},className:"w-full flex items-center gap-3 px-3 py-2 rounded-lg text-sm text-muted-foreground hover:bg-card/50 hover:text-white transition-colors",children:[e.jsx(ie,{className:"w-4 h-4"}),e.jsx("span",{children:"Profile & Settings"})]}),e.jsxs("button",{onClick:I,className:"w-full flex items-center gap-3 px-3 py-2 rounded-lg text-sm text-red-400 hover:bg-red-500/10 transition-colors",children:[e.jsx(jt,{className:"w-4 h-4"}),e.jsx("span",{children:"Sign Out"})]})]})]})]}):e.jsxs("button",{onClick:()=>N(!0),className:"flex items-center gap-2 px-4 py-2 rounded-xl bg-primary hover:bg-primary/90 text-foreground font-semibold text-xs transition-all shadow-lg shadow-primary/20",children:[e.jsx(wt,{className:"w-3.5 h-3.5"}),e.jsx("span",{children:"Sign In"})]})]})]})}),e.jsx("div",{className:"p-4 lg:p-6",children:e.jsx(l.Suspense,{fallback:e.jsx("div",{className:"p-6 text-muted-foreground text-sm",children:"Loading…"}),children:O()})})]}),e.jsx(gs,{open:f,onClose:()=>u(!1),onCreated:L}),e.jsx(ps,{open:b,onClose:()=>N(!1)})]})},ws=()=>{const t=_t();return l.useEffect(()=>{console.error("404 Error: User attempted to access non-existent route:",t.pathname)},[t.pathname]),e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background",children:e.jsxs("div",{className:"text-center p-8 rounded-lg border border-border bg-card shadow-md animate-slide-in",children:[e.jsx("h1",{className:"text-5xl font-bold mb-6 text-primary",children:"404"}),e.jsx("p",{className:"text-xl text-card-foreground mb-6",children:"Page not found"}),e.jsx("a",{href:"/",className:"text-primary hover:text-primary/80 underline transition-colors",children:"Return to Home"})]})})},Ns=new Nt,Cs=()=>e.jsx(Jt,{defaultTheme:"light",children:e.jsx(Ct,{client:Ns,children:e.jsxs(Qt,{children:[e.jsx(Ht,{}),e.jsx(Zt,{}),e.jsx(ts,{children:e.jsx(rs,{children:e.jsx(St,{future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:e.jsxs(kt,{children:[e.jsx(Y,{path:"/",element:e.jsx(Ft,{to:"/dashboard",replace:!0})}),e.jsx(Y,{path:"/*",element:e.jsx(js,{})}),e.jsx(Y,{path:"*",element:e.jsx(ws,{})}),e.jsx(Y,{path:"/settings",element:e.jsx(Mt,{})})]})})})})]})})}),Ye="lld.themeId";function _s(){try{return localStorage.getItem(Ye)}catch{return null}}function Ss(t){try{localStorage.setItem(Ye,t)}catch{}}function ks(){return de[0]}function Fs(){const t=_s(),s=t&&xe(t)?xe(t):ks();return It(s),t||Ss(s.id),s}Fs();At({immediate:!0});at(document.getElementById("root")).render(e.jsx(Cs,{}));export{ra as A,ia as B,da as C,ma as D,ga as E,ua as F,pa as G,Ms as H,Us as I,Ge as J,Re as K,de as L,je as M,Rs as N,Je as O,fa as P,Os as T,ce as U,ns as W,Ws as a,ms as b,ha as c,qs as d,$s as e,cs as f,Bs as g,Gs as h,Vs as i,Js as j,Zs as k,Qs as l,Xs as m,ea as n,sa as o,aa as p,oa as q,na as r,la as s,Ce as t,Hs as u,ca as v,zs as w,Ys as x,Ks as y,ta as z};
