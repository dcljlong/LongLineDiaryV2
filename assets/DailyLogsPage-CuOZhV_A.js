import{r as p,j as e,H as ne,C as q,J as de,K as ie,D as oe}from"./vendor-BUGsBopJ.js";import{t as ce,a as G,h as xe,i as me,g as ue,j as pe,W as he,u as je,T as C,k as B,l as be,m as K,n as ge,o as Q,p as ye,q as J,r as ve,s as U,v as Ne,w as fe,x as we,d as _e,y as ke,z as Ce,A as Se,B as qe}from"./index-CowSs7el.js";import{P as Z}from"./PriorityBadge-DJMfzYX1.js";import{F as X,u as De,A as Te,z as Ae,W as Ee,k as Me,a as Pe,g as Fe,f as Ie,K as R,P as w,r as Le,X as $e}from"./icons-BH71IJCZ.js";import"./radix-DOd9NWOq.js";import"./tanstack-D2p4VxNq.js";import"./router-DTOaVcvx.js";import"./supabase-BqdusSG3.js";const i="lld-input w-full px-3 py-2 rounded-lg text-sm",o="block text-xs font-semibold text-muted-foreground mb-1",N="px-3 py-1.5 rounded-lg bg-amber-500 hover:bg-amber-400 text-foreground text-xs font-semibold transition-colors",_="px-3 py-1.5 rounded-lg bg-muted hover:bg-muted text-foreground text-xs font-semibold transition-colors",We="p-1.5 rounded-lg hover:bg-red-500/20 text-red-400 transition-colors",Y="w-4 h-4 rounded border-border bg-muted text-amber-500 focus:ring-amber-500",ss=({initialData:a})=>{var M,P,F,I,L,$,W,O,z;const[d,c]=p.useState(new Date),[u,t]=p.useState(ce()),[l,b]=p.useState([]),[h,s]=p.useState([]),[x,m]=p.useState(null),[r,y]=p.useState(null),[j,D]=p.useState("general"),[Ke,T]=p.useState(!1),A=p.useCallback(async()=>{T(!0);try{const n=await G({date:u});b(n),n.length>0&&!x&&m(n[0].id)}catch(n){console.error(n)}T(!1)},[u]),f=p.useCallback(async()=>{if(!x){y(null);return}try{const n=await xe(x);y(n)}catch(n){console.error(n)}},[x]),E=p.useCallback(async()=>{try{const n=await G();s(n.map(g=>g.log_date))}catch(n){console.error(n)}},[]);p.useEffect(()=>{A()},[u]),p.useEffect(()=>{f()},[x]),p.useEffect(()=>{E()},[]),p.useEffect(()=>{a!=null&&a.logId&&m(a.logId),a!=null&&a.tab&&D(a.tab)},[a]),p.useEffect(()=>{l.length>0&&!l.find(n=>n.id===x)&&m(l[0].id),l.length===0&&(m(null),y(null))},[l]);const ee=me(d.getFullYear(),d.getMonth()),se=async n=>{confirm("Delete this job entry?")&&(await pe(n),m(null),A(),E())},te=async(n,g)=>{if(r)try{await je(r.id,{[n]:g}),y(v=>v?{...v,[n]:g}:null)}catch(v){console.error(v)}},ae=[{key:"general",label:"General",icon:X},{key:"crew",label:"Crew",icon:De,count:(M=r==null?void 0:r.crew)==null?void 0:M.length},{key:"activities",label:"Activities",icon:Te,count:(P=r==null?void 0:r.activities)==null?void 0:P.length},{key:"materials",label:"Materials",icon:Ae,count:(F=r==null?void 0:r.materials)==null?void 0:F.length},{key:"equipment",label:"Equipment",icon:Ee,count:(I=r==null?void 0:r.equipment)==null?void 0:I.length},{key:"visitors",label:"Visitors",icon:Me,count:(L=r==null?void 0:r.visitors)==null?void 0:L.length}];return e.jsxs("div",{className:"flex flex-col lg:flex-row gap-4 h-[calc(100vh-5rem)]",children:[e.jsxs("div",{className:"lg:hidden flex items-center gap-2 bg-card border border-border rounded-xl p-3",children:[e.jsx(Pe,{className:"w-4 h-4 text-amber-400"}),e.jsx("input",{type:"date",value:u,onChange:n=>{t(n.target.value),m(null)},className:"flex-1 px-3 py-1.5 rounded-lg bg-muted border border-border text-foreground text-sm focus:outline-none focus:border-amber-500"}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:[l.length," job",l.length!==1?"s":""]})]}),e.jsxs("div",{className:"hidden lg:block w-64 flex-shrink-0 bg-card border border-border rounded-xl p-3 overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("button",{onClick:()=>c(ne(d)),className:"p-1 rounded hover:bg-muted text-muted-foreground",children:e.jsx(Fe,{className:"w-4 h-4"})}),e.jsx("span",{className:"text-sm font-semibold text-foreground",children:q(d,"MMMM yyyy")}),e.jsx("button",{onClick:()=>c(de(d,1)),className:"p-1 rounded hover:bg-muted text-muted-foreground",children:e.jsx(Ie,{className:"w-4 h-4"})})]}),e.jsx("div",{className:"grid grid-cols-7 gap-0.5 text-center mb-1",children:["S","M","T","W","T","F","S"].map((n,g)=>e.jsx("div",{className:"text-[10px] text-muted-foreground font-semibold py-1",children:n},g))}),ee.map((n,g)=>e.jsx("div",{className:"grid grid-cols-7 gap-0.5",children:n.map((v,H)=>{if(!v)return e.jsx("div",{},H);const S=q(v,"yyyy-MM-dd"),V=S===u,le=ie(v,new Date),re=h.includes(S);return e.jsxs("button",{onClick:()=>{t(S),m(null)},className:`relative w-full aspect-square flex items-center justify-center rounded-lg text-xs transition-colors ${V?"bg-primary text-primary-foreground font-extrabold":le?"bg-primary/15 text-primary font-bold":"text-foreground hover:bg-muted/50"}`,children:[v.getDate(),re&&!V&&e.jsx("span",{className:"absolute bottom-0.5 left-1/2 -translate-x-1/2 w-1 h-1 rounded-full bg-amber-400"})]},H)})},g)),e.jsxs("div",{className:"mt-4 space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs text-muted-foreground font-semibold",children:q(oe(u),"EEE, dd MMM")}),e.jsxs("span",{className:"text-[10px] text-muted-foreground",children:[l.length," job",l.length!==1?"s":""]})]}),l.map(n=>{var g,v;return e.jsxs("button",{onClick:()=>m(n.id),className:`w-full text-left p-2 rounded-lg text-xs transition-colors ${x===n.id?"bg-amber-500/15 border border-amber-500/30 text-amber-300":"bg-muted/60 border border-transparent text-foreground hover:bg-muted/50"}`,children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("span",{className:`w-1.5 h-1.5 rounded-full ${ue(n.priority)}`}),e.jsx("span",{className:"font-semibold truncate",children:((g=n.project)==null?void 0:g.name)||"Unknown"})]}),((v=n.project)==null?void 0:v.job_number)&&e.jsxs("span",{className:"text-[10px] text-muted-foreground ml-3",children:["#",n.project.job_number]})]},n.id)})]})]}),e.jsx("div",{className:"flex-1 min-w-0 overflow-y-auto",children:r?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between bg-card border border-border rounded-xl p-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-xs font-mono text-amber-400 bg-amber-500/10 px-2 py-0.5 rounded",children:["#",(($=r.project)==null?void 0:$.job_number)||"â€”"]}),e.jsx(Z,{priority:r.priority})]}),e.jsx("h2",{className:"text-lg font-bold text-foreground mt-1",children:((W=r.project)==null?void 0:W.name)||"Unknown"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[(O=r.project)==null?void 0:O.location," ",(z=r.project)!=null&&z.client?`â€¢ ${r.project.client}`:""]})]}),e.jsx("div",{className:"flex gap-2",children:e.jsx("button",{onClick:()=>se(r.id),className:"p-2 rounded-lg hover:bg-red-500/20 text-red-400",children:e.jsx(R,{className:"w-4 h-4"})})})]}),e.jsx("div",{className:"flex gap-1 overflow-x-auto pb-1",children:ae.map(n=>{const g=n.icon;return e.jsxs("button",{onClick:()=>D(n.key),className:`flex items-center gap-1.5 px-3 py-2 rounded-lg text-xs font-semibold whitespace-nowrap transition-colors ${j===n.key?"bg-amber-500/15 text-amber-400 border border-amber-500/30":"text-muted-foreground hover:text-foreground hover:bg-muted border border-transparent"}`,children:[e.jsx(g,{className:"w-3.5 h-3.5"}),n.label,n.count!==void 0&&n.count>0&&e.jsx("span",{className:"bg-muted text-foreground px-1.5 py-0.5 rounded-full text-[10px]",children:n.count})]},n.key)})}),e.jsxs("div",{className:"bg-card border border-border rounded-xl p-4",children:[j==="general"&&e.jsx(Oe,{log:r,onUpdate:te}),j==="crew"&&e.jsx(ze,{log:r,onRefresh:f}),j==="activities"&&e.jsx(He,{log:r,onRefresh:f}),j==="materials"&&e.jsx(Ve,{log:r,onRefresh:f}),j==="equipment"&&e.jsx(Ge,{log:r,onRefresh:f}),j==="visitors"&&e.jsx(Be,{log:r,onRefresh:f})]})]}):e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsxs("div",{className:"text-center",children:[e.jsx(X,{className:"w-12 h-12 text-muted-foreground mx-auto mb-3"}),e.jsx("p",{className:"text-muted-foreground text-sm",children:"Select a job from the calendar or create a new one"})]})})})]})},Oe=({log:a,onUpdate:d})=>e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:o,children:"Weather"}),e.jsxs("select",{value:a.weather||"",onChange:c=>d("weather",c.target.value),className:i,children:[e.jsx("option",{value:"",children:"Select..."}),he.map(c=>e.jsx("option",{value:c,children:c},c))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:o,children:"Temperature"}),e.jsx("input",{value:a.temperature||"",onChange:c=>d("temperature",c.target.value),className:i,placeholder:"e.g. 18Â°C"})]}),e.jsxs("div",{children:[e.jsx("label",{className:o,children:"Wind"}),e.jsx("input",{value:a.wind||"",onChange:c=>d("wind",c.target.value),className:i,placeholder:"e.g. Light NW"})]}),e.jsxs("div",{children:[e.jsx("label",{className:o,children:"Priority"}),e.jsxs("select",{value:a.priority,onChange:c=>d("priority",c.target.value),className:i,children:[e.jsx("option",{value:"low",children:"Low"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"high",children:"High"})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:o,children:"Site Conditions"}),e.jsx("input",{value:a.site_conditions||"",onChange:c=>d("site_conditions",c.target.value),className:i,placeholder:"e.g. Dry, good access"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:o,children:"Safety Incidents"}),e.jsx("textarea",{value:a.safety_incidents||"",onChange:c=>d("safety_incidents",c.target.value),rows:2,className:`${i} resize-none`,placeholder:"Record any safety incidents..."})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:o,children:"Critical Items"}),e.jsx("textarea",{value:a.critical_items||"",onChange:c=>d("critical_items",c.target.value),rows:2,className:`${i} resize-none`,placeholder:"Flag any critical issues..."})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:o,children:"Notes"}),e.jsx("textarea",{value:a.notes||"",onChange:c=>d("notes",c.target.value),rows:3,className:`${i} resize-none`,placeholder:"General notes for the day..."})]})]});function k({item:a,fields:d,onSave:c,onDelete:u,onToggleComplete:t}){const[l,b]=p.useState(!1),[h,s]=p.useState({...a}),x=()=>{const r={};d.forEach(y=>{h[y.key]!==a[y.key]&&(r[y.key]=h[y.key])}),Object.keys(r).length>0&&c(a.id,r),b(!1)},m=_e(a.due_date||a.required_date);return e.jsxs("tr",{className:`border-b border-border/60 ${a.is_completed?"opacity-50":""}`,children:[e.jsx("td",{className:"py-2 px-2",children:e.jsx("input",{type:"checkbox",checked:a.is_completed,onChange:r=>t(a.id,r.target.checked),className:Y})}),d.map(r=>{var y;return e.jsx("td",{className:"py-2 px-2",children:l?r.type==="select"?e.jsxs("select",{value:h[r.key]||"",onChange:j=>s({...h,[r.key]:j.target.value}),className:"w-full px-2 py-1 rounded bg-muted border border-border text-foreground text-xs",children:[e.jsx("option",{value:"",children:"â€”"}),(y=r.options)==null?void 0:y.map(j=>e.jsx("option",{value:j,children:j},j))]}):r.type==="checkbox"?e.jsx("input",{type:"checkbox",checked:h[r.key]||!1,onChange:j=>s({...h,[r.key]:j.target.checked}),className:Y}):e.jsx("input",{type:r.type,value:h[r.key]||"",onChange:j=>s({...h,[r.key]:r.type==="number"?Number(j.target.value):j.target.value}),className:"w-full px-2 py-1 rounded bg-muted border border-border text-foreground text-xs"}):e.jsx("span",{className:`text-xs ${a.is_completed?"line-through text-muted-foreground":"text-foreground"}`,children:a[r.key]||"â€”"})},r.key)}),e.jsx("td",{className:"py-2 px-2",children:e.jsx(Z,{priority:m,size:"sm",showIcon:!1})}),e.jsx("td",{className:"py-2 px-2",children:e.jsx("div",{className:"flex gap-1",children:l?e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:x,className:"p-1 rounded hover:bg-emerald-500/20 text-emerald-400",children:e.jsx(Le,{className:"w-3.5 h-3.5"})}),e.jsx("button",{onClick:()=>{b(!1),s({...a})},className:"p-1 rounded hover:bg-muted text-muted-foreground",children:e.jsx($e,{className:"w-3.5 h-3.5"})})]}):e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>b(!0),className:"p-1 rounded hover:bg-muted text-muted-foreground text-xs",children:"Edit"}),e.jsx("button",{onClick:()=>u(a.id),className:We,children:e.jsx(R,{className:"w-3.5 h-3.5"})})]})})})]})}const ze=({log:a,onRefresh:d})=>{const[c,u]=p.useState(!1),[t,l]=p.useState({worker_name:"",trade:"",start_time:"07:00",finish_time:"16:30",lunch_minutes:30,due_date:"",notes:""}),b=async()=>{const s=fe(t.start_time,t.finish_time,t.lunch_minutes);await we({...t,daily_log_id:a.id,hours_worked:s,is_completed:!1}),l({worker_name:"",trade:"",start_time:"07:00",finish_time:"16:30",lunch_minutes:30,due_date:"",notes:""}),u(!1),d()},h=[{key:"worker_name",label:"Name",type:"text"},{key:"trade",label:"Trade",type:"select",options:C},{key:"start_time",label:"Start",type:"time"},{key:"finish_time",label:"Finish",type:"time"},{key:"due_date",label:"Due Date",type:"date"},{key:"notes",label:"Notes",type:"text"}];return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-sm font-semibold text-foreground",children:"Crew Attendance"}),e.jsxs("button",{onClick:()=>u(!c),className:N,children:[e.jsx(w,{className:"w-3 h-3 inline mr-1"}),"Add"]})]}),c&&e.jsxs("div",{className:"bg-muted/60 border border-border rounded-lg p-3 mb-3 grid grid-cols-2 md:grid-cols-4 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:o,children:"Name *"}),e.jsx("input",{value:t.worker_name,onChange:s=>l({...t,worker_name:s.target.value}),className:i})]}),e.jsxs("div",{children:[e.jsx("label",{className:o,children:"Trade"}),e.jsxs("select",{value:t.trade,onChange:s=>l({...t,trade:s.target.value}),className:i,children:[e.jsx("option",{value:"",children:"â€”"}),C.map(s=>e.jsx("option",{children:s},s))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:o,children:"Start"}),e.jsx("input",{type:"time",value:t.start_time,onChange:s=>l({...t,start_time:s.target.value}),className:i})]}),e.jsxs("div",{children:[e.jsx("label",{className:o,children:"Finish"}),e.jsx("input",{type:"time",value:t.finish_time,onChange:s=>l({...t,finish_time:s.target.value}),className:i})]}),e.jsxs("div",{children:[e.jsx("label",{className:o,children:"Due Date"}),e.jsx("input",{type:"date",value:t.due_date,onChange:s=>l({...t,due_date:s.target.value}),className:i})]}),e.jsxs("div",{children:[e.jsx("label",{className:o,children:"Notes"}),e.jsx("input",{value:t.notes,onChange:s=>l({...t,notes:s.target.value}),className:i})]}),e.jsxs("div",{className:"flex items-end gap-2",children:[e.jsx("button",{onClick:b,className:N,children:"Save"}),e.jsx("button",{onClick:()=>u(!1),className:_,children:"Cancel"})]})]}),e.jsxs("div",{className:"overflow-x-auto",children:[e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-border",children:[e.jsx("th",{className:"py-2 px-2 text-[10px] text-muted-foreground w-8"}),h.map(s=>e.jsx("th",{className:"py-2 px-2 text-[10px] text-foreground/80 uppercase",children:s.label},s.key)),e.jsx("th",{className:"py-2 px-2 text-[10px] text-muted-foreground",children:"Priority"}),e.jsx("th",{className:"py-2 px-2 text-[10px] text-muted-foreground w-20"})]})}),e.jsx("tbody",{children:(a.crew||[]).map(s=>e.jsx(k,{item:s,fields:h,onSave:async(x,m)=>{await B(x,m),d()},onDelete:async x=>{await be(x),d()},onToggleComplete:async(x,m)=>{await B(x,{is_completed:m}),d()}},s.id))})]}),(!a.crew||a.crew.length===0)&&e.jsx("p",{className:"text-xs text-muted-foreground text-center py-4",children:"No crew recorded. Click Add to start."})]})]})},He=({log:a,onRefresh:d})=>{const[c,u]=p.useState(!1),[t,l]=p.useState({description:"",location:"",trade:"",progress_pct:0,due_date:"",notes:""}),b=async()=>{await ke({...t,daily_log_id:a.id,is_completed:!1}),l({description:"",location:"",trade:"",progress_pct:0,due_date:"",notes:""}),u(!1),d()},h=[{key:"description",label:"Description",type:"text"},{key:"location",label:"Location",type:"text"},{key:"trade",label:"Trade",type:"select",options:C},{key:"progress_pct",label:"Progress %",type:"number"},{key:"due_date",label:"Due Date",type:"date"},{key:"notes",label:"Notes",type:"text"}];return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-sm font-semibold text-foreground",children:"Work Activities"}),e.jsxs("button",{onClick:()=>u(!c),className:N,children:[e.jsx(w,{className:"w-3 h-3 inline mr-1"}),"Add"]})]}),c&&e.jsxs("div",{className:"bg-muted/60 border border-border rounded-lg p-3 mb-3 grid grid-cols-2 md:grid-cols-3 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:o,children:"Description *"}),e.jsx("input",{value:t.description,onChange:s=>l({...t,description:s.target.value}),className:i})]}),e.jsxs("div",{children:[e.jsx("label",{className:o,children:"Location"}),e.jsx("input",{value:t.location,onChange:s=>l({...t,location:s.target.value}),className:i})]}),e.jsxs("div",{children:[e.jsx("label",{className:o,children:"Trade"}),e.jsxs("select",{value:t.trade,onChange:s=>l({...t,trade:s.target.value}),className:i,children:[e.jsx("option",{value:"",children:"â€”"}),C.map(s=>e.jsx("option",{children:s},s))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:o,children:"Progress %"}),e.jsx("input",{type:"number",min:0,max:100,value:t.progress_pct,onChange:s=>l({...t,progress_pct:Number(s.target.value)}),className:i})]}),e.jsxs("div",{children:[e.jsx("label",{className:o,children:"Due Date"}),e.jsx("input",{type:"date",value:t.due_date,onChange:s=>l({...t,due_date:s.target.value}),className:i})]}),e.jsxs("div",{children:[e.jsx("label",{className:o,children:"Notes"}),e.jsx("input",{value:t.notes,onChange:s=>l({...t,notes:s.target.value}),className:i})]}),e.jsxs("div",{className:"flex items-end gap-2",children:[e.jsx("button",{onClick:b,className:N,children:"Save"}),e.jsx("button",{onClick:()=>u(!1),className:_,children:"Cancel"})]})]}),e.jsxs("div",{className:"overflow-x-auto",children:[e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-border",children:[e.jsx("th",{className:"py-2 px-2 text-[10px] text-muted-foreground w-8"}),h.map(s=>e.jsx("th",{className:"py-2 px-2 text-[10px] text-foreground/80 uppercase",children:s.label},s.key)),e.jsx("th",{className:"py-2 px-2 text-[10px] text-muted-foreground",children:"Priority"}),e.jsx("th",{className:"py-2 px-2 text-[10px] text-muted-foreground w-20"})]})}),e.jsx("tbody",{children:(a.activities||[]).map(s=>e.jsx(k,{item:s,fields:h,onSave:async(x,m)=>{await K(x,m),d()},onDelete:async x=>{await ge(x),d()},onToggleComplete:async(x,m)=>{await K(x,{is_completed:m}),d()}},s.id))})]}),(!a.activities||a.activities.length===0)&&e.jsx("p",{className:"text-xs text-muted-foreground text-center py-4",children:"No activities recorded. Click Add to start."})]})]})},Ve=({log:a,onRefresh:d})=>{const[c,u]=p.useState(!1),[t,l]=p.useState({description:"",quantity:"",unit:"",supplier:"",required_date:"",status:"pending",notes:""}),b=async()=>{await Ce({...t,daily_log_id:a.id,is_completed:!1}),l({description:"",quantity:"",unit:"",supplier:"",required_date:"",status:"pending",notes:""}),u(!1),d()},h=[{key:"description",label:"Description",type:"text"},{key:"quantity",label:"Qty",type:"text"},{key:"unit",label:"Unit",type:"text"},{key:"supplier",label:"Supplier",type:"text"},{key:"required_date",label:"Required Date",type:"date"},{key:"status",label:"Status",type:"select",options:["pending","ordered","in-transit","delivered"]},{key:"notes",label:"Notes",type:"text"}];return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-sm font-semibold text-foreground",children:"Materials"}),e.jsxs("button",{onClick:()=>u(!c),className:N,children:[e.jsx(w,{className:"w-3 h-3 inline mr-1"}),"Add"]})]}),c&&e.jsxs("div",{className:"bg-muted/60 border border-border rounded-lg p-3 mb-3 grid grid-cols-2 md:grid-cols-4 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:o,children:"Description *"}),e.jsx("input",{value:t.description,onChange:s=>l({...t,description:s.target.value}),className:i})]}),e.jsxs("div",{children:[e.jsx("label",{className:o,children:"Quantity"}),e.jsx("input",{value:t.quantity,onChange:s=>l({...t,quantity:s.target.value}),className:i})]}),e.jsxs("div",{children:[e.jsx("label",{className:o,children:"Unit"}),e.jsx("input",{value:t.unit,onChange:s=>l({...t,unit:s.target.value}),className:i,placeholder:"e.g. mÂ², sheets"})]}),e.jsxs("div",{children:[e.jsx("label",{className:o,children:"Supplier"}),e.jsx("input",{value:t.supplier,onChange:s=>l({...t,supplier:s.target.value}),className:i})]}),e.jsxs("div",{children:[e.jsx("label",{className:o,children:"Required Date"}),e.jsx("input",{type:"date",value:t.required_date,onChange:s=>l({...t,required_date:s.target.value}),className:i})]}),e.jsxs("div",{children:[e.jsx("label",{className:o,children:"Status"}),e.jsxs("select",{value:t.status,onChange:s=>l({...t,status:s.target.value}),className:i,children:[e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"ordered",children:"Ordered"}),e.jsx("option",{value:"in-transit",children:"In Transit"}),e.jsx("option",{value:"delivered",children:"Delivered"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:o,children:"Notes"}),e.jsx("input",{value:t.notes,onChange:s=>l({...t,notes:s.target.value}),className:i})]}),e.jsxs("div",{className:"flex items-end gap-2",children:[e.jsx("button",{onClick:b,className:N,children:"Save"}),e.jsx("button",{onClick:()=>u(!1),className:_,children:"Cancel"})]})]}),e.jsxs("div",{className:"overflow-x-auto",children:[e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-border",children:[e.jsx("th",{className:"py-2 px-2 text-[10px] text-muted-foreground w-8"}),h.map(s=>e.jsx("th",{className:"py-2 px-2 text-[10px] text-foreground/80 uppercase",children:s.label},s.key)),e.jsx("th",{className:"py-2 px-2 text-[10px] text-muted-foreground",children:"Priority"}),e.jsx("th",{className:"py-2 px-2 text-[10px] text-muted-foreground w-20"})]})}),e.jsx("tbody",{children:(a.materials||[]).map(s=>e.jsx(k,{item:s,fields:h,onSave:async(x,m)=>{await Q(x,m),d()},onDelete:async x=>{await ye(x),d()},onToggleComplete:async(x,m)=>{await Q(x,{is_completed:m}),d()}},s.id))})]}),(!a.materials||a.materials.length===0)&&e.jsx("p",{className:"text-xs text-muted-foreground text-center py-4",children:"No materials recorded. Click Add to start."})]})]})},Ge=({log:a,onRefresh:d})=>{const[c,u]=p.useState(!1),[t,l]=p.useState({equipment_name:"",equipment_type:"",hours_used:0,condition:"good",due_date:"",notes:""}),b=async()=>{await Se({...t,daily_log_id:a.id,is_completed:!1}),l({equipment_name:"",equipment_type:"",hours_used:0,condition:"good",due_date:"",notes:""}),u(!1),d()},h=[{key:"equipment_name",label:"Equipment",type:"text"},{key:"equipment_type",label:"Type",type:"text"},{key:"hours_used",label:"Hours",type:"number"},{key:"condition",label:"Condition",type:"select",options:["good","fair","poor","needs-repair"]},{key:"due_date",label:"Due Date",type:"date"},{key:"notes",label:"Notes",type:"text"}];return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-sm font-semibold text-foreground",children:"Equipment"}),e.jsxs("button",{onClick:()=>u(!c),className:N,children:[e.jsx(w,{className:"w-3 h-3 inline mr-1"}),"Add"]})]}),c&&e.jsxs("div",{className:"bg-muted/60 border border-border rounded-lg p-3 mb-3 grid grid-cols-2 md:grid-cols-3 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:o,children:"Equipment *"}),e.jsx("input",{value:t.equipment_name,onChange:s=>l({...t,equipment_name:s.target.value}),className:i})]}),e.jsxs("div",{children:[e.jsx("label",{className:o,children:"Type"}),e.jsx("input",{value:t.equipment_type,onChange:s=>l({...t,equipment_type:s.target.value}),className:i})]}),e.jsxs("div",{children:[e.jsx("label",{className:o,children:"Hours Used"}),e.jsx("input",{type:"number",value:t.hours_used,onChange:s=>l({...t,hours_used:Number(s.target.value)}),className:i})]}),e.jsxs("div",{children:[e.jsx("label",{className:o,children:"Condition"}),e.jsxs("select",{value:t.condition,onChange:s=>l({...t,condition:s.target.value}),className:i,children:[e.jsx("option",{value:"good",children:"Good"}),e.jsx("option",{value:"fair",children:"Fair"}),e.jsx("option",{value:"poor",children:"Poor"}),e.jsx("option",{value:"needs-repair",children:"Needs Repair"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:o,children:"Due Date"}),e.jsx("input",{type:"date",value:t.due_date,onChange:s=>l({...t,due_date:s.target.value}),className:i})]}),e.jsxs("div",{children:[e.jsx("label",{className:o,children:"Notes"}),e.jsx("input",{value:t.notes,onChange:s=>l({...t,notes:s.target.value}),className:i})]}),e.jsxs("div",{className:"flex items-end gap-2",children:[e.jsx("button",{onClick:b,className:N,children:"Save"}),e.jsx("button",{onClick:()=>u(!1),className:_,children:"Cancel"})]})]}),e.jsxs("div",{className:"overflow-x-auto",children:[e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-border",children:[e.jsx("th",{className:"py-2 px-2 text-[10px] text-muted-foreground w-8"}),h.map(s=>e.jsx("th",{className:"py-2 px-2 text-[10px] text-foreground/80 uppercase",children:s.label},s.key)),e.jsx("th",{className:"py-2 px-2 text-[10px] text-muted-foreground",children:"Priority"}),e.jsx("th",{className:"py-2 px-2 text-[10px] text-muted-foreground w-20"})]})}),e.jsx("tbody",{children:(a.equipment||[]).map(s=>e.jsx(k,{item:s,fields:h,onSave:async(x,m)=>{await J(x,m),d()},onDelete:async x=>{await ve(x),d()},onToggleComplete:async(x,m)=>{await J(x,{is_completed:m}),d()}},s.id))})]}),(!a.equipment||a.equipment.length===0)&&e.jsx("p",{className:"text-xs text-muted-foreground text-center py-4",children:"No equipment recorded. Click Add to start."})]})]})},Be=({log:a,onRefresh:d})=>{const[c,u]=p.useState(!1),[t,l]=p.useState({visitor_name:"",company:"",purpose:"",time_in:"",time_out:"",due_date:"",notes:""}),b=async()=>{await qe({...t,daily_log_id:a.id,is_completed:!1}),l({visitor_name:"",company:"",purpose:"",time_in:"",time_out:"",due_date:"",notes:""}),u(!1),d()},h=[{key:"visitor_name",label:"Name",type:"text"},{key:"company",label:"Company",type:"text"},{key:"purpose",label:"Purpose",type:"text"},{key:"time_in",label:"Time In",type:"time"},{key:"time_out",label:"Time Out",type:"time"},{key:"due_date",label:"Due Date",type:"date"},{key:"notes",label:"Notes",type:"text"}];return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-sm font-semibold text-foreground",children:"Visitors"}),e.jsxs("button",{onClick:()=>u(!c),className:N,children:[e.jsx(w,{className:"w-3 h-3 inline mr-1"}),"Add"]})]}),c&&e.jsxs("div",{className:"bg-muted/60 border border-border rounded-lg p-3 mb-3 grid grid-cols-2 md:grid-cols-4 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:o,children:"Name *"}),e.jsx("input",{value:t.visitor_name,onChange:s=>l({...t,visitor_name:s.target.value}),className:i})]}),e.jsxs("div",{children:[e.jsx("label",{className:o,children:"Company"}),e.jsx("input",{value:t.company,onChange:s=>l({...t,company:s.target.value}),className:i})]}),e.jsxs("div",{children:[e.jsx("label",{className:o,children:"Purpose"}),e.jsx("input",{value:t.purpose,onChange:s=>l({...t,purpose:s.target.value}),className:i})]}),e.jsxs("div",{children:[e.jsx("label",{className:o,children:"Time In"}),e.jsx("input",{type:"time",value:t.time_in,onChange:s=>l({...t,time_in:s.target.value}),className:i})]}),e.jsxs("div",{children:[e.jsx("label",{className:o,children:"Time Out"}),e.jsx("input",{type:"time",value:t.time_out,onChange:s=>l({...t,time_out:s.target.value}),className:i})]}),e.jsxs("div",{children:[e.jsx("label",{className:o,children:"Due Date"}),e.jsx("input",{type:"date",value:t.due_date,onChange:s=>l({...t,due_date:s.target.value}),className:i})]}),e.jsxs("div",{children:[e.jsx("label",{className:o,children:"Notes"}),e.jsx("input",{value:t.notes,onChange:s=>l({...t,notes:s.target.value}),className:i})]}),e.jsxs("div",{className:"flex items-end gap-2",children:[e.jsx("button",{onClick:b,className:N,children:"Save"}),e.jsx("button",{onClick:()=>u(!1),className:_,children:"Cancel"})]})]}),e.jsxs("div",{className:"overflow-x-auto",children:[e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-border",children:[e.jsx("th",{className:"py-2 px-2 text-[10px] text-muted-foreground w-8"}),h.map(s=>e.jsx("th",{className:"py-2 px-2 text-[10px] text-foreground/80 uppercase",children:s.label},s.key)),e.jsx("th",{className:"py-2 px-2 text-[10px] text-muted-foreground",children:"Priority"}),e.jsx("th",{className:"py-2 px-2 text-[10px] text-muted-foreground w-20"})]})}),e.jsx("tbody",{children:(a.visitors||[]).map(s=>e.jsx(k,{item:s,fields:h,onSave:async(x,m)=>{await U(x,m),d()},onDelete:async x=>{await Ne(x),d()},onToggleComplete:async(x,m)=>{await U(x,{is_completed:m}),d()}},s.id))})]}),(!a.visitors||a.visitors.length===0)&&e.jsx("p",{className:"text-xs text-muted-foreground text-center py-4",children:"No visitors recorded. Click Add to start."})]})]})};export{ss as default};
