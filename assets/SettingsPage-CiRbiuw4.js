import{r as l,j as e}from"./vendor-C-VYnThq.js";import{J as H,K as Y,L as k,M as O,G as q,O as J,U as T,P as K}from"./index-CpqWyLnN.js";import{y as L,Q as P,U as m,h as Q,H as V,m as $,R as Z,b as z,d as A,c as X,V as ee,w as se,Y as re,F as te,Z as ae,_ as le,I as oe}from"./icons-BqMI43qa.js";import"./radix-BjS9lnSI.js";import"./tanstack-BiweuTX4.js";import"./router-DAcHDSWI.js";import"./supabase-DOe0D9WC.js";const i="lld-input w-full px-3 py-2 rounded-lg text-sm",o="block text-xs font-medium text-muted-foreground mb-1",E={site_manager:$,foreman:V,safety_officer:Q},he=({userRole:D})=>{const{user:c,profile:n,updateProfile:F}=H(),{theme:R,setTheme:x}=Y(),[I,U]=l.useState(()=>{var s;return((s=k[0])==null?void 0:s.id)??"p1"}),[t,d]=l.useState(O),[u,h]=l.useState(!1),[g,p]=l.useState(!1),[B,f]=l.useState(!0),[b,j]=l.useState(""),[y,N]=l.useState("foreman"),[v,w]=l.useState(!1),[S,C]=l.useState(!1);l.useEffect(()=>{q().then(s=>{d(s),f(!1)}).catch(()=>f(!1))},[]),l.useEffect(()=>{n&&(j(n.full_name),N(n.role))},[n]);const M=async()=>{h(!0);try{await K(t),p(!0),setTimeout(()=>p(!1),2e3)}catch(s){console.error(s),alert("Failed to save settings")}h(!1)},_=async()=>{w(!0);try{await F({full_name:b,role:y}),C(!0),setTimeout(()=>C(!1),2e3)}catch(s){console.error(s)}w(!1)},G=(s,a)=>{d(r=>({...r,features:{...r.features,[s]:a}}))},W=[{key:"analytics",label:"Analytics & Insights",description:"Track crew productivity, project health, and trends",icon:X},{key:"weatherAlerts",label:"Weather Alerts",description:"Get weather forecasts and site impact warnings",icon:ee},{key:"teamCollaboration",label:"Team Collaboration",description:"Comments, mentions, and team notes on logs",icon:se},{key:"approvalWorkflow",label:"Approval Workflow",description:"Require manager sign-off on daily logs",icon:re},{key:"customReports",label:"Custom Reports",description:"Build custom report templates and formats",icon:te},{key:"autoCarryForward",label:"Auto Carry Forward",description:"Automatically move incomplete items to next day",icon:ae},{key:"aiSummary",label:"AI Daily Summary",description:"Get AI-powered morning briefings across all jobs",icon:le},{key:"notifications",label:"Smart Notifications",description:"Automated alerts for overdue items and reminders",icon:oe}];return B?e.jsx("div",{className:"flex items-center justify-center h-96",children:e.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-b-2 border-primary"})}):e.jsxs("div",{className:"space-y-6 max-w-3xl",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-foreground",children:"Settings"}),e.jsxs("p",{className:"text-muted-foreground text-sm mt-1",children:["Configure your ",J.appName," preferences"]})]}),e.jsxs("div",{className:"bg-card border border-border rounded-xl p-5",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h2",{className:"text-sm font-bold text-foreground",children:"Theme"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Choose a preset (applies instantly)"})]}),[{id:"dark-navy",label:"Dark — Navy (Default)",desc:"LLD navy, low glare"},{id:"dark-charcoal",label:"Dark — Charcoal",desc:"Neutral dark, higher contrast"},{id:"light-soft",label:"Light — Soft",desc:"Professional grey background, white fields"},{id:"light-blue",label:"Light — Blue Tint",desc:"Subtle blue tone, white fields"},{id:"light-green",label:"Light — Green Accent",desc:"Green primary accents, white fields"},{id:"light-contrast",label:"Light — High Contrast",desc:"Crisp borders + stronger contrast"}].map(s=>{const a=R===s.id;return e.jsxs("button",{type:"button",onClick:()=>x(s.id),className:a?"w-full p-3 rounded-xl border border-primary/30 bg-primary/10 text-left transition-colors":"w-full p-3 rounded-xl border border-border bg-card hover:bg-muted text-left transition-colors",children:[e.jsx("div",{className:"text-sm font-semibold text-foreground",children:s.label}),e.jsx("div",{className:"text-[11px] text-muted-foreground mt-0.5",children:s.desc})]},s.id)})]}),e.jsx("button",{onClick:M,disabled:u,className:`flex items-center gap-2 px-4 py-2.5 rounded-lg text-sm font-semibold transition-colors ${g?"bg-emerald-500 text-foreground":"bg-primary hover:bg-primary/90 text-primary-foreground"} disabled:opacity-50`,children:g?e.jsxs(e.Fragment,{children:[e.jsx(L,{className:"w-4 h-4"})," Saved"]}):u?"Saving...":e.jsxs(e.Fragment,{children:[e.jsx(P,{className:"w-4 h-4"})," Save Settings"]})})]}),c&&e.jsxs("div",{className:"bg-card border border-border rounded-xl p-5",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(m,{className:"w-5 h-5 text-primary"}),e.jsx("h2",{className:"text-sm font-bold text-foreground",children:"Your Profile"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:o,children:"Full Name"}),e.jsx("input",{value:b,onChange:s=>j(s.target.value),className:i,placeholder:"Your full name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:o,children:"Email"}),e.jsx("input",{value:c.email||"",disabled:!0,className:`${i} opacity-60 cursor-not-allowed`})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:o,children:"Your Role"}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-2",children:T.map(s=>{const a=E[s.value]||m,r=y===s.value;return e.jsxs("button",{type:"button",onClick:()=>N(s.value),className:`flex items-center gap-3 p-3 rounded-xl border transition-all text-left ${r?"bg-primary/10 border-primary/50":"bg-muted border-border hover:border-border"}`,children:[e.jsx("div",{className:`w-9 h-9 rounded-lg flex items-center justify-center ${r?"bg-primary/20 text-primary":"bg-muted text-muted-foreground"}`,children:e.jsx(a,{className:"w-4 h-4"})}),e.jsxs("div",{children:[e.jsx("p",{className:`text-sm font-medium ${r?"text-primary":"text-muted-foreground"}`,children:s.label}),e.jsx("p",{className:"text-[10px] text-muted-foreground leading-tight",children:s.description.split(",")[0]})]})]},s.value)})})]}),e.jsx("button",{onClick:_,disabled:v,className:`flex items-center gap-2 px-4 py-2 rounded-lg text-xs font-semibold transition-colors ${S?"bg-emerald-500 text-foreground":"bg-primary hover:bg-primary/90 text-primary-foreground"} disabled:opacity-50`,children:S?e.jsxs(e.Fragment,{children:[e.jsx(L,{className:"w-3 h-3"})," Profile Saved"]}):v?"Saving...":e.jsxs(e.Fragment,{children:[e.jsx(P,{className:"w-3 h-3"})," Update Profile"]})})]}),!c&&e.jsxs("div",{className:"bg-primary/10 border border-primary/20 rounded-xl p-4 flex items-center gap-3",children:[e.jsx($,{className:"w-5 h-5 text-primary flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-primary",children:"Sign in to manage your profile"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Create an account to save your settings and access role-based features."})]})]}),e.jsxs("div",{className:"bg-card border border-border rounded-xl p-5",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(Z,{className:"w-5 h-5 text-primary"}),e.jsx("h2",{className:"text-sm font-bold text-foreground",children:"Company Details"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:o,children:"Company Name"}),e.jsx("input",{value:t.companyName,onChange:s=>d({...t,companyName:s.target.value}),className:i,placeholder:"e.g. Long Line Builders"})]}),e.jsxs("div",{children:[e.jsx("label",{className:o,children:"Company Logo URL"}),e.jsx("input",{value:t.companyLogo,onChange:s=>d({...t,companyLogo:s.target.value}),className:i,placeholder:"https://example.com/logo.png"}),e.jsx("p",{className:"text-[10px] text-muted-foreground mt-1",children:"Used on PDF/Excel exports"})]})]})]}),e.jsxs("div",{className:"bg-card border border-border rounded-xl p-5",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(z,{className:"w-5 h-5 text-primary"}),e.jsx("h2",{className:"text-sm font-bold text-foreground",children:"Timesheet Configuration"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:o,children:"Timesheet Period"}),e.jsx("div",{className:"flex gap-2",children:[1,2].map(s=>e.jsxs("button",{onClick:()=>d({...t,timesheetPeriod:s}),className:`flex-1 py-2 rounded-lg text-sm font-medium transition-colors ${t.timesheetPeriod===s?"bg-primary text-primary-foreground":"bg-muted text-muted-foreground hover:bg-muted"}`,children:[s," Week",s>1?"s":""]},s))})]}),e.jsxs("div",{children:[e.jsx("label",{className:o,children:"Week Ending Day"}),e.jsx("select",{value:t.weekEndingDay,onChange:s=>d({...t,weekEndingDay:s.target.value}),className:i,children:["Sunday","Saturday","Friday","Thursday","Wednesday","Tuesday","Monday"].map(s=>e.jsx("option",{value:s,children:s},s))})]}),e.jsxs("div",{children:[e.jsx("label",{className:o,children:"Default Lunch"}),e.jsx("div",{className:"flex gap-2",children:[30,60].map(s=>e.jsxs("button",{onClick:()=>d({...t,lunchDefaultMinutes:s}),className:`flex-1 py-2 rounded-lg text-sm font-medium transition-colors ${t.lunchDefaultMinutes===s?"bg-primary text-primary-foreground":"bg-muted text-muted-foreground hover:bg-muted"}`,children:[s," min"]},s))})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:o,children:"Rounding (minutes)"}),e.jsx("div",{className:"flex gap-2",children:[5,10,15,30].map(s=>e.jsxs("button",{onClick:()=>d({...t,roundingMinutes:s}),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${t.roundingMinutes===s?"bg-primary text-primary-foreground":"bg-muted text-muted-foreground hover:bg-muted"}`,children:[s," min"]},s))})]})]}),e.jsxs("div",{className:"bg-card border border-border rounded-xl p-5",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(A,{className:"w-5 h-5 text-primary"}),e.jsx("h2",{className:"text-sm font-bold text-foreground",children:"Palette Themes"}),e.jsx("span",{className:"text-[10px] text-muted-foreground ml-2",children:"Applies across the entire app (saved on this device)"})]}),e.jsx("label",{className:o,children:"Theme palette"}),e.jsx("select",{className:i,value:I,onChange:s=>{const a=s.target.value;U(a),x("palette-"+a)},children:k.map(s=>e.jsxs("option",{value:s.id,children:[s.name," (",s.mode,")"]},s.id))}),e.jsx("div",{className:"mt-2 text-xs text-muted-foreground",children:"Note: This does not change your logo. Only colours/tokens."})]}),e.jsxs("div",{className:"bg-card border border-border rounded-xl p-5",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(A,{className:"w-5 h-5 text-primary"}),e.jsx("h2",{className:"text-sm font-bold text-foreground",children:"Features"}),e.jsx("span",{className:"text-[10px] text-muted-foreground ml-2",children:"Toggle features on/off"})]}),e.jsx("div",{className:"space-y-3",children:W.map(s=>{const a=s.icon,r=t.features[s.key];return e.jsxs("div",{className:`flex items-center gap-4 p-3 rounded-xl border transition-colors ${r?"bg-muted border-border":"bg-card border-border opacity-60"}`,children:[e.jsx("div",{className:`w-10 h-10 rounded-xl flex items-center justify-center ${r?"bg-primary/15 text-primary":"bg-muted text-muted-foreground"}`,children:e.jsx(a,{className:"w-5 h-5"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-sm font-semibold text-foreground",children:s.label}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s.description})]}),e.jsx("button",{onClick:()=>G(s.key,!r),className:`relative w-11 h-6 rounded-full transition-colors ${r?"bg-primary":"bg-muted"}`,children:e.jsx("span",{className:`absolute top-0.5 left-0.5 w-5 h-5 rounded-full bg-foreground transition-transform ${r?"translate-x-5":"translate-x-0"}`})})]},s.key)})})]}),e.jsxs("div",{className:"bg-card border border-border rounded-xl p-5",children:[e.jsx("h2",{className:"text-sm font-bold text-foreground mb-3",children:"Role Access Levels"}),e.jsx("p",{className:"text-xs text-muted-foreground mb-3",children:"Each role has different access to features:"}),e.jsx("div",{className:"space-y-2",children:T.map(s=>{const a=E[s.value]||m,r=D===s.value;return e.jsxs("div",{className:`flex items-center gap-3 p-3 rounded-xl border transition-colors ${r?"bg-primary/10 border-primary/20":"bg-muted/20 border-border"}`,children:[e.jsx("div",{className:`w-9 h-9 rounded-lg flex items-center justify-center ${r?"bg-primary/20 text-primary":"bg-muted text-muted-foreground"}`,children:e.jsx(a,{className:"w-4 h-4"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`text-sm font-semibold ${r?"text-primary":"text-foreground"}`,children:s.label}),r&&e.jsx("span",{className:"text-[10px] px-1.5 py-0.5 rounded bg-primary/20 text-primary font-medium",children:"Current"})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s.description})]})]},s.value)})})]})]})};export{he as default};
